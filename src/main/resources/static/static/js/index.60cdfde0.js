"use strict";(self["webpackChunkroad_traffic_survey"]=self["webpackChunkroad_traffic_survey"]||[]).push([[826],{4994:function(t,e,i){i.r(e),i.d(e,{SHOW_LINK_ZOOM:function(){return zi},default:function(){return Yi}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"root"},[e("div",{attrs:{id:"mapRoot"}},[e("div",{staticClass:"MapLayerMenu"},[e("div",{staticClass:"MapLayer_menu",class:{hide:!t.showStyleMenu},style:`width: ${50*t.styleList.length+30}px`},[e("div",{staticClass:"open_hide_btn",on:{click:function(e){t.showStyleMenu=!t.showStyleMenu}}}),t._l(t.styleList,(function(i,a){return e("img",{key:a,staticClass:"item",class:{active:t.styleActive==a},attrs:{src:i.url,title:i.style_name},on:{click:function(e){return t.handleChangeStyle(a)}}})}))],2)])]),e("Dialog",{attrs:{visible:t.showSetting,hideMinimize:"",hideClose:"",width:"400px"}},[e("div",{staticClass:"setting_box"},[e("el-collapse",{staticStyle:{"user-select":"none"},model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[e("el-collapse-item",{attrs:{title:"定位",name:"1"}},[e("el-form",{staticClass:"setting_form",attrs:{"label-position":"left","label-width":"100px",inline:!1,size:"small"}},[e("el-form-item",{attrs:{label:"路段搜索"}},[e("RouteSelect",{staticStyle:{width:"100%"},attrs:{size:"small"},on:{change:t.handleMoveToRoute},model:{value:t.ruleForm.routeId,callback:function(e){t.$set(t.ruleForm,"routeId",e)},expression:"ruleForm.routeId"}})],1),e("el-form-item",{attrs:{label:"LinkId搜索"}},[e("LinkSelect",{staticStyle:{width:"100%"},attrs:{size:"small"},on:{change:t.handleMoveToLink},model:{value:t.ruleForm.linkId,callback:function(e){t.$set(t.ruleForm,"linkId",e)},expression:"ruleForm.linkId"}})],1),e("el-form-item",{attrs:{label:"中心坐标"}},[e("CenterInput",{staticStyle:{width:"100%"},attrs:{size:"small"},on:{change:t.handleMoveToCenter},model:{value:t.ruleForm.center,callback:function(e){t.$set(t.ruleForm,"center",e)},expression:"ruleForm.center"}})],1),e("el-form-item",[e("div",{attrs:{slot:"label"},slot:"label"},[e("span",[t._v("zoom level ")]),e("el-tooltip",{attrs:{placement:"top"}},[e("div",{attrs:{slot:"content"},slot:"content"},[e("div",[t._v("当zoom level大于"+t._s(t.SHOW_LINK_ZOOM)+"时，显示路网视图")])]),e("i",{staticClass:"el-icon-question"})])],1),e("el-slider",{attrs:{min:t.MAP_ZOOM_RANGE.MIN,max:t.MAP_ZOOM_RANGE.MAX,step:.01,marks:{[t.ruleForm.zoom]:String(t.ruleForm.zoom)}},on:{change:t.handleChangeZoomLavel},model:{value:t.ruleForm.zoom,callback:function(e){t.$set(t.ruleForm,"zoom",e)},expression:"ruleForm.zoom"}})],1)],1)],1),e("el-collapse-item",{attrs:{title:"路段流量",name:"2"}},[e("el-form",{staticClass:"setting_form",attrs:{"label-position":"left","label-width":"100px",inline:!1,size:"small"}},[e("el-form-item",{attrs:{label:"显示图层"}},[e("el-switch",{model:{value:t.showLinkStatsLayer,callback:function(e){t.showLinkStatsLayer=e},expression:"showLinkStatsLayer"}})],1),e("el-form-item",{attrs:{label:"调查时间"}},[e("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss"},on:{change:t.handleLoadMaker},model:{value:t.ruleForm.timeList,callback:function(e){t.$set(t.ruleForm,"timeList",e)},expression:"ruleForm.timeList"}})],1),e("el-form-item",{attrs:{label:"调查方式"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{clearable:""},on:{change:t.handleLoadMaker},model:{value:t.ruleForm.type,callback:function(e){t.$set(t.ruleForm,"type",e)},expression:"ruleForm.type"}},t._l(t.typeOptions,(function(t,i){return e("el-option",{key:i,attrs:{label:t,value:String(i)}})})),1)],1),e("el-form-item",{attrs:{label:"区域框选"}},[e("div",{attrs:{slot:"label"},slot:"label"},[e("span",[t._v("区域框选 ")]),e("el-tooltip",{attrs:{placement:"top"}},[e("div",{attrs:{slot:"content"},slot:"content"},[e("div",[t._v("1，单击鼠标左键选定开始坐标")]),e("div",[t._v("2，拖动鼠标划定范围")]),e("div",[t._v("3，单击鼠标左键选定结束坐标")])]),e("i",{staticClass:"el-icon-question"})])],1),t.ruleForm.frameSelectState==t.FRAME_SELECT_STATE_KEY.NOT_STARTED?e("div",[e("el-button",{attrs:{type:"primary"},on:{click:t.handlePlayFrameSelect}},[t._v("开始框选")])],1):t._e(),e("div",[t.frameLink.xyarr?e("el-button",{attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.handleShowFrameLink.apply(null,arguments)}}},[t._v("开始查询")]):t._e(),t.ruleForm.frameSelectState!=t.FRAME_SELECT_STATE_KEY.NOT_STARTED?e("el-button",{attrs:{type:"primary"},on:{click:t.handleStopFrameSelect}},[t._v("停止框选")]):t._e()],1)]),e("el-form-item",{attrs:{label:"路段偏移"}},[e("el-slider",{attrs:{min:0,max:30,step:.2},on:{change:t.handleChangeTwoWayOffset},model:{value:t.ruleForm.twoWayOffset,callback:function(e){t.$set(t.ruleForm,"twoWayOffset",e)},expression:"ruleForm.twoWayOffset"}})],1),e("el-form-item",{attrs:{label:"路段宽度"}},[e("el-slider",{attrs:{min:1,max:30},on:{change:t.handleChangeWayWidth},model:{value:t.ruleForm.wayWidth,callback:function(e){t.$set(t.ruleForm,"wayWidth",e)},expression:"ruleForm.wayWidth"}})],1)],1)],1),e("el-collapse-item",{attrs:{title:"交叉口",name:"3"}},[e("el-form",{staticClass:"setting_form",attrs:{"label-position":"left","label-width":"100px",inline:!1,size:"small"}},[e("el-form-item",{attrs:{label:"显示图层"}},[e("el-switch",{model:{value:t.showIntersectionListLayer,callback:function(e){t.showIntersectionListLayer=e},expression:"showIntersectionListLayer"}})],1),e("el-form-item",{attrs:{label:"新增"}},[t.ruleForm.pointSelectState==t.POINT_SELECT_STATE_KEY.DISABLE?e("el-button",{attrs:{type:"primary"},on:{click:t.handlePlayPointSelect}},[t._v("开始点选")]):t.ruleForm.pointSelectState==t.POINT_SELECT_STATE_KEY.ENABLE?e("el-button",{attrs:{type:"primary"},on:{click:t.handleStopPointSelect}},[t._v("停止点选")]):t._e()],1),e("el-form-item",{attrs:{label:"调查记录"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.crossroadsList.visible=!0}}},[t._v("查看全部")])],1)],1)],1),e("el-collapse-item",{attrs:{title:"图片上传",name:"4"}},[e("el-form",{staticClass:"setting_form",attrs:{"label-position":"left","label-width":"100px",inline:!1,size:"small"}},[e("el-form-item",{attrs:{label:"显示图层"}},[e("el-switch",{model:{value:t.showImageListLayer,callback:function(e){t.showImageListLayer=e},expression:"showImageListLayer"}})],1),e("el-form-item",{attrs:{label:"选择文件"}},[e("UploadImageZip")],1),e("el-form-item",{attrs:{label:"文件列表"}},[e("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.imageListDialog.visible=!0}}},[t._v("显示弹窗")])],1)],1)],1)],1)],1)]),e("LineFlow",{attrs:{visible:t.lineFlow.visible,linkId:t.lineFlow.linkId},on:{"update:visible":function(e){return t.$set(t.lineFlow,"visible",e)},changeLink:t.handleChangeLink,updateData:t.lineFlowUpdateData,close:t.lineFlowClose}}),e("FrameLink",{attrs:{visible:t.frameLink.visible,timeList:t.ruleForm.timeList,type:t.ruleForm.type,xyarr:t.frameLink.xyarr},on:{"update:visible":function(e){return t.$set(t.frameLink,"visible",e)}}}),e("AddIntersection",{attrs:{visible:t.addIntersection.visible,params:t.addIntersection.params},on:{"update:visible":function(e){return t.$set(t.addIntersection,"visible",e)},submited:t.handleSubmitAddIntersection,close:t.handleStopPointSelect}}),e("CrossroadsList",{attrs:{visible:t.showCrossroadsList,params:t.crossroadsList.params},on:{"update:params":function(e){return t.$set(t.crossroadsList,"params",e)},"update:visible":function(e){t.crossroadsList.visible=e},showCrossroadsDetail:t.handleShowCrossroadsDetail,showCrossroadsStatsEdit:t.handleShowCrossroadsStatsEdit,showDrawLine:t.handleShowDrawLine,showManuallyEnteringCrossroads:t.handleShowManuallyEnteringCrossroads,showVideoInputCrossroads:t.handleShowVideoInputCrossroads}}),e("VideoInputCrossroads",{attrs:{visible:t.videoInputCrossroads.visible,params:t.videoInputCrossroads.params},on:{"update:visible":function(e){return t.$set(t.videoInputCrossroads,"visible",e)},submited:t.handleSubmitVideoInputCrossroads}}),e("ManuallyEnteringCrossroads",{attrs:{visible:t.manuallyEnteringCrossroads.visible,params:t.manuallyEnteringCrossroads.params},on:{"update:visible":function(e){return t.$set(t.manuallyEnteringCrossroads,"visible",e)},submited:t.handleSubmitManuallyEnteringCrossroads}}),e("DrawLine",{attrs:{visible:t.drawLine.visible,params:t.drawLine.params},on:{"update:visible":function(e){return t.$set(t.drawLine,"visible",e)},submited:t.handleDrawLineSuccess}}),e("CrossroadsDetail",{attrs:{visible:t.crossroadsDetail.visible,params:t.crossroadsDetail.params},on:{"update:visible":function(e){return t.$set(t.crossroadsDetail,"visible",e)}}}),e("CrossroadsStatsEdit",{attrs:{visible:t.crossroadsStatsEdit.visible,params:t.crossroadsStatsEdit.params},on:{"update:visible":function(e){return t.$set(t.crossroadsStatsEdit,"visible",e)},redraw:t.handleRedraw}}),e("HelpDialog"),e("ImageListDialog",{attrs:{visible:t.imageListDialog.visible},on:{"update:visible":function(e){return t.$set(t.imageListDialog,"visible",e)},close:function(e){return t.handleSetHMash(null)}}}),e("Dialog",{staticClass:"ImageDialog",attrs:{title:"查看图片",top:50,left:100,width:"600px",hideMinimize:"",visible:t.imageDialog.visible},on:{"update:visible":function(e){return t.$set(t.imageDialog,"visible",e)},close:function(e){return t.handleSetHMash(null)}}},[t.imageDialog.data?e("el-image",{staticStyle:{width:"560px",height:"auto"},attrs:{src:t.imageDialog.data.url,"preview-src-list":[t.imageDialog.data.url]}}):t._e(),e("div",{staticStyle:{display:"flex","justify-content":"center"}},[e("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.handleDeleteImage(t.imageDialog.data)}}},[t._v("删除图片")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.imageDialog.visible=!1,t.handleSetHMash(null)}}},[t._v("关闭")])],1)],1)],1)},r=[],s=(i(560),i(7333)),n=i(1013),o=i(2150),l=(i(4224),i(1121),i(7133),i(8962));const h={NOT_STARTED:0,CAN_START:1,IN_PROGREES:2,ENDED:3},d={STATE_CHANGE:"handle:statechange"};class c extends s.mh{constructor(t){super(t),(0,o.Z)(this,"name","FrameSelectLayer"),(0,o.Z)(this,"color",4235007),(0,o.Z)(this,"opacity",.5),(0,o.Z)(this,"state",h.NOT_STARTED),(0,o.Z)(this,"startPoint",[0,0]),(0,o.Z)(this,"endPoint",[0,0]),this.color=t.color||4235007,this.opacity=t.opacity||.5,this.material=new l.vBJ({transparent:!0,opacity:this.opacity,color:new l.Ilk(this.color),depthFunc:l.Se2,alphaTest:.2}),this.geometry=new l.u9r,this.mesh=new l.Kj0(this.geometry,this.material)}on(t,e){t==s.kT.HANDLE_MOUSE_LEFT_DOWN&&(this.state!=h.CAN_START&&this.state!=h.ENDED||(this.startPoint=e.webMercatorXY,this.endPoint=e.webMercatorXY,this.state=h.IN_PROGREES,this.update(),this.scene.add(this.mesh),this.handleStateChange())),t==s.kT.HANDLE_MOUSE_LEFT_UP&&this.state==h.IN_PROGREES&&(this.endPoint=e.webMercatorXY,this.state=h.ENDED,this.update(),this.handleStateChange()),t==s.kT.HANDLE_MOUSE_MOVE&&this.state==h.IN_PROGREES&&(this.endPoint=e.webMercatorXY,this.update()),t==s.kT.HANDLE_CLICK_LEFT&&(this.state==h.IN_PROGREES?(this.endPoint=e.webMercatorXY,this.state=h.ENDED,this.update(),this.handleStateChange()):this.state!=h.NOT_STARTED&&(this.startPoint=e.webMercatorXY,this.endPoint=e.webMercatorXY,this.state=h.IN_PROGREES,this.update(),this.scene.add(this.mesh),this.handleStateChange())),t==s.kT.HANDLE_CLICK_RIGHT&&this.state!=h.NOT_STARTED&&(this.startPoint=[0,0],this.endPoint=[0,0],this.state=h.CAN_START,this.update(),this.handleStateChange()),t!=s.kT.UPDATE_CENTER&&t!=s.kT.UPDATE_ZOOM||this.state!=h.NOT_STARTED&&this.update(),super.on(t,e)}handleStateChange(){const t=this.map.center;let[e,i]=this.map.WebMercatorToCanvasXY(...this.startPoint,...t),[a,r]=this.map.WebMercatorToCanvasXY(...this.endPoint,...t);const s=e>a?this.startPoint:this.endPoint,n=e>a?this.endPoint:this.startPoint;this.handleEventListener(d.STATE_CHANGE,{state:this.state,xy:{rightTop:s,rightBottom:[s[0],n[1]],leftBottom:n,leftTop:[n[0],s[1]]}})}stop(){this.clearScene(),this.state=h.NOT_STARTED,this.handleStateChange()}play(){this.state=h.CAN_START,this.handleStateChange()}reset(){this.clearScene(),this.state=h.NOT_STARTED,this.startPoint=[0,0],this.endPoint=[0,0],this.update(),this.handleStateChange()}update(){const t=this.map.center;let[e,i]=this.map.WebMercatorToCanvasXY(...this.startPoint,...t),[a,r]=this.map.WebMercatorToCanvasXY(...this.endPoint,...t),s=[0,0,0,1,1,1,1,0],n=[Math.min(e,a),Math.min(i,r),0,Math.max(e,a),Math.min(i,r),0,Math.max(e,a),Math.max(i,r),0,Math.min(e,a),Math.max(i,r),0],o=[0,1,2,0,2,3];this.geometry.setAttribute("position",new l.TlE(new Float32Array(n),3)),this.geometry.setAttribute("uv",new l.TlE(new Float32Array(s),2)),this.geometry.index=new l.TlE(new Uint16Array(o),1),this.geometry.needsUpdate=!0,this.geometry.computeBoundingSphere()}}const u={DISABLE:0,ENABLE:1},p={POINT_CHANGE:"handle:pointchange",STATE_CHANGE:"handle:statechange"};class g extends s.mh{set point(t){this._point=t;try{if(this.map){const[t,e]=this.map.WebMercatorToCanvasXY(this._point[0],this._point[1]);this.mesh.position.set(t,e,0),this.scene.add(this.mesh)}}catch(e){}}get point(){return this._point}get size(){return this._size}set size(t){this._size=t,this.mesh.scale.set(this.size,this.size,1)}set state(t){this._state=t,this.handleEventListener(p.STATE_CHANGE,{state:this._state,point:this._point})}get state(){return this._state}constructor(t){super(t),(0,o.Z)(this,"_point",null),(0,o.Z)(this,"_size",100),(0,o.Z)(this,"_state",u.DISABLE),(0,o.Z)(this,"color",null),this.texture=(new l.dpR).load(i(1534));const e=new l.xeV({color:t.color,map:this.texture,transparent:!0,sizeAttenuation:!0});this.mesh=new l.jyi(e),this.mesh.center.set(.5,0),this.scene.add(this.mesh),this.size=100,this.point=[0,0],this.color=null}on(t,e){t==s.kT.UPDATE_CENTER&&(this.point=this._point),t==s.kT.HANDLE_CLICK_LEFT&&this.state==u.ENABLE&&(this.point=e.webMercatorXY,this.handleEventListener(p.POINT_CHANGE,{state:this._state,point:this._point})),t==s.kT.UPDATE_CAMERA_HEIGHT&&(this.size=this.map.cameraHeight/20)}onAdd(t){super.onAdd(t),this.point=this._point,this.size=this.map.cameraHeight/20}}function m(t,e=!1){const i=null!==t[0].index,a=new Set(Object.keys(t[0].attributes)),r=new Set(Object.keys(t[0].morphAttributes)),s={},n={},o=t[0].morphTargetsRelative,h=new l.u9r;let d=0;for(let l=0;l<t.length;++l){const c=t[l];let u=0;if(i!==(null!==c.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+l+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const t in c.attributes){if(!a.has(t))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+l+'. All geometries must have compatible attributes; make sure "'+t+'" attribute exists among all geometries, or in none of them.'),null;void 0===s[t]&&(s[t]=[]),s[t].push(c.attributes[t]),u++}if(u!==a.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+l+". Make sure all geometries have the same number of attributes."),null;if(o!==c.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+l+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const t in c.morphAttributes){if(!r.has(t))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+l+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===n[t]&&(n[t]=[]),n[t].push(c.morphAttributes[t])}if(e){let t;if(i)t=c.index.count;else{if(void 0===c.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+l+". The geometry must have either an index or a position attribute"),null;t=c.attributes.position.count}h.addGroup(d,t,l),d+=t}}if(i){let e=0;const i=[];for(let a=0;a<t.length;++a){const r=t[a].index;for(let t=0;t<r.count;++t)i.push(r.getX(t)+e);e+=t[a].attributes.position.count}h.setIndex(i)}for(const l in s){const t=f(s[l]);if(!t)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+l+" attribute."),null;h.setAttribute(l,t)}for(const l in n){const t=n[l][0].length;if(0===t)break;h.morphAttributes=h.morphAttributes||{},h.morphAttributes[l]=[];for(let e=0;e<t;++e){const t=[];for(let a=0;a<n[l].length;++a)t.push(n[l][a][e]);const i=f(t);if(!i)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+l+" morphAttribute."),null;h.morphAttributes[l].push(i)}}return h}function f(t){let e,i,a,r=0;for(let o=0;o<t.length;++o){const s=t[o];if(s.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===e&&(e=s.array.constructor),e!==s.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===i&&(i=s.itemSize),i!==s.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===a&&(a=s.normalized),a!==s.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;r+=s.array.length}const s=new e(r);let n=0;for(let o=0;o<t.length;++o)s.set(t[o].array,n),n+=t[o].array.length;return new l.TlE(s,i,a)}const v=new l.Ilk(9474969);class y extends s.mh{constructor(t){super(t),(0,o.Z)(this,"name","NetworkLayer"),(0,o.Z)(this,"data",null),(0,o.Z)(this,"color",null),(0,o.Z)(this,"lineWidth",4),(0,o.Z)(this,"material",null),(0,o.Z)(this,"pickLayerMaterial",null),(0,o.Z)(this,"pickMaterial",null),(0,o.Z)(this,"highMaterial",null),(0,o.Z)(this,"geometry",null),this.setData(t.data),this.color=t.color||v,this.lineWidth=t.lineWidth||1}on(t,e){if(t==s.kT.UPDATE_CENTER){for(const t of this.scene.children){const[e,i]=this.map.WebMercatorToCanvasXY(...this.center);t.position.set(e,i,t.position.z)}for(const t of this.pickLayerScene.children){const[e,i]=this.map.WebMercatorToCanvasXY(...this.center);t.position.set(e,i,t.position.z)}for(const t of this.pickMeshScene.children){const[e,i]=this.map.WebMercatorToCanvasXY(...this.center);t.position.set(e,i,t.position.z)}this.handleEventListener(t)}if(t==s.kT.HANDLE_PICK_LEFT&&e.layerId==this.id){let i=this.data.find((t=>e.pickColor==t.pickColorNum));i&&this.handleEventListener(t,i.data)}}onAdd(t){super.onAdd(t),this.update()}setData(t){try{let e=0;const i=[0,0],a=[];for(let r=0,s=t.length;r<s;r++){let s=JSON.parse(t[r].geom);0==r&&(i[0]=s.coordinates[0][0],i[1]=s.coordinates[0][1]),a[a.length]={pickColorNum:++e,path:s.coordinates.map((t=>[Math.round(t[0]-i[0]),Math.round(t[1]-i[1])])).flat(),data:t[r]}}this.center=i,this.data=a,this.update()}catch(e){this.center=[0,0],this.data=null,this.update()}}async update(){if(this.clearScene(),!this.map)return;if(!this.data)return;this.material=this.getMaterial({color:this.color}),this.pickLayerMaterial=this.getMaterial({color:this.pickLayerColor,pickOffset:10}),this.pickMaterial=this.getMaterial({vertexColors:!0,usePickColor:!0,pickOffset:10});const[t,e]=this.map.WebMercatorToCanvasXY(...this.center),i=new b(this.data),a=new l.Kj0(i,this.material);a.position.set(t,e,0),this.scene.add(a);const r=new l.Kj0(i,this.pickLayerMaterial);r.position.set(t,e,0),this.pickLayerScene.add(r);const s=new l.Kj0(i,this.pickMaterial);s.position.set(t,e,0),this.pickMeshScene.add(s)}setValues(t){for(const e in t)this[e]=t[e];this.material&&(this.material.needsUpdate=!0),this.pickLayerMaterial&&(this.pickLayerMaterial.needsUpdate=!0),this.pickMaterial&&(this.pickMaterial.needsUpdate=!0)}getMaterial({usePickColor:t,pickOffset:e,...i}){const a=new l.vBJ({side:l.ehD,transparent:!0,wireframe:!1,...i});return a.onBeforeCompile=i=>{i.vertexShader=i.vertexShader.replace("#include <common>","\n          #include <common>\n          vec3 lineOffset(vec2 start, vec3 current, vec2 end, float offset) {\n            float lenA = length(current.xy - start);\n            float lenB = length(current.xy - end);\n\n            if(lenA == 0. && lenB == 0.) return current;\n\n            vec2 dirA = normalize(current.xy - start);\n            vec2 dirB = normalize(current.xy - end);\n\n            if(lenA == 0.) {\n              float angle = PI / 2.0;\n              vec2 normal = vec2(-dirB.y, dirB.x);\n              return vec3(current.xy + normal * offset / sin(angle), current.z);\n            } else if(lenB == 0.) {\n              float angle = PI / 2.0;\n              vec2 normal = vec2(dirA.y, -dirA.x);\n              return vec3(current.xy + normal * offset / sin(angle), current.z);\n            } else {\n              vec2 dir = normalize(dirB - dirA);\n              vec2 normal = vec2(-dir.y, dir.x);\n              float angle = acos(dot(dirB, normal));\n              return vec3(current.xy + normal * offset / sin(angle), current.z);\n            }\n          }\n\n          attribute vec3 pickColor;\n          attribute float side;\n          attribute vec2 startPosition;\n          attribute vec2 endPosition;\n        "),i.vertexShader=i.vertexShader.replace("#include <begin_vertex>",`\n          #include <begin_vertex>\n          float lineWidth = ${Number(this.lineWidth+(e||0)).toFixed(2)};\n          float offset = lineWidth / 2.0  * side;\n          transformed = lineOffset(startPosition, position, endPosition, offset);\n        `),t&&(i.vertexShader=i.vertexShader.replace("#include <color_vertex>","\n            #include <color_vertex>\n            #if defined( USE_COLOR_ALPHA )\n              vColor = vec4(pickColor,1.0);\n            #elif defined( USE_COLOR )\n              vColor.rgb = pickColor.rgb;\n            #endif\n          "))},a.customProgramCacheKey=()=>JSON.stringify({uuid:a.uuid,lineWidth:this.lineWidth,usePickColor:t,pickOffset:e}),a}getGeometry(){const t=[];for(const e of this.data){const i=e.path.length,a=new l.TlE(new Float32Array(4*i*3),3),r=new l.TlE(new Float32Array(4*i*2),2),s=new l.TlE(new Float32Array(4*i*2),2),n=new l.TlE(new Float32Array(4*i),1),o=new l.TlE(new Uint16Array(2*i*3),1),h=new l.TlE(new Float32Array(4*i*2),2),d=new l.TlE(new Float32Array(4*i*3),3),c=new l.TlE(new Float32Array(4*i*3),3),u=e.pickColor;for(let t=0;t<e.path.length;t++){const i=e.path[t],l=0==t?i:e.path[t-1],p=t==e.path.length-1?i:e.path[t+1],g=this.color,m=l.fromxy,f=i.fromxy,v=i.toxy,y=p.toxy;r.setXY(4*t,m[0],m[1]),r.setXY(4*t+1,m[0],m[1]),a.setXYZ(4*t,f[0],f[1],0),a.setXYZ(4*t+1,f[0],f[1],0),s.setXY(4*t,v[0],v[1]),s.setXY(4*t+1,v[0],v[1]),n.setX(4*t,1),n.setX(4*t+1,-1),d.setXYZ(4*t,u.r,u.g,u.b),d.setXYZ(4*t+1,u.r,u.g,u.b),c.setXYZ(4*t,g.r,g.g,g.b),c.setXYZ(4*t+1,g.r,g.g,g.b),r.setXY(4*t+2,f[0],f[1]),r.setXY(4*t+3,f[0],f[1]),a.setXYZ(4*t+2,v[0],v[1],0),a.setXYZ(4*t+3,v[0],v[1],0),s.setXY(4*t+2,y[0],y[1]),s.setXY(4*t+3,y[0],y[1]),n.setX(4*t+2,1),n.setX(4*t+3,-1),d.setXYZ(4*t+2,u.r,u.g,u.b),d.setXYZ(4*t+3,u.r,u.g,u.b),c.setXYZ(4*t+2,g.r,g.g,g.b),c.setXYZ(4*t+3,g.r,g.g,g.b),h.setXY(4*t,0,0),h.setXY(4*t+1,1,0),h.setXY(4*t+2,0,1),h.setXY(4*t+3,1,1),o.setX(6*t,4*t),o.setX(6*t+1,4*t+1),o.setX(6*t+2,4*t+3),o.setX(6*t+3,4*t),o.setX(6*t+4,4*t+3),o.setX(6*t+5,4*t+2)}const p=new l.u9r;p.setAttribute("position",a),p.setAttribute("startPosition",r),p.setAttribute("endPosition",s),p.setAttribute("side",n),p.setAttribute("uv",h),p.setAttribute("pickColor",d),p.setAttribute("color",c),p.index=o,e.geometry=p,t.push(p)}return m(t,!1)}}class b extends l.u9r{constructor(t){super(),this.type="NetworkGeometry",this.isNetworkGeometry=!0;const e=new Array,i=new Array,a=new Array,r=new Array,s=new Array,n=new Array;let o=0;for(let h=0,d=t.length;h<d;h++){const d=t[h].path,c=new l.Ilk(t[h].pickColorNum);for(let t=0,l=d.length/2;t<l;t++){let h=d[2*t-2],u=d[2*t-1],p=d[2*t+0],g=d[2*t+1],m=d[2*t+2],f=d[2*t+3];0===t&&(h=2*p-m,u=2*g-f),t>=l-1&&(m=2*p-h,f=2*g-u),e[e.length]=p,e[e.length]=g,e[e.length]=0,e[e.length]=p,e[e.length]=g,e[e.length]=0,n[n.length]=c.r,n[n.length]=c.g,n[n.length]=c.b,n[n.length]=c.r,n[n.length]=c.g,n[n.length]=c.b,i[i.length]=h,i[i.length]=u,i[i.length]=h,i[i.length]=u,a[a.length]=m,a[a.length]=f,a[a.length]=m,a[a.length]=f,r[r.length]=-1,r[r.length]=1,t<l-1&&(s[s.length]=o+0,s[s.length]=o+1,s[s.length]=o+3,s[s.length]=o+0,s[s.length]=o+3,s[s.length]=o+2),o+=2}}this.setAttribute("position",new l.a$l(e,3)),this.setAttribute("startPosition",new l.a$l(i,2)),this.setAttribute("endPosition",new l.a$l(a,2)),this.setAttribute("side",new l.RNb(r,1)),this.setAttribute("pickColor",new l.a$l(n,3)),this.setIndex(s),this.computeVertexNormals()}}const _=15114812,w=16084076,C=4235007,A=new l.Ilk(9474969),S={0:new l.Ilk(_),1:new l.Ilk(w),2:new l.Ilk(C),"0,1":new l.Ilk((_+w)/2),"1,0":new l.Ilk((_+w)/2),"0,2":new l.Ilk((_+C)/2),"2,0":new l.Ilk((_+C)/2),"1,2":new l.Ilk((w+C)/2),"2,1":new l.Ilk((w+C)/2),"0,1,2":new l.Ilk((_+w+C)/3),"1,0,2":new l.Ilk((_+w+C)/3),"1,2,0":new l.Ilk((_+w+C)/3),"0,2,1":new l.Ilk((_+w+C)/3),"2,0,1":new l.Ilk((_+w+C)/3),"2,1,0":new l.Ilk((_+w+C)/3)};class x extends s.mh{get isTwoWay(){return this.data.length-1}constructor(t){super(t),(0,o.Z)(this,"name","LinkLayer"),(0,o.Z)(this,"data",null),(0,o.Z)(this,"color",null),(0,o.Z)(this,"lineWidth",4),(0,o.Z)(this,"twoWayOffset",0),(0,o.Z)(this,"selectId",null),(0,o.Z)(this,"selectMesh",null),(0,o.Z)(this,"material",null),(0,o.Z)(this,"pickLayerMaterial",null),(0,o.Z)(this,"pickMaterial",null),this.setData(t.data),this.color=t.color?new l.Ilk(t.color):A,this.lineWidth=t.lineWidth||4,this.twoWayOffset=t.twoWayOffset||0}on(t,e){if(t==s.kT.UPDATE_CENTER){for(const t of this.scene.children){const[e,i]=this.map.WebMercatorToCanvasXY(...this.center);t.position.set(e,i,t.position.z)}for(const t of this.pickLayerScene.children){const[e,i]=this.map.WebMercatorToCanvasXY(...this.center);t.position.set(e,i,t.position.z)}for(const t of this.pickMeshScene.children){const[e,i]=this.map.WebMercatorToCanvasXY(...this.center);t.position.set(e,i,t.position.z)}this.handleEventListener(t)}if(t==s.kT.HANDLE_PICK_LEFT&&e.layerId==this.id){let i=new l.Ilk(e.pickColor);for(const e of this.data){let a=e.find((t=>t.pickColor.equals(i)));if(a){this.selectId=a.id,this.updateSelectLink(),this.handleEventListener(t,a);break}this.selectId=-1,this.updateSelectLink()}}}onAdd(t){super.onAdd(t),this.update()}setData(t,e){try{this.selectId=e,this.center=t[0][0].fromxy,this.data=JSON.parse(JSON.stringify(t)).map((t=>{let e=t.length,i=[];for(let a=0;a<e;a++){const e=JSON.parse(JSON.stringify(t[a]));e.pickColor=this.getPickMeshColor(),e.fromPoint=e.fromxy.map(((t,e)=>Math.round(t-this.center[e]))),e.toPoint=e.toxy.map(((t,e)=>Math.round(t-this.center[e]))),i.push(e)}return i}))}catch(i){this.data=null,this.selectId=null}this.update(),this.updateSelectLink()}setSelectId(t){this.selectId!=t&&(this.selectId=t,this.updateSelectLink())}update(){if(this.clearScene(),!this.map)return;if(!this.data)return;this.material=this.getMaterial({vertexColors:!0}),this.pickLayerMaterial=this.getMaterial({color:this.pickLayerColor,pickOffset:10}),this.pickMaterial=this.getMaterial({vertexColors:!0,usePickColor:!0,pickOffset:10});const[t,e]=this.map.WebMercatorToCanvasXY(...this.center);let i=this.getGeometry();const a=new l.Kj0(i,this.material);a.position.set(t,e,0),this.scene.add(a);const r=new l.Kj0(i,this.pickLayerMaterial);r.position.set(t,e,0),this.pickLayerScene.add(r);const s=new l.Kj0(i,this.pickMaterial);s.position.set(t,e,0),this.pickMeshScene.add(s)}setValues(t){for(const e in t)this[e]=t[e];this.material&&(this.material.needsUpdate=!0),this.pickLayerMaterial&&(this.pickLayerMaterial.needsUpdate=!0),this.pickMaterial&&(this.pickMaterial.needsUpdate=!0),this.selectMesh&&(this.selectMesh.material.needsUpdate=!0)}updateSelectLink(){if(this.selectMesh&&(this.selectMesh.removeFromParent(),this.selectMesh=null),!this.selectId)return;let t=this.getSelectGeometry(),e=this.getMaterial({color:16777215,opacity:.8,transparent:!0});const[i,a]=this.map.WebMercatorToCanvasXY(...this.center);this.selectMesh=new l.Kj0(t,e),this.selectMesh.position.set(i,a,0),this.scene.add(this.selectMesh)}getSelectGeometry(){const t=[],e=[],i=[],a=[],r=[],s=[],n=[],o=[];for(const l of this.data)for(let h=0;h<l.length;h++){const d=l[h];if(d.id==this.selectId){const c=0==h?d:l[h-1],u=h==l.length-1?d:l[h+1],p=d.pickColor,g=S[d.statsType]||this.color,m=c.fromPoint,f=d.fromPoint,v=d.toPoint,y=u.toPoint;e.push(m),e.push(m),t.push([...f,0]),t.push([...f,0]),i.push(v),i.push(v),a.push(1),a.push(-1),n.push([p.r,p.g,p.b]),n.push([p.r,p.g,p.b]),o.push([g.r,g.g,g.b]),o.push([g.r,g.g,g.b]),s.push([0,0]),s.push([1,0]),r.push([0,1,3]),e.push(f),e.push(f),t.push([...v,0]),t.push([...v,0]),i.push(y),i.push(y),a.push(1),a.push(-1),n.push([p.r,p.g,p.b]),n.push([p.r,p.g,p.b]),o.push([g.r,g.g,g.b]),o.push([g.r,g.g,g.b]),s.push([0,1]),s.push([1,1]),r.push([0,3,2])}}const h=new l.u9r;return h.setAttribute("position",new l.TlE(new Float32Array(t.flat()),3)),h.setAttribute("startPosition",new l.TlE(new Float32Array(e.flat()),2)),h.setAttribute("endPosition",new l.TlE(new Float32Array(i.flat()),2)),h.setAttribute("side",new l.TlE(new Float32Array(a.flat()),1)),h.setAttribute("uv",new l.TlE(new Float32Array(s.flat()),2)),h.setAttribute("pickColor",new l.TlE(new Float32Array(n.flat()),3)),h.setAttribute("color",new l.TlE(new Float32Array(o.flat()),3)),h.index=new l.TlE(new Uint16Array(r.flat()),1),h}getMaterial({usePickColor:t,pickOffset:e,...i}){const a=new l.vBJ({side:l.ehD,transparent:!0,wireframe:!1,...i});return a.onBeforeCompile=i=>{i.vertexShader=i.vertexShader.replace("#include <common>","\n          #include <common>\n\n          vec3 lineOffset(vec2 start, vec3 current, vec2 end, float offset) {\n            float lenA = length(current.xy - start);\n            float lenB = length(current.xy - end);\n\n            if(lenA == 0. && lenB == 0.) return current;\n\n            vec2 dirA = normalize(current.xy - start);\n            vec2 dirB = normalize(current.xy - end);\n\n            if(lenA == 0.) {\n              float angle = PI / 2.0;\n              vec2 normal = vec2(-dirB.y, dirB.x);\n              return vec3(current.xy + normal * offset / sin(angle), current.z);\n            } else if(lenB == 0.) {\n              float angle = PI / 2.0;\n              vec2 normal = vec2(dirA.y, -dirA.x);\n              return vec3(current.xy + normal * offset / sin(angle), current.z);\n            } else {\n              vec2 dir = normalize(dirB - dirA);\n              vec2 normal = vec2(-dir.y, dir.x);\n              float angle = acos(dot(dirB, normal));\n              return vec3(current.xy + normal * offset / sin(angle), current.z);\n            }\n          }\n\n          attribute vec3 pickColor;\n          attribute float side;\n          attribute vec2 startPosition;\n          attribute vec2 endPosition;\n        "),i.vertexShader=i.vertexShader.replace("#include <begin_vertex>",`\n          #include <begin_vertex>\n          float lineWidth = ${Number(this.lineWidth+(e||0)).toFixed(2)};\n          float twoWayOffset = ${Number(this.twoWayOffset).toFixed(2)};\n          float isTwoWay = ${this.isTwoWay.toFixed(1)};\n          float offset = lineWidth / 2.0 * side + isTwoWay * twoWayOffset;\n          transformed = lineOffset(startPosition, position, endPosition, offset);\n        `),t&&(i.vertexShader=i.vertexShader.replace("#include <color_vertex>","\n            #include <color_vertex>\n            #if defined( USE_COLOR_ALPHA )\n              vColor = vec4(pickColor,1.0);\n            #elif defined( USE_COLOR )\n              vColor = pickColor;\n            #endif\n          "))},a.customProgramCacheKey=()=>JSON.stringify({uuid:a.uuid,lineWidth:this.lineWidth,twoWayOffset:this.twoWayOffset,isTwoWay:this.isTwoWay,usePickColor:t,pickOffset:e}),a}getGeometry(){const t=[];for(const e of this.data){const i=e.length,a=new l.TlE(new Float32Array(4*i*3+6),3),r=new l.TlE(new Float32Array(4*i*2+4),2),s=new l.TlE(new Float32Array(4*i*2+4),2),n=new l.TlE(new Float32Array(4*i+2),1),o=new l.TlE(new Uint16Array(2*i*3+6),1),h=new l.TlE(new Float32Array(4*i*2+2),2),d=new l.TlE(new Float32Array(4*i*3+6),3),c=new l.TlE(new Float32Array(4*i*3+6),3);for(let t=0;t<e.length;t++){const i=e[t],u=0==t?i:e[t-1],p=t==e.length-1?i:e[t+1],g=i.pickColor,m=S[i.statsType]||this.color,f=u.fromPoint,v=i.fromPoint,y=i.toPoint,b=p.toPoint;if(r.setXY(4*t,f[0],f[1]),r.setXY(4*t+1,f[0],f[1]),a.setXYZ(4*t,v[0],v[1],0),a.setXYZ(4*t+1,v[0],v[1],0),s.setXY(4*t,y[0],y[1]),s.setXY(4*t+1,y[0],y[1]),n.setX(4*t,1),n.setX(4*t+1,-1),d.setXYZ(4*t,g.r,g.g,g.b),d.setXYZ(4*t+1,g.r,g.g,g.b),c.setXYZ(4*t,m.r,m.g,m.b),c.setXYZ(4*t+1,m.r,m.g,m.b),r.setXY(4*t+2,v[0],v[1]),r.setXY(4*t+3,v[0],v[1]),a.setXYZ(4*t+2,y[0],y[1],0),a.setXYZ(4*t+3,y[0],y[1],0),s.setXY(4*t+2,b[0],b[1]),s.setXY(4*t+3,b[0],b[1]),n.setX(4*t+2,1),n.setX(4*t+3,-1),d.setXYZ(4*t+2,g.r,g.g,g.b),d.setXYZ(4*t+3,g.r,g.g,g.b),c.setXYZ(4*t+2,m.r,m.g,m.b),c.setXYZ(4*t+3,m.r,m.g,m.b),h.setXY(4*t,0,0),h.setXY(4*t+1,1,0),h.setXY(4*t+2,0,1),h.setXY(4*t+3,1,1),o.setX(6*t,4*t),o.setX(6*t+1,4*t+1),o.setX(6*t+2,4*t+3),o.setX(6*t+3,4*t),o.setX(6*t+4,4*t+3),o.setX(6*t+5,4*t+2),t==e.length-1){const e=new l.FM8(...v),i=new l.FM8(...y),u=new l.FM8(0,0);u.subVectors(e,i),u.setLength(15),u.add(i),u.round();const p=new l.FM8(0,0);p.subVectors(e,i),p.setLength(50),p.add(i),p.round(),r.setXY(4*t+4,p.x,p.y),r.setXY(4*t+5,p.x,p.y),a.setXYZ(4*t+4,u.x,u.y,0),a.setXYZ(4*t+5,u.x,u.y,0),s.setXY(4*t+4,y[0],y[1]),s.setXY(4*t+5,y[0],y[1]),n.setX(4*t+4,2),n.setX(4*t+5,4),d.setXYZ(4*t+4,g.r,g.g,g.b),d.setXYZ(4*t+5,g.r,g.g,g.b),c.setXYZ(4*t+4,m.r,m.g,m.b),c.setXYZ(4*t+5,m.r,m.g,m.b),h.setXY(4*t+4,0,0),h.setXY(4*t+5,1,0),o.setX(6*t+6,4*t+2),o.setX(6*t+7,4*t+4),o.setX(6*t+8,4*t+5),o.setX(6*t+9,4*t+3),o.setX(6*t+10,4*t+2),o.setX(6*t+11,4*t+4)}}const u=new l.u9r;u.setAttribute("position",a),u.setAttribute("startPosition",r),u.setAttribute("endPosition",s),u.setAttribute("side",n),u.setAttribute("uv",h),u.setAttribute("pickColor",d),u.setAttribute("color",c),u.index=o,t.push(u)}return m(t,!1)}}class k extends s.mh{constructor(t){super(t),(0,o.Z)(this,"name","LinkStatsLayer"),(0,o.Z)(this,"size",100),(0,o.Z)(this,"data",[]),(0,o.Z)(this,"color",null),this.size=t.size||100,this.data=t.data,this.color=t.color||A,this.texture=(new l.dpR).load(i(3509)),this.geometry=new l.u9r,this.material=this.getMaterial({map:this.texture,vertexColors:!0,usePickColor:!1}),this.mesh=new l.woe(this.geometry,this.material),this.mesh.userData.center=[0,0],this.mesh.position.set(0,0,0),this.scene.add(this.mesh),this.pickLayerMaterial=this.getMaterial({color:this.pickLayerColor,vertexColors:!1,usePickColor:!1}),this.pickLayerMesh=new l.woe(this.geometry,this.pickLayerMaterial),this.mesh.userData.center=[0,0],this.pickLayerMesh.position.set(0,0,0),this.pickLayerScene.add(this.pickLayerMesh),this.pickMaterial=this.getMaterial({vertexColors:!0,usePickColor:!0}),this.pickMesh=new l.woe(this.geometry,this.pickMaterial),this.mesh.userData.center=[0,0],this.pickMesh.position.set(0,0,0),this.pickMeshScene.add(this.pickMesh)}on(t,e){if(t==s.kT.UPDATE_CENTER){for(const t of this.scene.children){const[e,i]=this.map.WebMercatorToCanvasXY(...t.userData.center);t.position.set(e,i,t.position.z)}for(const t of this.pickLayerScene.children){const[e,i]=this.map.WebMercatorToCanvasXY(...t.userData.center);t.position.set(e,i,t.position.z)}for(const t of this.pickMeshScene.children){const[e,i]=this.map.WebMercatorToCanvasXY(...t.userData.center);t.position.set(e,i,t.position.z)}this.handleEventListener(t)}t==s.kT.HANDLE_PICK_LEFT&&e.layerId==this.id&&this.handleEventListener(t,this.data[e.pickColor-1]),t==s.kT.UPDATE_CAMERA_HEIGHT&&this.setSize(this.map.cameraHeight/20)}onAdd(t){super.onAdd(t),this.update(),this.setSize(this.map.cameraHeight/20)}setSize(t){this.size=t,this.material&&(this.material.setValues({size:t}),this.material.needsUpdate=!0),this.pickLayerMaterial&&(this.pickLayerMaterial.setValues({size:t}),this.pickLayerMaterial.needsUpdate=!0),this.pickMaterial&&(this.pickMaterial.setValues({size:t}),this.pickMaterial.needsUpdate=!0),this.mesh&&(this.mesh.position.z=0),this.pickLayerMesh&&(this.pickLayerMesh.position.z=0),this.pickMesh&&(this.pickMesh.position.z=0)}setData(t){this.data=t,this.update()}update(){if(!this.map)return;if(!this.data)return;const t=this.data.length,e=new l.TlE(new Float32Array(3*t),3),i=new l.TlE(new Float32Array(3*t),3),a=new l.TlE(new Float32Array(3*t),3);let r=[];for(let o=0;o<t;o++){const t=this.data[o];0==o&&(r=[t.x,t.y]),e.setXYZ(o,t.x-r[0],t.y-r[1],0);const s=new l.Ilk(o+1);i.setXYZ(o,s.r,s.g,s.b);const n=S[t.type]||this.color;a.setXYZ(o,n.r,n.g,n.b)}this.geometry.setAttribute("position",e),this.geometry.setAttribute("pickColor",i),this.geometry.setAttribute("color",a),this.geometry.needsUpdate=!0,this.geometry.computeBoundingSphere();let[s,n]=this.map.WebMercatorToCanvasXY(...r);this.mesh.userData.center=r,this.mesh.position.set(s,n,0),this.pickLayerMesh.userData.center=r,this.pickLayerMesh.position.set(s,n,0),this.pickMesh.userData.center=r,this.pickMesh.position.set(s,n,0)}getMaterial({usePickColor:t,...e}){const i=new l.UY4({size:this.size,transparent:!0,sizeAttenuation:!0,...e});return i.onBeforeCompile=e=>{t&&(e.vertexShader=e.vertexShader.replace("#include <color_pars_vertex>","\n            #include <color_pars_vertex>\n            attribute vec3 pickColor;\n          "),e.vertexShader=e.vertexShader.replace("#include <color_vertex>","\n            #include <color_vertex>\n            vColor.rgb = pickColor.rgb;\n          "))},i.customProgramCacheKey=()=>JSON.stringify({uuid:i.uuid,usePickColor:t}),i}}const L=new l.Ilk(9474969);class E extends s.mh{constructor(t){super(t),(0,o.Z)(this,"name","GuangZhouLayer"),(0,o.Z)(this,"data",null),(0,o.Z)(this,"color",null),(0,o.Z)(this,"lineWidth",4),(0,o.Z)(this,"material",null),(0,o.Z)(this,"pickLayerMaterial",null),(0,o.Z)(this,"pickMaterial",null),(0,o.Z)(this,"highMaterial",null),(0,o.Z)(this,"geometry",null),this.setData(t.data),this.color=t.color||L,this.lineWidth=t.lineWidth||1}on(t,e){if(t==s.kT.UPDATE_CENTER){for(const t of this.scene.children){const[e,i]=this.map.WebMercatorToCanvasXY(...this.data.center);t.position.set(e,i,t.position.z)}for(const t of this.pickLayerScene.children){const[e,i]=this.map.WebMercatorToCanvasXY(...this.data.center);t.position.set(e,i,t.position.z)}for(const t of this.pickMeshScene.children){const[e,i]=this.map.WebMercatorToCanvasXY(...this.data.center);t.position.set(e,i,t.position.z)}this.handleEventListener(t)}t==s.kT.UPDATE_CAMERA_HEIGHT&&this.setValues({lineWidth:this.map.cameraHeight/400})}onAdd(t){super.onAdd(t),this.setValues({lineWidth:this.map.cameraHeight/400}),this.update()}setData(t){this.data=t,this.update()}update(){if(this.clearScene(),!this.map)return;if(!this.data)return;this.material=this.getMaterial({color:this.color}),this.pickLayerMaterial=this.getMaterial({color:this.pickLayerColor,pickOffset:10}),this.pickMaterial=this.getMaterial({vertexColors:!0,usePickColor:!0,pickOffset:10});const[t,e]=this.map.WebMercatorToCanvasXY(...this.data.center),i=this.getGeometry(),a=new l.Kj0(i,this.material);a.position.set(t,e,0),this.scene.add(a);const r=new l.Kj0(i,this.pickLayerMaterial);r.position.set(t,e,0),this.pickLayerScene.add(r);const s=new l.Kj0(i,this.pickMaterial);s.position.set(t,e,0),this.pickMeshScene.add(s)}setValues(t){for(const e in t)this[e]=t[e];this.material&&(this.material.needsUpdate=!0),this.pickLayerMaterial&&(this.pickLayerMaterial.needsUpdate=!0),this.pickMaterial&&(this.pickMaterial.needsUpdate=!0)}getMaterial({usePickColor:t,pickOffset:e,...i}){const a=new l.vBJ({side:l.ehD,transparent:!0,wireframe:!1,...i});return a.onBeforeCompile=i=>{i.vertexShader=i.vertexShader.replace("#include <common>","\n          #include <common>\n          vec3 lineOffset(vec2 start, vec3 current, vec2 end, float offset) {\n            float lenA = length(current.xy - start);\n            float lenB = length(current.xy - end);\n\n            if(lenA == 0. && lenB == 0.) return current;\n\n            vec2 dirA = normalize(current.xy - start);\n            vec2 dirB = normalize(current.xy - end);\n\n            if(lenA == 0.) {\n              float angle = PI / 2.0;\n              vec2 normal = vec2(-dirB.y, dirB.x);\n              return vec3(current.xy + normal * offset / sin(angle), current.z);\n            } else if(lenB == 0.) {\n              float angle = PI / 2.0;\n              vec2 normal = vec2(dirA.y, -dirA.x);\n              return vec3(current.xy + normal * offset / sin(angle), current.z);\n            } else {\n              vec2 dir = normalize(dirB - dirA);\n              vec2 normal = vec2(-dir.y, dir.x);\n              float angle = acos(dot(dirB, normal));\n              return vec3(current.xy + normal * offset / sin(angle), current.z);\n            }\n          }\n\n          attribute vec3 pickColor;\n          attribute float side;\n          attribute vec2 startPosition;\n          attribute vec2 endPosition;\n        "),i.vertexShader=i.vertexShader.replace("#include <begin_vertex>",`\n          #include <begin_vertex>\n          float lineWidth = ${Number(this.lineWidth+(e||0)).toFixed(2)};\n          float offset = lineWidth / 2.0  * side;\n          transformed = lineOffset(startPosition, position, endPosition, offset);\n        `),t&&(i.vertexShader=i.vertexShader.replace("#include <color_vertex>","\n            #include <color_vertex>\n            #if defined( USE_COLOR_ALPHA )\n              vColor = vec4(pickColor,1.0);\n            #elif defined( USE_COLOR )\n              vColor = pickColor;\n            #endif\n          "))},a.customProgramCacheKey=()=>JSON.stringify({uuid:a.uuid,lineWidth:this.lineWidth,usePickColor:t,pickOffset:e}),a}getGeometry(){const t=[];for(const e of this.data.lineList){const i=e.length,a=new l.TlE(new Float32Array(4*i*3),3),r=new l.TlE(new Float32Array(4*i*2),2),s=new l.TlE(new Float32Array(4*i*2),2),n=new l.TlE(new Float32Array(4*i),1),o=new l.TlE(new Uint16Array(2*i*3),1),h=new l.TlE(new Float32Array(4*i*2),2),d=new l.TlE(new Float32Array(4*i*3),3),c=new l.TlE(new Float32Array(4*i*3),3);for(let t=0;t<e.length;t++){const i=e[t],l=0==t?i:e[t-1],u=t==e.length-1?i:e[t+1],p=this.color,g=this.getPickMeshColor(),m=l.fromxy,f=i.fromxy,v=i.toxy,y=u.toxy;r.setXY(4*t,m[0],m[1]),r.setXY(4*t+1,m[0],m[1]),a.setXYZ(4*t,f[0],f[1],0),a.setXYZ(4*t+1,f[0],f[1],0),s.setXY(4*t,v[0],v[1]),s.setXY(4*t+1,v[0],v[1]),n.setX(4*t,1),n.setX(4*t+1,-1),d.setXYZ(4*t,g.r,g.g,g.b),d.setXYZ(4*t+1,g.r,g.g,g.b),c.setXYZ(4*t,p.r,p.g,p.b),c.setXYZ(4*t+1,p.r,p.g,p.b),r.setXY(4*t+2,f[0],f[1]),r.setXY(4*t+3,f[0],f[1]),a.setXYZ(4*t+2,v[0],v[1],0),a.setXYZ(4*t+3,v[0],v[1],0),s.setXY(4*t+2,y[0],y[1]),s.setXY(4*t+3,y[0],y[1]),n.setX(4*t+2,1),n.setX(4*t+3,-1),d.setXYZ(4*t+2,g.r,g.g,g.b),d.setXYZ(4*t+3,g.r,g.g,g.b),c.setXYZ(4*t+2,p.r,p.g,p.b),c.setXYZ(4*t+3,p.r,p.g,p.b),h.setXY(4*t,0,0),h.setXY(4*t+1,1,0),h.setXY(4*t+2,0,1),h.setXY(4*t+3,1,1),o.setX(6*t,4*t),o.setX(6*t+1,4*t+1),o.setX(6*t+2,4*t+3),o.setX(6*t+3,4*t),o.setX(6*t+4,4*t+3),o.setX(6*t+5,4*t+2)}const u=new l.u9r;u.setAttribute("position",a),u.setAttribute("startPosition",r),u.setAttribute("endPosition",s),u.setAttribute("side",n),u.setAttribute("uv",h),u.setAttribute("pickColor",d),u.setAttribute("color",c),u.index=o,t.push(u)}return m(t,!1)}}const M={0:new l.Ilk(9474969),1:new l.Ilk(4235007),2:new l.Ilk(15114812),3:new l.Ilk(6799930),4:new l.Ilk(16084076)},T=M[0];class F extends s.mh{constructor(t){super(t),(0,o.Z)(this,"name","IntersectionListLayer"),(0,o.Z)(this,"size",100),(0,o.Z)(this,"data",[]),(0,o.Z)(this,"color",null),this.size=t.size||100,this.data=t.data,this.color=t.color||T,this.texture=(new l.dpR).load(t.texture||i(2219)),this.geometry=new l.u9r,this.material=this.getMaterial({map:this.texture,vertexColors:!0,usePickColor:!1}),this.mesh=new l.woe(this.geometry,this.material),this.mesh.userData.center=[0,0],this.mesh.position.set(0,0,0),this.scene.add(this.mesh),this.pickLayerMaterial=this.getMaterial({color:this.pickLayerColor,vertexColors:!1,usePickColor:!1}),this.pickLayerMesh=new l.woe(this.geometry,this.pickLayerMaterial),this.mesh.userData.center=[0,0],this.pickLayerMesh.position.set(0,0,0),this.pickLayerScene.add(this.pickLayerMesh),this.pickMaterial=this.getMaterial({vertexColors:!0,usePickColor:!0}),this.pickMesh=new l.woe(this.geometry,this.pickMaterial),this.mesh.userData.center=[0,0],this.pickMesh.position.set(0,0,0),this.pickMeshScene.add(this.pickMesh)}on(t,e){if(t==s.kT.UPDATE_CENTER){for(const t of this.scene.children){const[e,i]=this.map.WebMercatorToCanvasXY(...t.userData.center);t.position.set(e,i,t.position.z)}for(const t of this.pickLayerScene.children){const[e,i]=this.map.WebMercatorToCanvasXY(...t.userData.center);t.position.set(e,i,t.position.z)}for(const t of this.pickMeshScene.children){const[e,i]=this.map.WebMercatorToCanvasXY(...t.userData.center);t.position.set(e,i,t.position.z)}this.handleEventListener(t)}t==s.kT.HANDLE_PICK_LEFT&&e.layerId==this.id&&(console.log(e.pickColor),this.handleEventListener(t,this.data[e.pickColor-1])),t==s.kT.UPDATE_CAMERA_HEIGHT&&this.setSize(this.map.cameraHeight/20)}onAdd(t){super.onAdd(t),this.update(),this.setSize(this.map.cameraHeight/20)}setSize(t){this.size=t,this.material&&(this.material.setValues({size:t}),this.material.needsUpdate=!0),this.pickLayerMaterial&&(this.pickLayerMaterial.setValues({size:t}),this.pickLayerMaterial.needsUpdate=!0),this.pickMaterial&&(this.pickMaterial.setValues({size:t}),this.pickMaterial.needsUpdate=!0),this.mesh&&(this.mesh.position.z=0),this.pickLayerMesh&&(this.pickLayerMesh.position.z=0),this.pickMesh&&(this.pickMesh.position.z=0)}setData(t){this.data=t,this.update()}update(){if(!this.map)return;if(!this.data)return;const t=this.data.length,e=new l.TlE(new Float32Array(3*t),3),i=new l.TlE(new Float32Array(3*t),3),a=new l.TlE(new Float32Array(3*t),3);let r=[];for(let o=0;o<t;o++){const t=this.data[o];0==o&&(r=[t.x,t.y]),e.setXYZ(o,t.x-r[0],t.y-r[1],0);const s=new l.Ilk(o+1);i.setXYZ(o,s.r,s.g,s.b);const n=M[t.status]||M[1];a.setXYZ(o,n.r,n.g,n.b)}this.geometry.setAttribute("position",e),this.geometry.setAttribute("pickColor",i),this.geometry.setAttribute("color",a),this.geometry.needsUpdate=!0,this.geometry.computeBoundingSphere();let[s,n]=this.map.WebMercatorToCanvasXY(...r);this.mesh.userData.center=r,this.mesh.position.set(s,n,0),this.pickLayerMesh.userData.center=r,this.pickLayerMesh.position.set(s,n,0),this.pickMesh.userData.center=r,this.pickMesh.position.set(s,n,0)}getMaterial({usePickColor:t,...e}){const i=new l.UY4({size:this.size,transparent:!0,sizeAttenuation:!0,...e});return i.onBeforeCompile=e=>{t&&(e.vertexShader=e.vertexShader.replace("#include <color_pars_vertex>","\n            #include <color_pars_vertex>\n            attribute vec3 pickColor;\n          "),e.vertexShader=e.vertexShader.replace("#include <color_vertex>","\n            #include <color_vertex>\n            vColor.rgb = pickColor.rgb;\n          "))},i.customProgramCacheKey=()=>JSON.stringify({uuid:i.uuid,usePickColor:t}),i}}class D extends s.mh{constructor(t){super(t),(0,o.Z)(this,"name","ImageListLayer"),(0,o.Z)(this,"size",100),(0,o.Z)(this,"data",[]),(0,o.Z)(this,"color",null),this.size=t.size||100,this.data=t.data,this.color=t.color||new l.Ilk("orange"),this.hColor=t.hColor||new l.Ilk("#67C23A"),this.texture=(new l.dpR).load(t.texture||i(5564)),this.geometry=new l.u9r,this.material=this.getMaterial({map:this.texture,vertexColors:!0,usePickColor:!1}),this.mesh=new l.woe(this.geometry,this.material),this.mesh.userData.center=[0,0],this.mesh.position.set(0,0,0),this.scene.add(this.mesh),this.pickLayerMaterial=this.getMaterial({color:this.pickLayerColor,vertexColors:!1,usePickColor:!1}),this.pickLayerMesh=new l.woe(this.geometry,this.pickLayerMaterial),this.pickLayerMesh.userData.center=[0,0],this.pickLayerMesh.position.set(0,0,0),this.pickLayerScene.add(this.pickLayerMesh),this.pickMaterial=this.getMaterial({vertexColors:!0,usePickColor:!0}),this.pickMesh=new l.woe(this.geometry,this.pickMaterial),this.pickMesh.userData.center=[0,0],this.pickMesh.position.set(0,0,0),this.pickMeshScene.add(this.pickMesh),this.hGeometry=new l.u9r,this.hGeometry.setAttribute("position",new l.TlE(new Float32Array([0,0,0]),3)),this.hMaterial=this.getMaterial({map:this.texture,color:this.hColor,vertexColors:!1,usePickColor:!1}),this.hMesh=new l.woe(this.hGeometry,this.hMaterial),this.hMesh.userData.center=[0,0],this.hMesh.position.set(0,0,-1e3)}on(t,e){if(t==s.kT.UPDATE_CENTER){for(const t of this.scene.children){const[e,i]=this.map.WebMercatorToCanvasXY(...t.userData.center);t.position.set(e,i,t.position.z)}for(const t of this.pickLayerScene.children){const[e,i]=this.map.WebMercatorToCanvasXY(...t.userData.center);t.position.set(e,i,t.position.z)}for(const t of this.pickMeshScene.children){const[e,i]=this.map.WebMercatorToCanvasXY(...t.userData.center);t.position.set(e,i,t.position.z)}this.handleEventListener(t)}t==s.kT.HANDLE_PICK_LEFT&&e.layerId==this.id&&this.handleEventListener(t,this.data[e.pickColor-1]),t==s.kT.UPDATE_CAMERA_HEIGHT&&this.setSize(this.map.cameraHeight/20)}onAdd(t){super.onAdd(t),this.update(),this.setSize(this.map.cameraHeight/20)}setSize(t){this.size=t,this.material&&(this.material.setValues({size:t}),this.material.needsUpdate=!0),this.hMaterial&&(this.hMaterial.setValues({size:t}),this.hMaterial.needsUpdate=!0),this.pickLayerMaterial&&(this.pickLayerMaterial.setValues({size:t}),this.pickLayerMaterial.needsUpdate=!0),this.pickMaterial&&(this.pickMaterial.setValues({size:t}),this.pickMaterial.needsUpdate=!0),this.hMesh&&(this.hMesh.position.z=1),this.mesh&&(this.mesh.position.z=0),this.pickLayerMesh&&(this.pickLayerMesh.position.z=0),this.pickMesh&&(this.pickMesh.position.z=0)}setData(t){this.data=t,this.update()}setHMesh(t){if(console.log(t),t){const e=[t.x,t.y];if(this.hMesh.userData.center=e,this.map){let[t,i]=this.map.WebMercatorToCanvasXY(...e);this.hMesh.position.set(t,i,1)}this.scene.add(this.hMesh)}else this.scene.remove(this.hMesh)}update(){if(!this.map)return;if(!this.data)return;const t=this.data.length,e=new l.TlE(new Float32Array(3*t),3),i=new l.TlE(new Float32Array(3*t),3),a=new l.TlE(new Float32Array(3*t),3);let r=[];for(let o=0;o<t;o++){const t=this.data[o];0==o&&(r=[t.x,t.y]),e.setXYZ(o,t.x-r[0],t.y-r[1],0);const s=new l.Ilk(o+1);i.setXYZ(o,s.r,s.g,s.b);const n=this.color;a.setXYZ(o,n.r,n.g,n.b)}this.geometry.setAttribute("position",e),this.geometry.setAttribute("pickColor",i),this.geometry.setAttribute("color",a),this.geometry.needsUpdate=!0,this.geometry.computeBoundingSphere();let[s,n]=this.map.WebMercatorToCanvasXY(...r);this.mesh.userData.center=r,this.mesh.position.set(s,n,0),this.pickLayerMesh.userData.center=r,this.pickLayerMesh.position.set(s,n,0),this.pickMesh.userData.center=r,this.pickMesh.position.set(s,n,0)}getMaterial({usePickColor:t,...e}){const i=new l.UY4({size:this.size,transparent:!0,sizeAttenuation:!0,...e});return i.onBeforeCompile=e=>{t&&(e.vertexShader=e.vertexShader.replace("#include <color_pars_vertex>","\n            #include <color_pars_vertex>\n            attribute vec3 pickColor;\n          "),e.vertexShader=e.vertexShader.replace("#include <color_vertex>","\n            #include <color_vertex>\n            vColor.rgb = pickColor.rgb;\n          "))},i.customProgramCacheKey=()=>JSON.stringify({uuid:i.uuid,usePickColor:t}),i}}var P=function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"el-zoom-in-right"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"LineFlow"},[e("div",{staticClass:"_header"},[e("i",{staticClass:"el-icon-close",on:{click:t.close}}),e("span",{staticStyle:{"margin-left":"20px"}},[t._v("Link流量详情")])]),e("div",{staticClass:"_bodyer"},[e("el-row",{attrs:{gutter:10}},[e("el-col",{attrs:{span:t.infoEdit?24:8}},[e("el-form",{ref:"infoForm",staticClass:"form_box",attrs:{model:t.infoForm,rules:t.infoRules,"label-width":"100px",inline:!1,size:"small","label-position":"left"}},[e("el-form-item",{attrs:{label:"SegmentID：",prop:"origid"}},[t.infoEdit?[t._v(t._s(t.infoForm.origid))]:[t._v(t._s(t.info.origid))]],2),e("el-form-item",{attrs:{label:"LinkID：",prop:"id"}},[t.infoEdit?[t._v(t._s(t.infoForm.id))]:[t._v(t._s(t.info.id))]],2),e("el-form-item",{attrs:{label:"道路名称：",prop:"name"}},[t.infoEdit?e("el-input",{model:{value:t.infoForm.name,callback:function(e){t.$set(t.infoForm,"name",e)},expression:"infoForm.name"}}):[t._v(t._s(t.info.name))]],2),e("el-form-item",{attrs:{label:"车道数：",prop:"lane"}},[t.infoEdit?e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,step:1,"step-strictly":""},model:{value:t.infoForm.lane,callback:function(e){t.$set(t.infoForm,"lane",e)},expression:"infoForm.lane"}}):[t._v(t._s(t.info.lane))]],2),e("el-form-item",{attrs:{label:"道路类型：",prop:"type"}},[t.infoEdit?e("el-select",{staticStyle:{width:"100%"},model:{value:t.infoForm.type,callback:function(e){t.$set(t.infoForm,"type",e)},expression:"infoForm.type"}},t._l(t.linkTypeOption,(function(t,i){return e("el-option",{key:i,attrs:{label:t,value:i}})})),1):[t._v(t._s(t.linkTypeOption[t.info.type]))]],2),e("el-form-item",{attrs:{label:"自由流速度：",prop:"freespeed"}},[t.infoEdit?e("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0},model:{value:t.infoForm.freespeed,callback:function(e){t.$set(t.infoForm,"freespeed",e)},expression:"infoForm.freespeed"}}):[t._v(t._s(t.info.freespeed)+" 米 / 秒")]],2),e("el-form-item",{attrs:{"label-width":"0px"}},[t.infoEdit?t._e():[e("el-button",{attrs:{type:"primary"},on:{click:t.handleEditInfo}},[t._v("编辑")]),e("el-button",{attrs:{type:"primary"},on:{click:t.handleReverse}},[t._v("切换反向道路")])],t.infoEdit?[e("el-button",{attrs:{type:"success"},on:{click:t.handleUpdateLink}},[t._v("更新当前link")]),e("el-button",{attrs:{type:"success"},on:{click:t.handleUpdateInWay}},[t._v("更新整段segment")]),e("el-button",{attrs:{type:"warning"},on:{click:t.handleCloseEditInfo}},[t._v("取消")])]:t._e()],2)],1)],1),e("el-col",{attrs:{span:t.infoEdit?24:16}},[e("div",{staticClass:"chart_box"},[e("div",{ref:"echart",staticClass:"chart"})])]),e("el-col",{attrs:{span:24}},[e("div",{staticStyle:{"font-size":"14px","line-height":"32px","margin-bottom":"10px"}},[e("span",{staticStyle:{width:"100px"}},[t._v("历史信息：")]),e("el-select",{attrs:{clearable:"",multiple:"",size:"small"},on:{change:t.handleQuery},model:{value:t.queryParams.type,callback:function(e){t.$set(t.queryParams,"type",e)},expression:"queryParams.type"}},t._l(t.typeOptions,(function(t,i){return e("el-option",{key:i,attrs:{label:t,value:i}})})),1),e("el-button",{attrs:{icon:"el-icon-plus",type:"primary",size:"small"},on:{click:t.handleAdd}},[t._v("添加")])],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"small",attrs:{height:"calc(100vh - 450px)",data:t.dataList},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e("el-table-column",{attrs:{label:"编号",align:"center",prop:"id"}}),e("el-table-column",{attrs:{label:"调查开始时间",align:"center",prop:"beginTime"}}),e("el-table-column",{attrs:{label:"调查结束时间",align:"center",prop:"endTime"}}),e("el-table-column",{attrs:{label:"调查方式",align:"center",prop:"type"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return e("span",{},[t._v(t._s(t.typeOptions[i.type]||""))])}}])}),e("el-table-column",{attrs:{label:"pcu/h",align:"center",prop:"pcuH"}}),e("el-table-column",{attrs:{label:"小型客车",align:"center",prop:"scar"}}),e("el-table-column",{attrs:{label:"小型货车",align:"center",prop:"struck"}}),e("el-table-column",{attrs:{label:"中型客车",align:"center",prop:"mcar"}}),e("el-table-column",{attrs:{label:"中型货车",align:"center",prop:"mtruck"}}),e("el-table-column",{attrs:{label:"大型客车",align:"center",prop:"lcar"}}),e("el-table-column",{attrs:{label:"大型货车",align:"center",prop:"ltruck"}}),e("el-table-column",{attrs:{label:"视频",align:"center"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return e("a",{staticClass:"file_name",attrs:{href:`/file/download?url=${i.video}`}},[t._v(" "+t._s(i.video)+" ")])}}])}),e("el-table-column",{attrs:{label:"备注",align:"center",prop:"remark","show-overflow-tooltip":!0}}),e("el-table-column",{attrs:{label:"操作",fixed:"right","min-width":"150",align:"center","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(e){return t.handleUpdate(i.row)}}},[t._v("修改")]),e("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(e){return t.handleDelete(i.row)}}},[t._v("删除")])]}}])})],1),e("pagination",{staticStyle:{"line-height":"1","padding-top":"20px"},attrs:{layout:"total, sizes, prev, pager, next",pagerCount:5,total:t.total,page:t.queryParams.pageNum,limit:t.queryParams.pageSize},on:{"update:page":function(e){return t.$set(t.queryParams,"pageNum",e)},"update:limit":function(e){return t.$set(t.queryParams,"pageSize",e)},pagination:t.getList}})],1)],1)],1),e("Dialog",{attrs:{title:t.title,visible:t.open,left:440,width:"550px",handleClose:""},on:{"update:visible":function(e){t.open=e}}},[e("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"调查时间",prop:"timeList"}},[e("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.form.timeList,callback:function(e){t.$set(t.form,"timeList",e)},expression:"form.timeList"}}),e("div",{staticStyle:{color:"red"}},[t._v("注意: 请输入实际调查起止时间，时长需准确")])],1),e("el-form-item",{attrs:{label:"调查方式",prop:"type"}},[e("el-radio-group",{model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.typeOptions,(function(i,a){return e("el-radio",{key:a,attrs:{label:String(a)}},[t._v(t._s(i))])})),1)],1),e("el-form-item",{attrs:{label:"上传视频",prop:"video"}},[e("UploadVideo",{model:{value:t.form.video,callback:function(e){t.$set(t.form,"video",e)},expression:"form.video"}})],1),e("el-form-item",{attrs:{label:"视频录像是否可以覆盖到对向车道","label-width":"auto",prop:"isTwoWay"}},[e("el-switch",{attrs:{"active-value":!0,"inactive-value":!1},model:{value:t.form.isTwoWay,callback:function(e){t.$set(t.form,"isTwoWay",e)},expression:"form.isTwoWay"}})],1),e("el-form-item",{attrs:{label:"观察数据"}},[e("div",{staticStyle:{color:"red"}},[t._v("注：请输入实际观测到数量无需换算成一小时的量")]),e("el-form-item",{attrs:{label:"小型客车",prop:"scar","label-width":"auto"}},[e("el-input-number",{attrs:{step:1,"step-strictly":"",min:0},model:{value:t.form.scar,callback:function(e){t.$set(t.form,"scar",e)},expression:"form.scar"}}),t._v(" 辆 ")],1),e("el-form-item",{attrs:{label:"小型货车",prop:"struck","label-width":"auto"}},[e("el-input-number",{attrs:{step:1,"step-strictly":"",min:0},model:{value:t.form.struck,callback:function(e){t.$set(t.form,"struck",e)},expression:"form.struck"}}),t._v(" 辆 ")],1),e("el-form-item",{attrs:{label:"中型客车",prop:"mcar","label-width":"auto"}},[e("el-input-number",{attrs:{step:1,"step-strictly":"",min:0},model:{value:t.form.mcar,callback:function(e){t.$set(t.form,"mcar",e)},expression:"form.mcar"}}),t._v(" 辆 ")],1),e("el-form-item",{attrs:{label:"中型货车",prop:"mtruck","label-width":"auto"}},[e("el-input-number",{attrs:{step:1,"step-strictly":"",min:0},model:{value:t.form.mtruck,callback:function(e){t.$set(t.form,"mtruck",e)},expression:"form.mtruck"}}),t._v(" 辆 ")],1),e("el-form-item",{attrs:{label:"大型客车",prop:"lcar","label-width":"auto"}},[e("el-input-number",{attrs:{step:1,"step-strictly":"",min:0},model:{value:t.form.lcar,callback:function(e){t.$set(t.form,"lcar",e)},expression:"form.lcar"}}),t._v(" 辆 ")],1),e("el-form-item",{attrs:{label:"大型货车",prop:"ltruck","label-width":"auto"}},[e("el-input-number",{attrs:{step:1,"step-strictly":"",min:0},model:{value:t.form.ltruck,callback:function(e){t.$set(t.form,"ltruck",e)},expression:"form.ltruck"}}),t._v(" 辆 ")],1)],1),e("el-form-item",{attrs:{label:"备注",prop:"remark"}},[e("el-input",{attrs:{type:"textarea",placeholder:"请输入备注",autosize:{minRows:3}},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1),e("div",{staticClass:"dialog-footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确 定")]),e("el-button",{on:{click:t.cancel}},[t._v("取 消")])],1)],1)],1)])},I=[],N=i(7004);function R(t){return(0,N.Z)({url:"/osm/way/getGeomjson",method:"post",data:t})}function O(t){return(0,N.Z)({url:`/matsim/link/getMatsimLink/${t}`,method:"get"})}function B(t){return(0,N.Z)({url:`/link/stats/${t}`,method:"get"})}function G(t){return(0,N.Z)({url:"/link/stats/insert",method:"POST",data:t})}function U(t){return(0,N.Z)({url:"/link/stats/update",method:"POST",data:t})}function z(t){return(0,N.Z)({url:"/link/stats/queryByArea",method:"POST",data:t})}function W(t){return(0,N.Z)({url:"/link/stats/queryAllMaker",method:"get",params:t})}function V(t,e){return(0,N.Z)({url:`/link/stats/queryByLinkId/${t}`,method:"post",data:e})}function H(t){return(0,N.Z)({url:`/link/stats/delete/${t}`,method:"delete"})}function Y(t){return(0,N.Z)({url:"/link/stats/export",method:"post",responseType:"blob",data:t})}function X(t){return(0,N.Z)({url:`/matsim/link/${t}`,method:"get"})}function K(t){return(0,N.Z)({url:"/matsim/link/update",method:"post",data:t})}function Q(t){return(0,N.Z)({url:"/matsim/link/updateInWay",method:"post",data:t})}function q(){return(0,N.Z)({url:"/matsim/link/getAllHighwayType",method:"get"})}function Z(t){return(0,N.Z)({url:`/matsim/link/getReverseLink/${t}`,method:"get"})}function j(t){return(0,N.Z)({url:"/osm/way/getWayByName",method:"get",params:t})}function J(t){return(0,N.Z)({url:"/matsim/link/getLinkId",method:"get",params:t})}function $(t){return(0,N.Z)({url:"/link/stats/queryAvgStats",method:"post",data:t})}function tt(t){return(0,N.Z)({url:"/crossroads/insert",method:"post",data:t})}function et(t){return(0,N.Z)({url:"/crossroads/saveline",method:"post",data:t})}function it(t){return(0,N.Z)({url:"/crossroads/list",method:"post",data:t})}function at(t){return(0,N.Z)({url:`/crossroads/delete/${t}`,method:"delete"})}function rt(t){return(0,N.Z)({url:`/crossroads/corssStatsTable/${t}`,method:"get"})}function st(t){return(0,N.Z)({url:`/crossroads/deleteStats/${t}`,method:"delete"})}function nt(t){return(0,N.Z)({url:"/crossroads/updateStats",method:"post",data:t})}function ot(t){return(0,N.Z)({url:"/crossroads/insertStats",method:"post",data:t})}function lt(t){return(0,N.Z)({url:`/crossroads/runVehicleCounts/${t}`,method:"get"})}function ht(t){return window.open(`/crossroads/analyzeVideo/${t}`,"_blank")}function dt(t){return window.open(`/crossroads/trackImage/${t}`,"_blank")}function ct(t){return window.open(`/crossroads/exportCorssStatsTable/${t}`,"_blank")}function ut(t){return(0,N.Z)({url:`/crossroads/detail/${t}`,method:"get"})}function pt(t){return(0,N.Z)({url:"/intersection/list",method:"post",data:t})}function gt(t){return(0,N.Z)({url:`/intersection/detail/${t}`,method:"get"})}function mt(t){return(0,N.Z)({url:"/intersection/insert",method:"post",data:t})}function ft(t){return(0,N.Z)({url:"/intersection/update",method:"post",data:t})}function vt(t){return(0,N.Z)({url:"/crossroads/update",method:"post",data:t})}function yt(t){return(0,N.Z)({url:"/mappicture/allMaker",method:"post",data:t})}function bt(t){return(0,N.Z)({url:`/mappicture/delete/${t}`,method:"delete"})}function _t(t){return(0,N.Z)({url:"/mappicture/treeList",method:"post",data:t})}function wt(t){return(0,N.Z)({url:"/mappicture/deleteByPath",method:"post",data:t})}var Ct=i(1400),At={components:{},props:{visible:{type:Boolean},linkId:{type:[String,Number]}},watch:{linkId:{handler(t){t!=this._linkId&&(this._linkId=t,this.infoEdit=!1,this.visible&&(this.getAllLinkType(),this.getDetail(),this.handleQuery(),this.initEcharts()))},immediate:!0,deep:!0}},data(){return{info:{},infoEdit:!1,infoForm:{},infoRules:{},loading:!0,exportLoading:!1,ids:[],single:!0,multiple:!0,total:0,dataList:[],queryParams:{pageNum:1,pageSize:10,type:null,beginTime:null,endTime:null},open:!1,title:"",form:{},rules:{timeList:[{required:!0,message:"时间不能为空",trigger:"blur"}],type:[{required:!0,message:"调查方式不能为空",trigger:"blur"}]},typeOptions:{0:"其他",1:"人工",2:"视频识别",3:"互联网路况估算"},linkTypeOption:[]}},methods:{handleCloseEditInfo(){this.infoEdit=!1,this.updateEcharts()},handleReverse(){Z(this.linkId).then((t=>{console.log(t),t.data?this.$emit("changeLink",t.data):this.$message.warning("切换失败，没有找到反向道路")}))},initEcharts(){this.$nextTick((()=>{this._echart=Ct.S1(this.$refs.echart),this.updateEcharts()}))},updateEcharts(){$({ids:this.ids,linkId:this.linkId,type:this.queryParams.type?this.queryParams.type.join(","):null}).then((t=>{this._echart.resize(),this._echart.setOption(this.getEchartsOption(t.data))}))},getEchartsOption(t){let e=new Array(24).fill().map(((e,i)=>t.find((t=>t.hour==i))||{hour:i,pcu_h:0,scar:0,struck:0,mcar:0,mtruck:0,lcar:0,ltruck:0}));return console.log(e),{tooltip:{trigger:"axis"},legend:{data:["pcu/h","小型客车","小型货车","中型客车","中型货车","大型客车","大型货车"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{feature:{saveAsImage:{}}},xAxis:{type:"category",boundaryGap:!1,data:e.map((t=>t.hour.toString()))},yAxis:[{type:"value",position:"left",alignTicks:!0},{type:"value",position:"right",alignTicks:!0}],series:[{name:"pcu/h",type:"bar",yAxisIndex:1,data:e.map((t=>t.pcu_h))},{name:"小型客车",type:"line",smooth:!0,data:e.map((t=>t.scar))},{name:"小型货车",type:"line",smooth:!0,data:e.map((t=>t.struck))},{name:"中型客车",type:"line",smooth:!0,data:e.map((t=>t.mcar))},{name:"中型货车",type:"line",smooth:!0,data:e.map((t=>t.mtruck))},{name:"大型客车",type:"line",smooth:!0,data:e.map((t=>t.lcar))},{name:"大型货车",type:"line",smooth:!0,data:e.map((t=>t.ltruck))}]}},close(){this.$emit("update:visible",!1),this.$emit("close")},getAllLinkType(){q().then((t=>{let e={};for(const{code:i,name:a}of t.data)e[i]=a;this.linkTypeOption=e}))},handleEditInfo(){this.infoForm={id:this.info.id,origid:this.info.origid,name:this.info.name,lane:this.info.lane,type:this.info.type,freespeed:this.info.freespeed},this.infoEdit=!0,this.updateEcharts()},handleUpdateLink(){this.$refs["infoForm"].validate((t=>{if(t){let t=JSON.parse(JSON.stringify(this.infoForm));K(t).then((t=>{this.$message.success("修改成功"),this.infoEdit=!1,this.getDetail()}))}}))},handleUpdateInWay(){this.$refs["infoForm"].validate((t=>{if(t){let t=JSON.parse(JSON.stringify(this.infoForm));Q(t).then((t=>{this.$message.success("修改成功"),this.infoEdit=!1,this.getDetail()}))}}))},getDetail(){X(this.linkId).then((t=>{t.data.freespeed=Number(t.data.freespeed).toFixed(2),this.info=t.data}))},handleQuery(){this.queryParams.pageNum=1,this.getList(),this.updateEcharts()},resetQuery(){this.handleQuery()},getList(){if(!this.linkId)return;this.loading=!0;const t={pageNum:this.queryParams.pageNum,pageSize:this.queryParams.pageSize,beginTime:this.queryParams.beginTime,endTime:this.queryParams.endTime,type:this.queryParams.type?this.queryParams.type.join(","):null};V(this.linkId,t).then((t=>{this.dataList=t.data.data,this.total=t.data.total,this.loading=!1}))},handleSelectionChange(t){this.ids=t.map((t=>t.id)),this.single=1!=t.length,this.multiple=!t.length,this.updateEcharts()},handleAdd(){this.reset(),this.open=!0,this.title="添加道路信息"},cancel(){this.open=!1,this.reset()},reset(){this.form={linkId:this.linkId,timeList:[],beginTime:null,endTime:null,type:"0",pcuH:0,remark:null,isTwoWay:!1,video:"",scar:"",struck:"",mcar:"",mtruck:"",lcar:"",ltruck:""}},handleUpdate(t){this.reset();const e=t.id;B(e).then((t=>{t.data.timeList=[t.data.beginTime,t.data.endTime],this.form=t.data,this.open=!0,this.title="修改道路信息"}))},submitForm:function(){this.$refs["form"].validate((t=>{if(t){let t=JSON.parse(JSON.stringify(this.form));t.beginTime=t.timeList[0],t.endTime=t.timeList[1],void 0!=t.id?U(t).then((t=>{this.$message.success("修改成功"),this.open=!1,this.getList(),this.$emit("updateData")})):G(t).then((t=>{this.$message.success("新增成功"),this.open=!1,this.getList(),this.$emit("updateData")}))}}))},handleDelete(t){const e=t.id;this.$confirm('是否确认编号为"'+e+'"的数据项?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return H(e)})).then((()=>{this.getList(),this.$message.success("删除成功"),this.$emit("updateData")})).catch((()=>{}))}}},St=At,xt=i(1001),kt=(0,xt.Z)(St,P,I,!1,null,"39286bd8",null),Lt=kt.exports,Et=function(){var t=this,e=t._self._c;return e("Dialog",{attrs:{top:50,left:100,width:"calc(100vw - 200px)",hideMinimize:"",visible:t.visible},on:{close:t.handleClose}},[e("div",{staticClass:"FrameLinkDialog"},[e("el-form",{ref:"queryForm",attrs:{model:t.queryParams,inline:!0,"label-width":"68px",size:"small"}},[e("el-form-item",{attrs:{label:"时间",prop:"timeList"}},[e("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1),e("el-form-item",{attrs:{label:"调查方式",prop:"type"}},[e("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:t.queryParams.type,callback:function(e){t.$set(t.queryParams,"type",e)},expression:"queryParams.type"}},t._l(t.typeOptions,(function(t,i){return e("el-option",{key:String(i),attrs:{label:t,value:String(i)}})})),1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleQuery}},[t._v("搜索")]),e("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:t.resetQuery}},[t._v("重置")])],1)],1),e("el-row",{staticClass:"mb8",attrs:{gutter:10}},[e("el-col",{attrs:{span:1.5}},[e("el-button",{attrs:{type:"warning",plain:"",icon:"el-icon-download",loading:t.exportLoading,disabled:t.multiple,size:"small"},on:{click:t.handleExport}},[t._v("导出")])],1),e("el-col",{attrs:{span:1.5}},[e("el-button",{attrs:{type:"warning",plain:"",icon:"el-icon-download",loading:t.exportAllLoading,size:"small"},on:{click:t.handleExportAll}},[t._v("导出全部")])],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"small",attrs:{data:t.dataList,height:"calc(100vh - 300px)"},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e("el-table-column",{attrs:{label:"记录编号",align:"center",prop:"id"}}),e("el-table-column",{attrs:{label:"路段编号",align:"center",prop:"linkId"}}),e("el-table-column",{attrs:{label:"开始时间",align:"center",prop:"beginTime"}}),e("el-table-column",{attrs:{label:"结束时间",align:"center",prop:"endTime"}}),e("el-table-column",{attrs:{label:"调查方式",align:"center",prop:"type"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return e("span",{},[t._v(t._s(t.typeOptions[i.type]))])}}])}),e("el-table-column",{attrs:{label:"pcu/h",align:"center",prop:"pcuH"}}),e("el-table-column",{attrs:{label:"备注",align:"center",prop:"remark","show-overflow-tooltip":!0}})],1),e("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total > 0"}],staticStyle:{"line-height":"1","padding-top":"20px"},attrs:{total:t.total,page:t.queryParams.pageNum,limit:t.queryParams.pageSize},on:{"update:page":function(e){return t.$set(t.queryParams,"pageNum",e)},"update:limit":function(e){return t.$set(t.queryParams,"pageSize",e)},pagination:t.getList}})],1)])},Mt=[],Tt=(i(8858),i(1318),i(3228),{props:{visible:{type:Boolean},xyarr:{type:Array,default:()=>[]},timeList:{type:Array,default:()=>[]},type:{type:[Number,String],default:""}},watch:{visible:{handler(t){t&&(this.dateRange=this.timeList||[],this.queryParams.type=this.type,this.handleQuery())},immediate:!0,deep:!0}},data(){return{loading:!0,exportLoading:!1,exportAllLoading:!1,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,dataList:[],title:"",open:!1,statusOptions:[],dateRange:[],queryParams:{pageNum:1,pageSize:10,type:null,beginTime:null,endTime:null},form:{},rules:{dictName:[{required:!0,message:"字典名称不能为空",trigger:"blur"}],dictType:[{required:!0,message:"字典类型不能为空",trigger:"blur"}]},typeOptions:{0:"其他",1:"人工",2:"视频识别",3:"互联网路况估算"}}},created(){},methods:{handleClose(){this.$emit("update:visible",!1),this.$emit("close")},getList(){if(!this.xyarr)return;this.loading=!0;let t=JSON.parse(JSON.stringify(this.queryParams));t.xyarr=this.xyarr,this.dateRange&&this.dateRange[0]&&this.dateRange[1]&&(t.beginTime=this.dateRange[0],t.endTime=this.dateRange[1]),z(t).then((t=>{this.dataList=t.data.data,this.total=t.data.total,this.loading=!1}))},handleQuery(){this.dataList=[],this.total=0,this.queryParams.pageNum=1,this.getList()},resetQuery(){this.dateRange=[],this.queryParams={pageNum:1,pageSize:10,type:null,beginTime:null,endTime:null},this.dataList=[],this.total=0,this.getList()},handleSelectionChange(t){this.ids=t.map((t=>t.id)),this.single=1!=t.length,this.multiple=!t.length},handleDelete(t){const e=t.id||this.ids;this.$confirm('是否确认删除字典编号为"'+e+'"的数据项?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return delType(e)})).then((()=>{this.getList(),this.msgSuccess("删除成功")})).catch((()=>{}))},handleExport(){const t=this.ids;this.$confirm("是否确认导出数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>(this.exportLoading=!0,Y({ids:t})))).then((t=>{const e=window.URL.createObjectURL(t.data),i=`${(new Date).getTime()}.xls`,a=document.createElement("a");a.href=e,a.download=i,a.click(),window.URL.revokeObjectURL(e),this.exportLoading=!1})).catch((t=>{this.exportLoading=!1}))},handleExportAll(){this.$confirm("是否确认导出所有数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>(this.exportAllLoading=!0,Y({xyarr:this.xyarr})))).then((t=>{const e=window.URL.createObjectURL(t.data),i=`${(new Date).getTime()}.xls`,a=document.createElement("a");a.href=e,a.download=i,a.click(),window.URL.revokeObjectURL(e),this.exportAllLoading=!1})).catch((t=>{this.exportAllLoading=!1}))}}}),Ft=Tt,Dt=(0,xt.Z)(Ft,Et,Mt,!1,null,"5dd923cc",null),Pt=Dt.exports,It=function(){var t=this,e=t._self._c;return e("el-select",{attrs:{value:t.s_value,filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入关键词","remote-method":t.remoteMethod,loading:t.loading,size:t.size},on:{input:t.handleInput}},t._l(t.options,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)},Nt=[],Rt={props:["value","label","size"],watch:{value:{handler(t){t!==this.s_value&&(this.s_value=t)}}},data(){return{options:[],s_value:null,loading:!1}},mounted(){},methods:{handleInput(t){let e=this.options.find((e=>e.id==t));this.s_value=e.id,this.$emit("input",e.id),this.$emit("update:label",e.name),this.$emit("change",{value:e.id,item:e})},remoteMethod(t){""!==t?(this.loading=!0,j({name:t}).then((t=>{this.loading=!1,this.options=t.data}))):this.options=[]}}},Ot=Rt,Bt=(0,xt.Z)(Ot,It,Nt,!1,null,null,null),Gt=Bt.exports,Ut=function(){var t=this,e=t._self._c;return e("el-select",{attrs:{value:t.s_value,filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入关键词","remote-method":t.remoteMethod,loading:t.loading,size:t.size},on:{input:t.handleInput}},t._l(t.options,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)},zt=[],Wt={props:["value","label","size"],watch:{value:{handler(t){t!==this.s_value&&(this.s_value=t)}}},data(){return{options:[],s_value:null,loading:!1}},mounted(){},methods:{handleInput(t){let e=this.options.find((e=>e.id==t));this.s_value=e.id,this.$emit("input",e.id),this.$emit("update:label",e.name),this.$emit("change",{value:e.id,item:e})},remoteMethod(t){""!==t?(this.loading=!0,J({id:t}).then((t=>{this.loading=!1,this.options=t.data}))):this.options=[]}}},Vt=Wt,Ht=(0,xt.Z)(Vt,Ut,zt,!1,null,null,null),Yt=Ht.exports,Xt=function(){var t=this,e=t._self._c;return e("el-input",{staticStyle:{width:"100%"},attrs:{size:"small",placeholder:"经纬度"},on:{change:t.handleInput},model:{value:t.center,callback:function(e){t.center=e},expression:"center"}},[e("el-select",{staticStyle:{width:"90px"},attrs:{slot:"prepend",placeholder:"请选择"},on:{change:t.handleChangeCenter},slot:"prepend",model:{value:t.centerType,callback:function(e){t.centerType=e},expression:"centerType"}},[e("el-option",{attrs:{label:"经纬度",value:1}}),e("el-option",{attrs:{label:"墨卡托",value:2}})],1)],1)},Kt=[],Qt={props:{value:{type:Array,default:()=>[]}},data(){return{center:"",centerType:1}},computed:{s_value(){let t=this.center.split(",").map((t=>Number(t)));return 1==this.centerType?(0,n.ob)(...t):2==this.centerType?t:void 0}},watch:{value:{handler(){this.handleChangeCenter()},immediate:!0,deep:!0}},methods:{handleInput(){this.$emit("input",this.s_value),this.$emit("change",this.s_value)},handleChangeCenter(){let t=this.value;1==this.centerType?(t=(0,n.Nq)(...this.value),t=t.map((t=>Math.ceil(1e5*t)/1e5))):2==this.centerType&&(t=t.map((t=>Math.ceil(100*t)/100))),this.center=t.join(",")}}},qt=Qt,Zt=(0,xt.Z)(qt,Xt,Kt,!1,null,null,null),jt=Zt.exports,Jt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"HelpDialog"},[e("div",{staticClass:"_flex"},[e("div",{staticClass:"el-icon-question",on:{click:function(e){t.open=!0}}}),e("a",{staticClass:"bug",attrs:{href:"https://doc.weixin.qq.com/sheet/e3_AdQA8Aa_ADMt1qh97LkSHer6ALqI2?scode=APwA6gfEAA0aeGdABPAdQA8Aa_ADM&tab=BB08J2",target:"_blank"}},[t._v("BUG")]),e("a",{staticClass:"count",attrs:{href:"./keyPressed.html",target:"_blank"}},[t._v("C")]),e("a",{staticClass:"count",attrs:{href:"/#/demo/page1",target:"_blank"}},[t._v("demo")])]),e("el-dialog",{attrs:{visible:t.open,width:"500px","append-to-body":"",center:"","close-on-click-modal":!1},on:{"update:visible":function(e){t.open=e},close:t.handleClose}},[e("div",{staticClass:"body"},t._l(t.pageNum,(function(i){return e(`page${i}`,{directives:[{name:"show",rawName:"v-show",value:t.carouselIndex==i,expression:"carouselIndex == item"}],key:i,tag:"component"})})),1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"mini"},on:{click:t.handleClose}},[t._v("关闭")]),1!=t.carouselIndex?e("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(e){t.carouselIndex--}}},[t._v("上一步")]):t._e(),t.carouselIndex<t.pageNum?e("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){t.carouselIndex++}}},[t._v("下一步")]):t._e()],1)])],1)},$t=[],te=function(){var t=this;t._self._c;return t._m(0)},ee=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"page1"},[e("h2",[t._v("1.按住鼠标右键移动地图")]),e("img",{staticClass:"video",attrs:{src:i(2630)}})])}],ie={},ae=ie,re=(0,xt.Z)(ae,te,ee,!1,null,"89829d00",null),se=re.exports,ne=function(){var t=this;t._self._c;return t._m(0)},oe=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"page2"},[e("h2",[t._v("2. 滑动滚轮缩放/扩大地图")]),e("img",{staticClass:"video",attrs:{src:i(5311)}})])}],le={},he=le,de=(0,xt.Z)(he,ne,oe,!1,null,"6500d309",null),ce=de.exports,ue=function(){var t=this;t._self._c;return t._m(0)},pe=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"page3"},[e("h2",[t._v("3. 点击框选按钮，按住鼠标左键选择范围并导出至本地")]),e("img",{staticClass:"video",attrs:{src:i(3140)}}),e("h4",[e("img",{staticClass:"icon",attrs:{src:i(5061),alt:""}}),t._v("通过人工计数记录的流量 ")]),e("h4",[e("img",{staticClass:"icon",attrs:{src:i(9595),alt:""}}),t._v("通过视频识别转换的流量 ")]),e("h4",[e("img",{staticClass:"icon",attrs:{src:i(7674),alt:""}}),t._v("通过其他方式获取的流量 ")])])}],ge={},me=(0,xt.Z)(ge,ue,pe,!1,null,"3619bb93",null),fe=me.exports,ve=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page4"},[e("h2",[t._v("4. 缩放至"+t._s(t.SHOW_LINK_ZOOM)+"级地图显示可录入路段")]),e("img",{staticClass:"video",attrs:{src:i(2165)}})])},ye=[],be={data(){return{SHOW_LINK_ZOOM:zi}}},_e=be,we=(0,xt.Z)(_e,ve,ye,!1,null,"4fb215b4",null),Ce=we.exports,Ae=function(){var t=this;t._self._c;return t._m(0)},Se=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"page5"},[e("h2",[t._v("5. 点击路段，调整路段宽度，单双向道路偏移后选取详细路段输入流量")]),e("img",{staticClass:"video",attrs:{src:i(7274)}})])}],xe={},ke=xe,Le=(0,xt.Z)(ke,Ae,Se,!1,null,"9d688ca8",null),Ee=Le.exports,Me={components:{page1:se,page2:ce,page3:fe,page4:Ce,page5:Ee},data(){return{open:!localStorage.getItem("HelpDialogClose"),carouselIndex:1,pageNum:5}},watch:{open(t){t&&(this.carouselIndex=1)}},methods:{handleClose(){this.open=!1,localStorage.setItem("HelpDialogClose",!0)},handleNext(){this.$refs.carousel.next()},handlePrev(){this.$refs.carousel.prev()}}},Te=Me,Fe=(0,xt.Z)(Te,Jt,$t,!1,null,"33b75f7b",null),De=Fe.exports,Pe=function(){var t=this,e=t._self._c;return e("Dialog",{staticClass:"VideoInputCrossroads",attrs:{title:"视频录入交叉口",top:50,left:100,width:"600px",hideMinimize:"",visible:t.visible},on:{close:t.handleClose}},[e("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"100px",size:"small"}},[e("el-form-item",{attrs:{label:"调查时间",prop:"date"}},[e("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1),e("el-form-item",{attrs:{label:"调查视频",prop:"video"}},[e("UploadVideo",{model:{value:t.form.video,callback:function(e){t.$set(t.form,"video",e)},expression:"form.video"}})],1),e("el-form-item",{attrs:{label:"视频角度",prop:"videoType"}},[e("el-radio-group",{model:{value:t.form.videoType,callback:function(e){t.$set(t.form,"videoType",e)},expression:"form.videoType"}},t._l(t.videoType,(function(i){return e("el-radio",{key:i.value,attrs:{label:i.value,disabled:i.disabled}},[t._v(" "+t._s(i.label))])})),1)],1),e("el-form-item",{attrs:{label:"附件",prop:"annex"}},[e("el-upload",{staticClass:"upload-demo",attrs:{action:"/file/upload",multiple:"","file-list":t.form.annex,"on-success":t.handleUploadAnnex}},[e("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1)],1),e("el-form-item",{attrs:{label:"备注",prop:"remark"}},[e("el-input",{attrs:{type:"textarea",autosize:{minRows:2}},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1),e("el-form-item",[e("el-button",{on:{click:t.handleClose}},[t._v("取消")]),e("el-button",{attrs:{loading:t.saving,type:"primary"},on:{click:t.handleSubmit}},[t._v("下一步")])],1)],1)],1)},Ie=[],Ne={name:"VideoInputCrossroads",inject:["rootVue"],props:{visible:{type:Boolean},params:{type:Object}},components:{},computed:{},watch:{visible:{handler(t){t?this.handleEnable():this.handleDisable()},immediate:!0,deep:!0}},data(){return{upload:{loading:!1,progress:0,file:null},saving:!1,form:{date:[],video:"",remark:"",videoType:1,annex:[]},rules:{date:[{required:!0,message:"调查时间不能为空",trigger:"blur"}],video:[{required:!0,message:"调查视频不能为空",trigger:"blur"}]},videoType:[{label:"俯视航拍",value:1},{label:"侧面路拍",value:2,disabled:!0},{label:"正斜角拍摄",value:3,disabled:!0}]}},created(){},mounted(){},beforeDestroy(){this.handleDisable()},methods:{handleChangeSelectState(t){this._PointSelectLayer&&(this.rootVue._PointSelectLayer.state=t)},handleEnable(){gt(this.params.intersectionId).then((t=>{this.intersectionDetail=t.data,this.form={date:[],video:"",remark:"",videoType:1,annex:[]}}))},handleDisable(){},handleClose(){this.$emit("update:visible",!1),this.$emit("close")},handleUploadAnnex(t,e,i){this.form.annex=i},handleSubmit(){this.$refs["form"].validate((t=>{if(t){const t={intersectionId:this.intersectionDetail.id,beginTime:this.form.date[0],endTime:this.form.date[1],type:"2",video:this.form.video,videoType:this.form.videoType,annex:this.form.annex.map((t=>({name:t.name,url:t.response.data}))),mapInfo:JSON.stringify({center:[this.intersectionDetail.x,this.intersectionDetail.y],zoom:19,rotation:0}),remark:this.form.remark};this.saving=!0,tt(t).then((t=>{this.$emit("submited",t.data),this.saving=!1})).catch((t=>{this.saving=!1}))}}))}}},Re=Ne,Oe=(0,xt.Z)(Re,Pe,Ie,!1,null,"40dce00c",null),Be=Oe.exports,Ge=function(){var t=this,e=t._self._c;return e("Dialog",{staticClass:"ManuallyEnteringCrossroads",attrs:{title:"人工录入交叉口",top:50,left:100,width:"600px",hideMinimize:"",visible:t.visible},on:{close:t.handleClose}},[e("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"100px",size:"small"}},[e("el-form-item",{attrs:{label:"调查时间",prop:"date"}},[e("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1),e("el-form-item",{attrs:{label:"附件",prop:"annex"}},[e("el-upload",{staticClass:"upload-demo",attrs:{action:"/file/upload",multiple:"","file-list":t.form.annex,"on-success":t.handleUploadAnnex}},[e("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1)],1),e("el-form-item",{attrs:{label:"备注",prop:"remark"}},[e("el-input",{attrs:{type:"textarea",autosize:{minRows:2}},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1),e("el-form-item",[e("el-button",{on:{click:t.handleClose}},[t._v("取消")]),e("el-button",{attrs:{loading:t.saving,type:"primary"},on:{click:t.handleSubmit}},[t._v("下一步")])],1)],1)],1)},Ue=[],ze={name:"ManuallyEnteringCrossroads",inject:["rootVue"],props:{visible:{type:Boolean},params:{type:Object}},components:{},computed:{},watch:{visible:{handler(t){t?this.handleEnable():this.handleDisable()},immediate:!0,deep:!0}},data(){return{upload:{loading:!1,progress:0,file:null},saving:!1,form:{date:[],video:"",center:[0,0],remark:"",videoType:1,annex:[]},rules:{date:[{required:!0,message:"调查时间不能为空",trigger:"blur"}],video:[{required:!0,message:"调查视频不能为空",trigger:"blur"}]}}},created(){},mounted(){},methods:{handleEnable(){gt(this.params.intersectionId).then((t=>{this.intersectionDetail=t.data,this.form={date:[],video:"",center:[0,0],remark:"",videoType:1,annex:[]}}))},handleDisable(){},handleClose(){this.$emit("update:visible",!1),this.$emit("close")},handleUploadAnnex(t,e,i){this.form.annex=i},handleSubmit(){this.$refs["form"].validate((t=>{if(t){const t={intersectionId:this.intersectionDetail.id,beginTime:this.form.date[0],endTime:this.form.date[1],type:"1",video:"",videoType:"",annex:this.form.annex.map((t=>({name:t.name,url:t.response.data}))),mapInfo:JSON.stringify({center:[this.intersectionDetail.x,this.intersectionDetail.y],zoom:19,rotation:0}),remark:this.form.remark};this.saving=!0,tt(t).then((t=>{this.$emit("submited",t.data),this.saving=!1})).catch((t=>{this.saving=!1}))}}))}}},We=ze,Ve=(0,xt.Z)(We,Ge,Ue,!1,null,"57489a18",null),He=Ve.exports,Ye=function(){var t=this,e=t._self._c;return e("Dialog",{staticClass:"FrameCrossroads_DrawLine",attrs:{title:"绘制检测线",top:40,left:100,width:"calc(100vw - 200px)",hideMinimize:"",visible:t.visible},on:{close:t.handleClose}},[e("div",{staticClass:"FrameCrossroads_DrawLine_body"},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:24,lg:16,xl:13}},[e("div",{staticClass:"draw_map_box"},[e("div",{staticClass:"img_size",style:{paddingBottom:t.drawHeight/t.drawWidth*100+"%"}}),e("div",{staticClass:"draw_map",attrs:{id:"draw_map"}})])]),e("el-col",{attrs:{span:24,lg:8,xl:11}},[e("div",{staticClass:"draw_toolbar"},[e("div",{staticClass:"row"},[t.isChangeMap?e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.handleEndChangeMap}},[t._v("结束调整")]):e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.handleStartChangeMap}},[t._v("调整位置")]),e("div",{staticClass:"open_btn el-icon-arrow-down",class:{hide:!t.showChangeMapSetting},on:{click:function(e){t.showChangeMapSetting=!t.showChangeMapSetting}}})],1),t.showChangeMapSetting?[e("div",{staticClass:"row"},[e("span",{staticClass:"label"},[t._v("显示地图:")]),e("el-switch",{attrs:{"active-value":!0,"inactive-value":!1},model:{value:t.showMapLayer,callback:function(e){t.showMapLayer=e},expression:"showMapLayer"}})],1),e("div",{staticClass:"row"},[e("span",{staticClass:"label"},[t._v("显示路网:")]),e("el-switch",{attrs:{"active-value":!0,"inactive-value":!1},model:{value:t.showNetworkLayer,callback:function(e){t.showNetworkLayer=e},expression:"showNetworkLayer"}})],1),e("div",{staticClass:"row"},[e("span",{staticClass:"label"},[t._v("地图透明度:")]),e("el-slider",{staticStyle:{width:"100%",padding:"0 2em 0 0"},attrs:{disabled:!t.showMapLayer,step:.01,min:0,max:1},model:{value:t.mapLayerOpacity,callback:function(e){t.mapLayerOpacity=e},expression:"mapLayerOpacity"}})],1),e("div",{staticClass:"row"},[e("span",{staticClass:"label"},[t._v("topLeft:")]),e("span",[t._v(t._s(t.mapFrom.topLeft))])]),e("div",{staticClass:"row"},[e("span",{staticClass:"label"},[t._v("topRight:")]),e("span",[t._v(t._s(t.mapFrom.topRight))])]),e("div",{staticClass:"row"},[e("span",{staticClass:"label"},[t._v("bottomLeft:")]),e("span",[t._v(t._s(t.mapFrom.bottomLeft))])]),e("div",{staticClass:"row"},[e("span",{staticClass:"label"},[t._v("bottomRight:")]),e("span",[t._v(t._s(t.mapFrom.bottomRight))])])]:t._e(),e("div",{staticClass:"row"},[e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.handleAddDrawLine}},[t._v("添加画线")]),e("div",{staticClass:"open_btn el-icon-arrow-down",class:{hide:!t.showChangeDrawLineSetting},on:{click:function(e){t.showChangeDrawLineSetting=!t.showChangeDrawLineSetting}}})],1),t.showChangeDrawLineSetting?[t.drawLineFrom?[e("div",{staticClass:"row"},[e("span",{staticClass:"label"},[t._v("线名：")]),e("el-input",{attrs:{placeholder:"",size:"mini",clearable:""},on:{change:function(t){}},model:{value:t.drawLineFrom.name,callback:function(e){t.$set(t.drawLineFrom,"name",e)},expression:"drawLineFrom.name"}})],1),e("div",{staticClass:"row"},[e("span",{staticClass:"label"},[t._v("开始点：")]),e("span",[t._v(" "+t._s(t.formatterPoint(t.drawLineFrom.begin)))])]),e("div",{staticClass:"row"},[e("span",{staticClass:"label"},[t._v("结束点：")]),e("span",[t._v(" "+t._s(t.formatterPoint(t.drawLineFrom.end)))])]),e("div",{staticClass:"row"},[e("span",{staticClass:"label"},[t._v("颜色：")]),e("el-color-picker",{attrs:{predefine:t.predefineColors,size:"mini"},model:{value:t.drawLineFrom.color,callback:function(e){t.$set(t.drawLineFrom,"color",e)},expression:"drawLineFrom.color"}})],1),e("div",{staticClass:"row"},[e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.handleConfirmDrawLine}},[t._v("确定")]),e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.handleCancelLine}},[t._v("取消")])],1)]:[e("div",{staticClass:"row"},[e("el-table",{staticClass:"small",attrs:{data:t.drawLineList,border:"",stripe:"",height:"300px"}},[e("el-table-column",{attrs:{prop:"color",label:"颜色",width:"50"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[e("el-color-picker",{attrs:{predefine:t.predefineColors,size:"mini"},model:{value:i.color,callback:function(e){t.$set(i,"color",e)},expression:"row.color"}})]}}],null,!1,1854218370)}),e("el-table-column",{attrs:{prop:"name",label:"线名"}}),e("el-table-column",{attrs:{prop:"begin",label:"开始点"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v(t._s(t.formatterPoint(e.begin)))]}}],null,!1,3747343221)}),e("el-table-column",{attrs:{prop:"end",label:"结束点"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v(t._s(t.formatterPoint(e.end)))]}}],null,!1,909673469)}),e("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function({row:i,$index:a}){return[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.handleEditDrawLine(i,a)}}},[t._v("编辑")]),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.handleRemoveDrawLine(i,a)}}},[t._v("删除")])]}}],null,!1,317898410)})],1)],1)]]:t._e()],2)])],1)],1),e("div",{staticClass:"FrameCrossroads_DrawLine_footer"},[e("el-button",{on:{click:t.handleClose}},[t._v("取消")]),e("el-button",{attrs:{type:"primary",loading:t.saving},on:{click:t.handleSubmit}},[t._v("保存绘制内容")])],1)])},Xe=[],Ke=i(7991);const Qe=new l.dpR,qe={DISABLE:0,CHANGE_BEGIN:1,CHANGE_END:2};class Ze extends s.mh{constructor(t){if(super(t),(0,o.Z)(this,"isAdd",!1),(0,o.Z)(this,"drawLineIndex",0),(0,o.Z)(this,"drawLineList",[]),(0,o.Z)(this,"lineColor",65280),(0,o.Z)(this,"lineHighlightColor",16711680),(0,o.Z)(this,"image",null),(0,o.Z)(this,"drawImage",null),this.url=t.url,this.width=t.width,this.height=t.height,this.url){const t=new l.vBJ({depthWrite:!1,side:l.ehD,map:Qe.load(this.url)}),e=new l.u9r;e.setAttribute("position",new l.a$l([0,0,0,0,-this.height,0,this.width,-this.height,0,this.width,0,0],3)),e.setAttribute("uv",new l.a$l([0,1,0,0,1,0,1,1],2)),e.setIndex(new l.qlB([0,1,2,0,2,3],1)),e.computeBoundingBox(),e.computeVertexNormals(),this.imageMesh=new l.Kj0(e,t),this.scene.add(this.imageMesh)}if(t.drawLineList){this.drawLineList=t.drawLineList.map((t=>new je(t.name,[t.beginx,t.beginy],[t.endx,t.endy],t.color))),console.log(this.drawLineList);for(const t of this.drawLineList)this.scene.add(t._mesh)}}onAdd(t){this.map&&this.removeFromParent(),this.map=t,this.setPickLayerColor(this.map.getPickLayerColor());const e=.05,i=this.map.camera.fov,a=this.height/2/Math.tan(i*Math.PI/360);this.map.camera.add(this.scene),this.scene.position.set(-this.width/2*e,this.height/2*e,-a*e),this.scene.scale.set(e,e,1)}on(t,e){const i=this.drawLineList[this.drawLineIndex];if(t==s.kT.HANDLE_CLICK_LEFT&&i){const[t,a]=e.windowSize,[r,s]=e.webMercatorXY,[n,o]=e.windowXY,l=n*this.width/t,h=o*this.height/a;i.state==qe.CHANGE_BEGIN?(i.state=qe.CHANGE_END,i.begin=[l,h],i.end=[l,h],i.updateGeometry()):i.state==qe.CHANGE_END&&(i.state=qe.CHANGE_BEGIN,i.end=[l,h],i.updateGeometry())}if(t==s.kT.HANDLE_MOUSE_MOVE&&i){const[t,a]=e.windowSize,[r,s]=e.webMercatorXY,[n,o]=e.windowXY,l=n*this.width/t,h=o*this.height/a;console.log(i.state),i.state==qe.CHANGE_END&&(i.end=[l,h],i.updateGeometry())}}addLine(){const t=new je;return t.state=qe.CHANGE_BEGIN,this.scene.add(t._mesh),this.drawLineIndex=this.drawLineList.length,this.drawLineList.push(t),this.isAdd=!0,t}editLine(t){const e=this.drawLineList[t];if(e)return this.drawLineIndex=t,this._editLineJson=e.toJSON(),this.isAdd=!1,e.state=qe.CHANGE_BEGIN,e}confirmLine(){const t=this.drawLineList[this.drawLineIndex];t&&(t.state=qe.DISABLE,this.drawLineIndex=-1)}cancelLine(){this.isAdd?(this.removeLine(this.drawLineIndex),this.drawLineIndex=-1):(this.drawLineList[this.drawLineIndex].setFromJSON(this._editLineJson),this.confirmLine())}removeLine(t){const e=this.drawLineList[t];return this.drawLineList.splice(t,1),e&&this.scene.remove(e._mesh),e}setHighlight(t){for(let e=0;e<this.drawLineList.length;e++)t==e?this.drawLineList[e].material.setValue({color:this.lineHighlightColor}):this.drawLineList[e].material.setValue({color:this.lineColor})}dispose(){super.dispose(),this.imageMesh&&(this.imageMesh.material.map.dispose(),this.imageMesh.geometry.dispose()),this.drawLineList.map((t=>{t.dispose()}))}}class je{set begin(t){this.state!=qe.DISABLE&&(this._begin=t.map((t=>parseInt(t))),this.updateGeometry())}get begin(){return this._begin}set end(t){this.state!=qe.DISABLE&&(this._end=t.map((t=>parseInt(t))),this.updateGeometry())}get end(){return this._end}set color(t){this._color=t,this._material.setValues({color:this.color}),this._material.needsUpdate=!0}get color(){return this._color}constructor(t="",e=[0,0],i=[0,0],a="#ff4500"){(0,o.Z)(this,"state",qe.CHANGE_BEGIN),(0,o.Z)(this,"_begin",[0,0]),(0,o.Z)(this,"_end",[0,0]),(0,o.Z)(this,"_color","#ff4500"),this._geometry=new l.u9r,this._material=new l.nls({depthFunc:l.Se2}),this._mesh=new l.x12(this._geometry,this._material),this._mesh.renderOrder=999,this.uuid=(0,Ke.M8)(),this.name=t||this.uuid.substring(0,8),this.color=a,this.begin=e,this.end=i,this.state=qe.DISABLE}updateGeometry(){this._geometry.setAttribute("position",new l.a$l([this.begin[0],-this.begin[1],.1,this.end[0],-this.end[1],.1],3)),this._geometry.computeBoundingSphere(),this._geometry.needsUpdate=!0}setFromJSON(t){this.uuid=t.uuid,this.name=t.name,this.begin=t.begin,this.end=t.end,this.color=t.color}dispose(){this._geometry.dispose()}toJSON(){return{uuid:this.uuid,name:this.name,begin:[...this.begin],end:[...this.end],color:this.color}}}var Je={name:"FrameCrossroads_DrawLine",inject:["rootVue"],props:{visible:{type:Boolean},params:{type:Object,default:()=>({})}},components:{},computed:{},watch:{visible:{handler(t){t?this.handleEnable():this.handleDisable()},immediate:!0,deep:!0},showMapLayer:{handler(t){this._Map&&(t?this._Map.addLayer(this._MapLayer):this._Map.removeLayer(this._MapLayer))}},showNetworkLayer:{handler(t){this._Map&&(t?this._Map.addLayer(this._NetworkLayer):this._Map.removeLayer(this._NetworkLayer))}},mapLayerOpacity:{handler(t){this._MapLayer&&this._MapLayer.setOpacity(t)}}},data(){return{loading:!1,saving:!1,inited:!1,predefineColors:["#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585"],drawUrl:"",drawWidth:1600,drawHeight:900,drawLineFrom:null,drawLineList:[],isChangeMap:!1,showMapLayer:!1,mapLayerOpacity:.5,mapFrom:{topLeft:[0,0],topRight:[0,0],bottomLeft:[0,0],bottomRight:[0,0]},showNetworkLayer:!1,showChangeMapSetting:!0,showChangeDrawLineSetting:!0}},created(){},mounted(){this.initMap(),this.handleLoadNetwork(),this.rootVue.$on("loadNetwork",this.handleLoadNetwork)},beforeDestroy(){this.handleDisable(),this._Map&&this._Map.dispose(),this.rootVue.$off("loadNetwork",this.handleLoadNetwork)},methods:{handleLoadNetwork(){this.rootVue._NetworkData&&this._NetworkLayer&&this._NetworkLayer.setData(this.rootVue._NetworkData)},async handleEnable(){if(!this.inited)return await new Promise((t=>setTimeout(t,500))),void(this.visible&&this.handleEnable());const t=this.params.id;if(t){ut(t).then((t=>{console.log(t)})),this.loading=!0;const e=await ut(t);this.detail=e.data.crossroads;const i=(0,Ke.HW)(e.data.crossroads.mapInfo,{center:[12614426,2646623],zoom:19,rotation:0});if(1==e.data.crossroads.type)this.drawUrl="",this.drawName="",this.drawWidth=1600,this.drawHeight=900,this.mapFrom={topLeft:[0,0],topRight:[0,0],bottomLeft:[0,0],bottomRight:[0,0],width:1600,height:900},this.drawLineFrom=null,this.showMapLayer=!0,this.showNetworkLayer=!0,this.mapLayerOpacity=1;else if(2==e.data.crossroads.type){const t=e.data.frame;this.drawUrl=t.url,this.drawName=t.name,this.drawWidth=t.width,this.drawHeight=t.height,this.mapFrom={topLeft:[0,0],topRight:[0,0],bottomLeft:[0,0],bottomRight:[0,0],width:t.width,height:t.height},this.drawLineFrom=null,this.showMapLayer=!1,this.showNetworkLayer=!1,this.mapLayerOpacity=.5}this._Map.setCenter(i.center),this._Map.setZoom(i.zoom),this._Map.setPitchAndRotation(void 0,i.rotation);const a=(0,Ke.HW)(e.data.crossroads.lines,[]);a.forEach((t=>{t.name=t.lineName||""})),this._DrawLineLayer=new Ze({zIndex:0,url:this.drawUrl,width:this.drawWidth,height:this.drawHeight,drawLineList:a}),this.drawLineList=this._DrawLineLayer.drawLineList,this._Map.addLayer(this._DrawLineLayer),this.loading=!1}},handleDisable(){this.drawUrl="",this.drawName="",this.drawWidth=1600,this.drawHeight=900,this.mapFrom={topLeft:[0,0],topRight:[0,0],bottomLeft:[0,0],bottomRight:[0,0],width:1600,height:900},this.drawLineFrom=null,this.showMapLayer=!0,this.showNetworkLayer=!0,this.mapLayerOpacity=1,this._DrawLineLayer&&(this._DrawLineLayer.dispose(),this._DrawLineLayer=null)},initMap(){this._Map=new s.s1({rootId:"draw_map",minPitch:90,enableRotate:!1,enableZoom:!1,enablePan:!1,event:{[s.kT.UPDATE_CENTER]:this.handleChangeMapFrom,[s.kT.UPDATE_CAMERA_HEIGHT]:this.handleChangeMapFrom,[s.kT.UPDATE_CAMERA_ROTATE]:this.handleChangeMapFrom}}),this._MapLayer=new s.t5({tileClass:s.LA[0],zIndex:20,opacity:this.mapLayerOpacity}),this.showMapLayer&&this._Map.addLayer(this._MapLayer),this._NetworkLayer=new y({zIndex:100,lineWidth:5,color:"#409EFF"}),this.showNetworkLayer&&this._Map.addLayer(this._NetworkLayer),this.inited=!0},handleChangeMapFrom(t){this._handleChangeMapFromTime||(this._handleChangeMapFromTime=setTimeout((()=>{if(this._Map){const t=this._Map.getWindowRangeAndWebMercator();this.mapFrom.topLeft=this.MercatorToWGS84(t.topLeft),this.mapFrom.topRight=this.MercatorToWGS84(t.topRight),this.mapFrom.bottomLeft=this.MercatorToWGS84(t.bottomLeft),this.mapFrom.bottomRight=this.MercatorToWGS84(t.bottomRight),this.mapFrom.width=t.width,this.mapFrom.height=t.height}this._handleChangeMapFromTime=null}),200))},MercatorToWGS84(t){const[e,i]=(0,n.Nq)(t[0]||0,t[1]||0);return[Number(Number(e).toFixed(8)),Number(Number(i).toFixed(8))]},handleStartChangeMap(){this.isChangeMap=!0,this._Map.enableRotate=!0,this._Map.enableZoom=!0,this._Map.enablePan=!0,this._showMapLayer=this.showMapLayer,this.showMapLayer=!0,this._showNetworkLayer=this.showNetworkLayer,this.showNetworkLayer=!0},handleEndChangeMap(){this.isChangeMap=!1,this._Map.enableRotate=!1,this._Map.enableZoom=!1,this._Map.enablePan=!1,this.showMapLayer=this._showMapLayer,this.showNetworkLayer=this._showNetworkLayer},handleAddDrawLine(){this.handleConfirmDrawLine(),this._DrawLineLayer&&(this.drawLineFrom=this._DrawLineLayer.addLine())},handleEditDrawLine(t,e){this.handleConfirmDrawLine(),this.drawLineFrom=this._DrawLineLayer.editLine(e)},handleConfirmDrawLine(){this.drawLineFrom=null,this._DrawLineLayer&&this._DrawLineLayer.confirmLine()},handleCancelLine(){this.drawLineFrom=null,this._DrawLineLayer&&this._DrawLineLayer.cancelLine()},handleRemoveDrawLine(t,e){this._DrawLineLayer&&this._DrawLineLayer.removeLine(e)},formatterPoint(t){try{return[Number(Number(t[0]).toFixed(6)),Number(Number(t[1]).toFixed(6))]}catch(e){return e.message}},handleClose(){this.$emit("update:visible",!1),this.$emit("close")},handleSubmit(){const t=this._Map.rootDoc.clientWidth/this.drawWidth,e={cossroadsId:this.params.id,mapInfo:JSON.stringify({center:this._Map.center,zoom:this._Map.zoom,rotation:this._Map.rotation,width:this.mapFrom.width,height:this.mapFrom.height}),vertex:[(0,n.ob)(...this.mapFrom.topLeft),(0,n.ob)(...this.mapFrom.topRight),(0,n.ob)(...this.mapFrom.bottomRight),(0,n.ob)(...this.mapFrom.bottomLeft),(0,n.ob)(...this.mapFrom.topLeft)],lines:this.drawLineList.map((e=>{const i=this._Map.WindowXYToWebMercator(e.begin[0]*t,e.begin[1]*t),a=this._Map.WindowXYToWebMercator(e.end[0]*t,e.end[1]*t),r={lineName:e.name,imageName:this.drawName,beginx:parseInt(e.begin[0]),beginy:parseInt(e.begin[1]),endx:parseInt(e.end[0]),endy:parseInt(e.end[1]),width:parseInt(this.drawWidth),height:parseInt(this.drawHeight),mktBeginx:i[0],mktBeginy:i[1],mktEndx:a[0],mktEndy:a[1]};return r}))};console.log(e),this.saving=!0,et(e).then((t=>{this.$emit("submited",t),this.saving=!1})).catch((t=>{this.saving=!1}))}}},$e=Je,ti=(0,xt.Z)($e,Ye,Xe,!1,null,null,null),ei=ti.exports,ii=function(){var t=this,e=t._self._c;return e("Dialog",{staticClass:"CrossroadsDetail",attrs:{title:{1:"人工录入交叉口",2:"视频录入交叉口"}[t.detail.type],top:20,left:"center",width:"80vw",hideMinimize:"",visible:t.visible},on:{close:t.handleClose}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"CrossroadsDetail_body"},[e("h3",{staticStyle:{"margin-top":"0"}},[t._v("交叉口流量表")]),e("el-form",{attrs:{"label-width":"auto",size:"small",inline:""}},[e("el-form-item",{attrs:{label:"调查时间",prop:"date"}},[e("el-date-picker",{attrs:{disabled:!t.changeCrossroadsData,type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.crossroadsData,callback:function(e){t.crossroadsData=e},expression:"crossroadsData"}})],1),e("el-form-item",[t.changeCrossroadsData?t._e():e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.changeCrossroadsData=!0}}},[t._v("修改调查时间")]),t.changeCrossroadsData?[e("el-button",{attrs:{loading:t.saving,type:"primary"},on:{click:t.handleSubmit}},[t._v("保存")]),e("el-button",{attrs:{loading:t.saving,type:"primary"},on:{click:t.handleQx}},[t._v("取消")])]:t._e()],2)],1),2==t.detail.type?e("div",{staticStyle:{"margin-bottom":"18px"}},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.handleDownload(t.detail.video)}}},[t._v("下载原视频")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.crossroadsExportCorssStatsTable}},[t._v("导出交叉口流量表")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.crossroadsAnalyzeVideo}},[t._v("导出识别视频")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.crossroadsTrackImage}},[t._v("导出轨迹图片")])],1):1==t.detail.type?e("div",{staticStyle:{"margin-bottom":"18px"}},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.crossroadsExportCorssStatsTable}},[t._v("导出交叉口流量表")])],1):t._e(),e("el-table",{staticClass:"small",attrs:{data:t.tableList1,border:"",stripe:"","max-height":"300px"}},[e("el-table-column",{attrs:{label:"编号",prop:"id"}}),e("el-table-column",{attrs:{label:"线名",prop:"name"}}),e("el-table-column",{attrs:{label:"初始线",prop:"inLink"}}),e("el-table-column",{attrs:{label:"终点线",prop:"outLink"}}),e("el-table-column",{attrs:{label:"PCU/H",prop:"pcuH"}}),e("el-table-column",{attrs:{label:"小型客车",prop:"car"}}),e("el-table-column",{attrs:{label:"小型货车",prop:"van"}}),e("el-table-column",{attrs:{label:"大型客车",prop:"bus"}}),e("el-table-column",{attrs:{label:"大型货车",prop:"truck"}}),e("el-table-column",{attrs:{label:"合计",prop:"count"}}),e("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.handleEdit(i)}}},[t._v("修改")]),e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.handleDelete(i)}}},[t._v("删除")])]}}])})],1),t._v(" "),e("h3",[t._v("附件")]),e("div",{staticStyle:{"margin-bottom":"18px"}},[e("el-button",{attrs:{type:"primary",size:"mini",loading:t.updoading||t.saving},on:{click:t.addAnnex}},[t._v("上传附件")])],1),e("el-table",{staticClass:"small",staticStyle:{"margin-bottom":"18px"},attrs:{data:t.detail.annex,border:"",stripe:"","max-height":"300px"}},[e("el-table-column",{attrs:{label:"附件名称",prop:"name"}}),e("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function({row:i,$index:a}){return[e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.handleDownload(i.url)}}},[t._v("下载")]),e("el-button",{attrs:{type:"text",size:"mini",loading:t.saving},on:{click:function(e){return t.deleteAnnex(a)}}},[t._v("删除")])]}}])})],1),e("h3",[t._v("交叉口流向图")]),e("div",{staticStyle:{"margin-bottom":"18px"}},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.handleChartToDataUrl}},[t._v("导出")])],1),e("div",{staticClass:"canvas",style:{height:t.drawHeight},attrs:{id:"CrossroadsDetail_canvas"}})],1),e("el-dialog",{attrs:{title:"修改交叉口流量",visible:t.open,width:"500px","append-to-body":""},on:{"update:visible":function(e){t.open=e}}},[e("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"100px",size:"mini"}},[e("el-form-item",{attrs:{label:"线名",prop:"name"}},[e("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t.form.id?t._e():e("el-form-item",{attrs:{label:"初始线",prop:"inLink"}},[e("el-select",{model:{value:t.form.inLink,callback:function(e){t.$set(t.form,"inLink",e)},expression:"form.inLink"}},t._l(t.inLinkList,(function(t,i){return e("el-option",{key:i,attrs:{label:t,value:t}})})),1)],1),t.form.id?t._e():e("el-form-item",{attrs:{label:"终点线",prop:"outLink"}},[e("el-select",{model:{value:t.form.outLink,callback:function(e){t.$set(t.form,"outLink",e)},expression:"form.outLink"}},t._l(t.outLinkList,(function(t,i){return e("el-option",{key:i,attrs:{label:t,value:t}})})),1)],1),e("el-form-item",{attrs:{label:"PCU/H",prop:"pcuH"}},[e("el-input-number",{attrs:{step:.01},model:{value:t.form.pcuH,callback:function(e){t.$set(t.form,"pcuH",e)},expression:"form.pcuH"}})],1),e("el-form-item",{attrs:{label:"小型客车",prop:"car"}},[e("el-input-number",{attrs:{step:.01},model:{value:t.form.car,callback:function(e){t.$set(t.form,"car",e)},expression:"form.car"}})],1),e("el-form-item",{attrs:{label:"小型货车",prop:"van"}},[e("el-input-number",{attrs:{step:.01},model:{value:t.form.van,callback:function(e){t.$set(t.form,"van",e)},expression:"form.van"}})],1),e("el-form-item",{attrs:{label:"大型客车",prop:"bus"}},[e("el-input-number",{attrs:{step:.01},model:{value:t.form.bus,callback:function(e){t.$set(t.form,"bus",e)},expression:"form.bus"}})],1),e("el-form-item",{attrs:{label:"大型货车",prop:"truck"}},[e("el-input-number",{attrs:{step:.01},model:{value:t.form.truck,callback:function(e){t.$set(t.form,"truck",e)},expression:"form.truck"}})],1),e("el-form-item",{attrs:{label:"合计",prop:"count"}},[t._v(" "+t._s(t.form.car+t.form.van+t.form.bus+t.form.truck)+" ")])],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.handleSave}},[t._v("确 定")]),e("el-button",{on:{click:function(e){t.open=!1}}},[t._v("取 消")])],1)],1)],1)},ai=[],ri=i(7975),si=i.n(ri);const ni=["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"];var oi={name:"CrossroadsDetail",props:{visible:{type:Boolean},params:{type:Object}},components:{},computed:{},watch:{visible:{handler(t){t&&Promise.all([this.getCrossroadsDetail(),this.getCrossroadsCorssStatsTable()]).then((t=>{this.handleDraw()}))},immediate:!0,deep:!0}},data(){return{loading:!1,tableList1:[],inLinkList:[],outLinkList:[],form:{},changeCrossroadsData:!1,crossroadsData:[],saving:!1,rules:{center:[{required:!0,message:"交叉口位置不能为空",trigger:"blur"}]},open:!1,drawWidth:1200,drawHeight:675,detail:{annex:[]},updoading:!1}},created(){},mounted(){this._stage=new(si().Stage)({container:"CrossroadsDetail_canvas",draggable:!0}),this._layer=new(si().Layer)({width:2048,height:2048}),this._stage.add(this._layer),this._group=new(si().Group)({}),this._layer.add(this._group),this._stage.on("wheel",(t=>{const e=this._group.scale().x+(t.evt.wheelDelta>0?.2:-.2);this._group.scale({x:e,y:e}),t.evt.preventDefault()})),this._resizeObserver=new ResizeObserver((t=>{this._setSizeTimeout||(this._setSizeTimeout=setTimeout((()=>{this.handleChartResize(),this._setSizeTimeout=null}),1e3/120))})),this._resizeObserver.observe(document.getElementById("CrossroadsDetail_canvas"))},beforeDestroy(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null),this._stage&&this._stage.destroy()},methods:{handleDownload(t){const e=document.createElement("a");e.download=t.split("/").pop(),e.href="/file/download?url="+t,document.body.appendChild(e),e.click(),document.body.removeChild(e)},handleChartResize(){if(this.detail.mapInfo){const{width:t,height:e,rotation:i}=this.detail.mapInfo;if(this.drawWidth=document.getElementById("CrossroadsDetail_canvas").clientWidth,this.drawHeight=this.drawWidth*e/t,this._stage.width(this.drawWidth),this._stage.height(this.drawHeight),this._group){this._group.x(this.drawWidth/2),this._group.y(this.drawHeight/2),this._group.rotation(i);const e=this.drawWidth/t*.75;this._group.scale({x:e,y:e})}}},getChart(t,e){const i=new(si().Group)({}),a=(new l.FM8).fromArray(t),r=3,s=3,n={},o={},h={},d={},c={},u={},p={};let g=Number.MIN_SAFE_INTEGER,m=Number.MAX_SAFE_INTEGER,f=0;for(const v in e){const t=e[v],i={id:t.id,value:Number(t.pcuH),name:t.name,inLink:t.inLink,outLink:t.outLink,sort:0},r=(new l.FM8).fromArray((0,Ke.HW)(t.startPoint,[0,0])).sub(a).multiply(new l.FM8(1,-1)),s=(new l.FM8).fromArray(t.inLinkInfo.toxy).sub(a).multiply(new l.FM8(1,-1)),h=(new l.FM8).fromArray(t.outLinkInfo.fromxy).sub(a).multiply(new l.FM8(1,-1)),d=(new l.FM8).fromArray((0,Ke.HW)(t.endPoint,[0,0])).sub(a).multiply(new l.FM8(1,-1));i.startPoint=r,i.startPointControl=s,i.endPointControl=h,i.endPoint=d,i.value>g&&(g=i.value),i.value<m&&(m=i.value);const c=i.startPointControl.clone().sub(i.startPoint).negate(),u=i.endPoint.clone().sub(i.startPoint),p=i.endPointControl.clone().sub(i.endPoint),y=c.angle(),b=u.angle(),_=p.angle();i.sort=b>y?b-y:2*Math.PI+(b-y),i.inNormal=new l.FM8(c.y,-c.x),i.outNormal=new l.FM8(p.y,-p.x);let w=n[i.inLink];w||(w={id:i.inLink,name:t.inLine,color:ni[f],list:[],count:0,max:Number.MIN_SAFE_INTEGER,point:i.startPoint.clone(),dir:c.clone(),normal:i.inNormal.clone(),angle:y},n[i.inLink]=w,f+=1),i.value>w.max&&(w.max=i.value),w.count+=i.value,w.list.push(i);let C=o[i.outLink];C||(C={id:i.outLink,name:t.outLine,color:ni[f],list:[],count:0,max:Number.MIN_SAFE_INTEGER,point:i.endPoint.clone(),dir:p.clone(),normal:i.outNormal.clone(),angle:_},o[i.outLink]=C),i.value>C.max&&(C.max=i.value),C.count+=i.value,C.list.push(i)}for(const l of Object.values(n)){l.list.sort(((t,e)=>t.sort-e.sort));const t=r/2;let e=0,a=0;for(const[u,p]of l.list.entries()){let n=(1+((p.value-m)/(g-m)||0))*s,o=0;0==u?(o=e,e+=n/2+.2*s):(e+=n/2,o=e,e+=n/2+.2*s);const f=new(si().Text)({text:p.value,fontSize:r,fontFamily:"Calibri",fill:"black",rotation:180*l.angle/Math.PI});h[String(p.id)]=f,i.add(f);const v=f.width();v>a&&(a=v);const y=p.startPoint.clone();y.add(l.dir.setLength(t+f.width())).add(p.inNormal.setLength(t+o-f.height())),f.x(y.x),f.y(y.y),f.scale({x:-1,y:-1});const b=p.startPoint.clone().add(p.inNormal.setLength(o)).toArray(),_=p.startPointControl.clone().add(p.inNormal.setLength(o)).toArray(),w=p.endPointControl.toArray(),C=p.endPoint.toArray(),A=new(si().Arrow)({name:String(p.id),points:[b,_,w,C].flat(2),fill:l.color,stroke:l.color,strokeWidth:n,pointerWidth:n,pointerLength:n,bezier:!0});d[String(p.id)]=A,i.add(A);const S=new(si().TextPath)({text:`     ${p.name}`,fontSize:.8*s,fontFamily:"Calibri",fill:"#fff",data:`M${b.join(" ")} C ${_.join(" ")}, ${w.join(" ")}, ${C.join(" ")}`});c[String(p.id)]=S,i.add(S),A.on("click",(t=>{const e=t.target.name();h[e].moveToTop(),d[e].moveToTop(),c[e].moveToTop()})),A.on("mouseenter",(t=>{})),A.on("mouseleave",(t=>{}))}const n=new(si().Text)({text:`${l.name}：${l.count}`,fontSize:2*r,fontFamily:"Calibri",fill:"black",rotation:180*l.angle/Math.PI});u[String(l.id)]=n,i.add(n);const o=l.point.clone();o.add(l.dir.setLength(a+2*r+n.width())).add(l.normal.setLength((e-n.height())/2)),n.x(o.x),n.y(o.y),n.scale({x:-1,y:-1})}for(const l of Object.values(o)){let t=(1+((l.max-m)/(g-m)||0))*s;const e=l.point.clone(),a=new(si().Text)({text:`${l.name}：${l.count}`,fontSize:2*r,fontFamily:"Calibri",fill:"black",rotation:180*l.angle/Math.PI});p[String(l.id)]=a,i.add(a),e.sub(l.dir.setLength(a.width()+2*t)),e.add(l.normal.setLength(a.height()/2)),a.x(e.x),a.y(e.y)}return{_group:i,_LineMap:d,_LineTextMap:h,_LineNameMap:c,_inTextMap:u,_outTextMap:p}},handleDraw(){const{center:t=[0,0]}=this.detail.mapInfo,{_group:e,_LineMap:i,_LineTextMap:a,_LineNameMap:r,_inTextMap:s,_outTextMap:n}=this.getChart(t,this.tableList1);this._group&&this._group.destroy(),this._group=e,this._layer.add(this._group),this.handleChartResize(),this._LineMap=i,this._LineTextMap=a,this._LineNameMap=r,this._inTextMap=s,this._outTextMap=n},handleClose(){this.$emit("update:visible",!1),this.$emit("close")},getCrossroadsDetail(){return ut(this.params.id).then((t=>{t.data.crossroads.mapInfo=(0,Ke.HW)(t.data.crossroads.mapInfo,{}),t.data.crossroads.annex=(0,Ke.HW)(t.data.crossroads.annex,[]),this.detail=t.data.crossroads,this.crossroadsData=[this.detail.beginTime,this.detail.endTime]}))},getCrossroadsCorssStatsTable(){return this.loading=!0,rt(this.params.id).then((t=>{this.tableList1=t.data,this.loading=!1}))},crossroadsAnalyzeVideo(){(this.params||this.params.id)&&ht(this.params.id)},crossroadsTrackImage(){(this.params||this.params.id)&&dt(this.params.id)},crossroadsExportCorssStatsTable(){(this.params||this.params.id)&&ct(this.params.id)},handleDelete(t,e){this.$confirm(`是否确认删除线名为 ${t.name} 的记录?`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return st(t.id)})).then((()=>(this.$message.success("删除成功"),this.getCrossroadsCorssStatsTable()))).then((()=>{this.handleDraw()})).catch((()=>{}))},handleEdit(t){this.form=JSON.parse(JSON.stringify(t)),this.open=!0},handleSave(){this.$refs["form"].validate((t=>{if(t){const t=JSON.parse(JSON.stringify(this.form));t.count=t.car+t.van+t.bus+t.truck,void 0!=t.id?nt(t).then((t=>(this.$message.success("修改成功"),this.open=!1,this.getCrossroadsCorssStatsTable()))).then((()=>{this.handleDraw()})):ot(t).then((t=>(this.$message.success("新增成功"),this.open=!1,this.getCrossroadsCorssStatsTable()))).then((()=>{this.handleDraw()}))}}))},handleChartToDataUrl(){this.handleChartResize();const t=document.createElement("a");t.download="chart.png",t.href=this._layer.toDataURL(),document.body.appendChild(t),t.click(),document.body.removeChild(t)},handleSubmit(){const t=JSON.parse(JSON.stringify(this.detail));t.mapInfo=JSON.stringify(t.mapInfo),t.annex=JSON.stringify(t.annex),t.beginTime=this.crossroadsData[0],t.endTime=this.crossroadsData[1],this.saving=!0,vt(t).then((t=>{this.changeCrossroadsData=!1,this.saving=!1,this.$message.success("修改成功"),Promise.all([this.getCrossroadsDetail(),this.getCrossroadsCorssStatsTable()]).then((t=>{this.handleDraw()}))})).catch((t=>{this.saving=!1}))},addAnnex(){let t=document.createElement("input");t.type="file",t.accept="video/*",t.style="position: fixed;left: -100vw;top: -100vh;",t.onchange=()=>{let e=t.files[0];if(e){this.updoading=!0;let i=new FormData;i.append("file",e),(0,N.Z)({url:"/file/upload",method:"post",headers:{"Content-Type":"multipart/form-data"},data:i}).then((t=>{this.detail.annex.push({name:e.name,url:t.data}),this.handleSubmit()})).finally((()=>{document.body.removeChild(t),this.updoading=!1}))}else document.body.removeChild(t)},document.body.appendChild(t),t.click()},deleteAnnex(t){this.detail.annex.splice(t,1),this.handleSubmit()},handleQx(){this.changeCrossroadsData=!1,this.crossroadsData=[this.detail.beginTime,this.detail.endTime]}}},li=oi,hi=(0,xt.Z)(li,ii,ai,!1,null,"0cdc1ea4",null),di=hi.exports,ci=function(){var t=this,e=t._self._c;return e("Dialog",{staticClass:"CrossroadsStatsEdit",attrs:{title:"编辑交叉口流量线",top:50,left:100,width:"calc(100vw - 200px)",hideMinimize:"",visible:t.visible},on:{close:t.handleClose}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"CrossroadsStatsEdit_body"},[e("div",{staticStyle:{"margin-bottom":"18px"}},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.loadData}},[t._v("刷新")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.$emit("redraw")}}},[t._v("重新绘制检测线")])],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:24,lg:16,xl:16}},[e("div",{staticClass:"canvas",attrs:{id:"CrossroadsStatsEdit_canvas"}})]),e("el-col",{attrs:{span:24,lg:8,xl:8}},[e("el-table",{staticClass:"small",attrs:{data:t.tableList1,border:"",height:"calc(100vh - 240px)","row-class-name":t.tableRowClassName},on:{"row-click":t.handleTableRowClick}},[e("el-table-column",{attrs:{label:"编号",prop:"id"}}),e("el-table-column",{attrs:{label:"线名",prop:"name"}}),e("el-table-column",{attrs:{label:"初始线",prop:"inLink"}}),e("el-table-column",{attrs:{label:"终点线",prop:"outLink"}}),e("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.handleEdit(i)}}},[t._v("修改")]),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.handleDelete(i)}}},[t._v("删除")])]}}])})],1)],1)],1)],1),e("el-dialog",{attrs:{title:"修改交叉口流量",visible:t.open,width:"500px","append-to-body":""},on:{"update:visible":function(e){t.open=e}}},[e("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"100px",size:"mini"}},[e("el-form-item",{attrs:{label:"线名",prop:"name"}},[e("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.handleSave}},[t._v("确 定")]),e("el-button",{on:{click:function(e){t.open=!1}}},[t._v("取 消")])],1)],1)],1)},ui=[],pi={name:"CrossroadsStatsEdit",props:{visible:{type:Boolean},params:{type:Object}},components:{},computed:{},watch:{visible:{handler(t){t&&this.loadData()},immediate:!0,deep:!0}},data(){return{loading:!1,tableList1:[],inLinkList:[],outLinkList:[],form:{},rules:{center:[{required:!0,message:"交叉口位置不能为空",trigger:"blur"}]},open:!1,drawWidth:1200,drawHeight:675,detail:{},selectLineId:-1}},created(){},mounted(){this._stage=new(si().Stage)({container:"CrossroadsStatsEdit_canvas",width:this.drawWidth,height:this.drawHeight,draggable:!0}),this._layer=new(si().Layer),this._stage.add(this._layer),this._group=new(si().Group)({}),this._layer.add(this._group),this._resizeObserver=new ResizeObserver((t=>{this._setSizeTimeout||(this._setSizeTimeout=setTimeout((()=>{this.drawWidth=t[0].target.clientWidth,this.drawHeight=t[0].target.clientHeight,this._stage.width(this.drawWidth),this._stage.height(this.drawHeight),this._setSizeTimeout=null}),1e3/120))})),this._resizeObserver.observe(document.getElementById("CrossroadsStatsEdit_canvas"))},beforeDestroy(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null),this._stage&&this._stage.destroy()},methods:{loadData(){Promise.all([this.getCrossroadsDetail(),this.getCrossroadsCorssStatsTable()]).then((t=>{setTimeout((()=>{this.handleDraw()}),200)}))},handleClose(){this.$emit("update:visible",!1),this.$emit("close")},getCrossroadsDetail(){return ut(this.params.id).then((t=>{t.data.crossroads.mapInfo=(0,Ke.HW)(t.data.crossroads.mapInfo,{}),this.detail=t.data.crossroads}))},getCrossroadsCorssStatsTable(){return rt(this.params.id).then((t=>{this.tableList1=t.data}))},handleClearDraw(){try{this._group.destroy(),this._group=new(si().Group)({}),this._layer.add(this._group),this._LineMap={}}catch(t){}},handleDraw(){this.handleClearDraw();const{center:t,width:e,height:i,rotation:a}=this.detail.mapInfo,r=(new l.FM8).fromArray(t);this._group.x(this.drawWidth/2),this._group.y(this.drawHeight/2),this._group.rotation(a);const s=1080/i,n=this.drawHeight/1080;this._group.scale({x:n,y:n});const o=10;for(const h of this.tableList1){const t=(new l.FM8).fromArray((0,Ke.HW)(h.startPoint,[0,0])).sub(r).multiply(new l.FM8(1,-1)).multiplyScalar(s).toArray(),e=(new l.FM8).fromArray(h.inLinkInfo.toxy).sub(r).multiply(new l.FM8(1,-1)).multiplyScalar(s).toArray(),i=(new l.FM8).fromArray(h.outLinkInfo.fromxy).sub(r).multiply(new l.FM8(1,-1)).multiplyScalar(s).toArray(),a=(new l.FM8).fromArray((0,Ke.HW)(h.endPoint,[0,0])).sub(r).multiply(new l.FM8(1,-1)).multiplyScalar(s).toArray(),n=new(si().Arrow)({name:String(h.id),points:[t,e,i,a].flat(2),fill:"#409EFF",stroke:"#409EFF",strokeWidth:o,bezier:!0});n.on("click",(t=>{this.handleSelectLine(t.target.name())})),n.on("mouseenter",(t=>{this._stage.container().style.cursor="pointer"})),n.on("mouseleave",(t=>{this._stage.container().style.cursor="default"})),this._LineMap[String(h.id)]=n,this._group.add(n)}console.log(this.drawWidth,this.drawHeight,this.detail.mapInfo,this._LineMap)},handleTableRowClick(t,e,i){this.handleSelectLine(t.id)},handleSelectLine(t){this.selectLineId=t;for(const e of Object.values(this._LineMap))e.name()==t?(e.moveToTop(),e.fill("#FF0000"),e.stroke("#FF0000")):(e.fill("#409EFF"),e.stroke("#409EFF"))},crossroadsAnalyzeVideo(){(this.params||this.params.id)&&ht(this.params.id)},crossroadsTrackImage(){(this.params||this.params.id)&&dt(this.params.id)},crossroadsExportCorssStatsTable(){(this.params||this.params.id)&&ct(this.params.id)},handleDelete(t,e){this.$confirm(`是否确认删除线名为 ${t.name} 的记录?`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return st(t.id)})).then((()=>{const e=this._LineMap[t.id];e&&e.destroy(),this.getCrossroadsCorssStatsTable(),this.$message.success("删除成功")})).catch((()=>{}))},handleEdit(t){this.form=JSON.parse(JSON.stringify(t)),this.open=!0},handleSave(){this.$refs["form"].validate((t=>{if(t){const t=JSON.parse(JSON.stringify(this.form));t.count=t.car+t.van+t.bus+t.truck,void 0!=t.id?nt(t).then((t=>{this.$message.success("修改成功"),this.open=!1,this.getCrossroadsCorssStatsTable()})):ot(t).then((t=>{this.$message.success("新增成功"),this.open=!1,this.getCrossroadsCorssStatsTable()}))}}))},tableRowClassName({row:t,rowIndex:e}){return t.id==this.selectLineId?(console.log(t,this.selectLineId),"success-row"):""}}},gi=pi,mi=(0,xt.Z)(gi,ci,ui,!1,null,null,null),fi=mi.exports,vi=function(){var t=this,e=t._self._c;return e("Dialog",{staticClass:"CrossroadsList",attrs:{title:"交叉口调查记录",top:40,left:40,width:600,hideMinimize:"",visible:t.visible},on:{close:t.handleClose}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"CrossroadsList_body"},[e("div",[e("el-form",{ref:"form",attrs:{"label-width":"auto",inline:"",size:"mini"}},[e("el-form-item",{attrs:{label:"交叉口名称"}},[e("el-select",{attrs:{"remote-method":t.handleGetIntersectionList,filterable:"",remote:"",clearable:"",placeholder:"请输入关键词"},on:{change:t.handleSreachCrossroadsList,clear:function(e){return t.handleGetIntersectionList("")}},model:{value:t.crossroadsList.intersectionId,callback:function(e){t.$set(t.crossroadsList,"intersectionId",e)},expression:"crossroadsList.intersectionId"}},t._l(t.intersectionList.data,(function(t){return e("el-option",{key:t.id+t.name,attrs:{label:t.name,value:t.id}})})),1)],1)],1)],1),e("div",{staticStyle:{"margin-bottom":"18px"}},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.handleGetCrossroadsList}},[t._v("刷新")]),e("el-button",{attrs:{type:"primary",size:"mini",disabled:!t.crossroadsList.intersectionId},on:{click:t.handleShowEditIntersection}},[t._v("修改交叉口名称")]),e("el-button",{attrs:{type:"primary",size:"mini",disabled:!t.crossroadsList.intersectionId},on:{click:t.handleShowManuallyEnteringCrossroads}},[t._v("人工录入")]),e("el-button",{attrs:{type:"primary",size:"mini",disabled:!t.crossroadsList.intersectionId},on:{click:t.handleShowVideoInputCrossroads}},[t._v("视频识别")])],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.crossroadsList.loading,expression:"crossroadsList.loading"}],staticClass:"small",attrs:{data:t.crossroadsList.data,border:"",stripe:"",height:"calc(100vh - 400px)"}},[e("el-table-column",{attrs:{prop:"id",label:"id",width:"50px"}}),e("el-table-column",{attrs:{prop:"name",label:"交叉口","min-width":"80px"}}),e("el-table-column",{attrs:{prop:"type",label:"调查方式","min-width":"80px"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v(t._s(t.typeOptions[e.type]))]}}])}),e("el-table-column",{attrs:{prop:"status",label:"状态","min-width":"80px"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v(t._s(t.videoStateOptions[e.status]))]}}])}),e("el-table-column",{attrs:{prop:"beginTime,endTime",label:"调查日期",width:"160px"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[e("div",[t._v(t._s(i.beginTime))]),e("div",[t._v(t._s(i.endTime))])]}}])}),e("el-table-column",{attrs:{prop:"操作",label:"操作",width:"130px"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return e("div",{staticClass:"operate_btn"},[1==i.status||3==i.type||4==i.type?e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.handleRunCrossroad(i)}}},[t._v("运行")]):t._e(),e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.handleShowCrossroadsDetail(i)}}},[t._v("查看")]),e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.handleDeleteCrossroad(i)}}},[t._v("移除")]),e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.handleShowDrawLine(i)}}},[t._v("检测线绘制")])],1)}}])})],1),e("pagination",{staticClass:"crossroads_pagination",attrs:{total:t.crossroadsList.total,page:t.crossroadsList.pageNum,limit:t.crossroadsList.pageSize},on:{"update:page":function(e){return t.$set(t.crossroadsList,"pageNum",e)},"update:limit":function(e){return t.$set(t.crossroadsList,"pageSize",e)},pagination:t.handleGetCrossroadsList}})],1)])},yi=[],bi={name:"CrossroadsList",props:{visible:{type:Boolean},params:{type:Object}},inject:["rootVue"],components:{},computed:{},watch:{params:{handler(t){this.init()},immediate:!0,deep:!0},visible:{handler(t){this.init()},immediate:!0,deep:!0}},data(){return{loading:!1,intersectionList:{data:[],loading:!1,name:"",pageNum:1,pageSize:99999999,total:0},crossroadsList:{data:[],loading:!1,intersectionId:"",pageNum:1,pageSize:10,total:0},typeOptions:{0:"其他",1:"人工",2:"视频识别",3:"互联网路况估算"},videoTypeOptions:{0:"未知",1:"俯视航拍",1:"侧面路拍",1:"正斜角拍摄"},videoStateOptions:{0:"等待划线",1:"等待运行",2:"正在运行",3:"运行成功",4:"运行失败",5:"等待录入",6:"录入成功"},editIntersection:{show:!0,form:{id:"",name:""}}}},created(){},mounted(){},methods:{init(){this.visible&&(this.handleGetIntersectionList(this.params.name),this.handleSreachCrossroadsList(this.params.id))},handleClose(){this.handleSreachClear(),this.$emit("update:visible",!1),this.$emit("close")},handleSreachClear(){},handleGetIntersectionList(t){console.log(t),this.intersectionList.loading=!0,this.intersectionList.name=t,pt({name:this.intersectionList.name,pageSize:this.intersectionList.pageSize,pageNum:this.intersectionList.pageNum}).then((t=>{const{data:e,pageSize:i,pageNum:a,total:r}=t.data;this.intersectionList.data=e,this.intersectionList.pageSize=i,this.intersectionList.pageNum=a,this.intersectionList.loading=!1})).catch((t=>{this.intersectionList.loading=!1}))},async handleShowEditIntersection(){const t=(await gt(this.crossroadsList.intersectionId)).data;t.name=(await this.$prompt("请输入交叉口名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:t.name,inputPlaceholder:"请输入交叉口名称",inputPattern:/\S/})).value,await ft(t),this.handleGetIntersectionList(t.name),this.handleGetCrossroadsList(),this.$message.success("修改成功")},handleSreachCrossroadsList(t){console.log("handleSreachCrossroadsList",t),this.crossroadsList.intersectionId=t,this.crossroadsList.pageNum=1,this.handleGetCrossroadsList()},handleGetCrossroadsList(){this.crossroadsList.loading=!0;const t={intersectionId:this.crossroadsList.intersectionId,pageSize:this.crossroadsList.pageSize,pageNum:this.crossroadsList.pageNum};t.intersectionId?gt(t.intersectionId).then((t=>{this.rootVue._Map&&(this.rootVue._Map.setCenter([t.data.x,t.data.y]),this.rootVue._Map.setZoom(16)),this.selectIntersection=t.data})):this.selectIntersection=null,it(t).then((t=>{const{data:e,pageSize:i,pageNum:a,total:r}=t.data;this.crossroadsList.data=e,this.crossroadsList.pageSize=i,this.crossroadsList.pageNum=a,this.crossroadsList.total=r,this.crossroadsList.loading=!1})).catch((t=>{this.crossroadsList.loading=!1}))},handleDeleteCrossroad(t){const e=t.id;this.$confirm('是否确认删除编号为"'+e+'"的记录?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return at(e)})).then((()=>{this.handleGetCrossroadsList(),this.$message.success("删除成功")})).catch((t=>{console.log(t)}))},handleRunCrossroad(t){lt(t.id).then((t=>{this.handleGetCrossroadsList()}))},handleShowCrossroadsDetail(t){this.$emit("showCrossroadsDetail",t)},handleShowCrossroadsStatsEdit(t){this.$emit("showCrossroadsStatsEdit",t)},handleShowDrawLine(t){this.$emit("showDrawLine",t)},handleShowManuallyEnteringCrossroads(t){this.$emit("showManuallyEnteringCrossroads",{intersectionId:this.crossroadsList.intersectionId})},handleShowVideoInputCrossroads(t){this.$emit("showVideoInputCrossroads",{intersectionId:this.crossroadsList.intersectionId})}}},_i=bi,wi=(0,xt.Z)(_i,vi,yi,!1,null,"72e4a0a6",null),Ci=wi.exports,Ai=function(){var t=this,e=t._self._c;return e("Dialog",{staticClass:"AddIntersection",attrs:{title:"新建交叉口",top:50,left:100,width:"600px",hideMinimize:"",visible:t.visible},on:{close:t.handleClose}},[e("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"100px",size:"small"}},[e("el-form-item",{attrs:{label:"交叉口位置",prop:"center"}},[e("div",[t._v(t._s(t.MercatorToWGS84(t.form.center)))]),e("div",[e("span",{staticStyle:{"margin-right":"20px"}},[t._v("调整位置")]),e("el-switch",{attrs:{"active-value":t.POINT_SELECT_STATE_KEY.ENABLE,"inactive-value":t.POINT_SELECT_STATE_KEY.DISABLE},on:{change:t.handleChangeSelectState},model:{value:t.selectState,callback:function(e){t.selectState=e},expression:"selectState"}})],1)]),e("el-form-item",{attrs:{label:"交叉口名称",prop:"name"}},[e("el-input",{attrs:{type:"textarea",autosize:{minRows:2}},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),e("el-form-item",[e("el-button",{on:{click:t.handleClose}},[t._v("取消")]),e("el-button",{attrs:{loading:t.saving,type:"primary"},on:{click:t.handleSubmit}},[t._v("下一步")])],1)],1)],1)},Si=[],xi={name:"AddIntersection",inject:["rootVue"],props:{visible:{type:Boolean}},components:{},computed:{},watch:{visible:{handler(t){t?this.handleEnable():this.handleDisable()},immediate:!0,deep:!0}},data(){return{POINT_SELECT_STATE_KEY:u,selectState:u.DISABLE,saving:!1,form:{center:[0,0],name:""},rules:{center:[{required:!0,message:"交叉口位置不能为空",trigger:"blur"}],name:[{required:!0,message:"交叉口名称不能为空",trigger:"blur"}]}}},created(){},mounted(){},beforeDestroy(){this.handleDisable()},methods:{MercatorToWGS84(t){try{return(0,n.Nq)(t[0],t[1]).map((t=>Number(Number(t).toFixed(9))))}catch(e){console.log(e)}},handleChangeSelectState(t){this._PointSelectLayer&&(this.rootVue._PointSelectLayer.state=t)},handleEnable(){this._PointSelectLayer=this.rootVue._PointSelectLayer,this._PointSelectLayer&&(this._eventId1=this._PointSelectLayer.addEventListener(p.STATE_CHANGE,(t=>{this.selectState=t.data.state})),this._eventId2=this._PointSelectLayer.addEventListener(p.POINT_CHANGE,(t=>{t.data.point[0]&&t.data.point[1]?this.form.center=t.data.point:this.form.center=null})),this.selectState=this.rootVue._PointSelectLayer.state,this.rootVue._PointSelectLayer.point[0]&&this.rootVue._PointSelectLayer.point[1]?this.form.center=this.rootVue._PointSelectLayer.point:this.form.center=null)},handleDisable(){this.form={center:[0,0],name:""},this.selectState=u.DISABLE,this._PointSelectLayer&&(this._PointSelectLayer.removeEventListener(p.STATE_CHANGE,this._eventId1),this._PointSelectLayer.removeEventListener(p.POINT_CHANGE,this._eventId2),this._PointSelectLayer=null)},handleClose(){this.$emit("update:visible",!1),this.$emit("close")},handleSubmit(){this.$refs["form"].validate((t=>{if(t){const t={x:this.form.center[0],y:this.form.center[1],name:this.form.name};this.saving=!0,mt(t).then((t=>{this.$emit("submited",t.data),this.saving=!1})).catch((t=>{this.saving=!1}))}}))}}},ki=xi,Li=(0,xt.Z)(ki,Ai,Si,!1,null,"7e56a8a8",null),Ei=Li.exports,Mi=function(){var t=this,e=t._self._c;return e("div",{staticClass:"UploadImageZip"},[t.updoading?e("div",{staticClass:"progress_box"},[e("el-progress",{attrs:{percentage:t.progress}}),e("i",{staticClass:"el-icon-circle-close",on:{click:function(e){return t.controller.abort()}}})],1):e("el-button",{attrs:{type:"primary"},on:{click:t.handleSelectFile}},[t._v("选择Zip文件")])],1)},Ti=[],Fi={name:"UploadImageZip",props:{},components:{},computed:{},watch:{},data(){return{controller:null,progress:0,updoading:!1}},created(){},mounted(){},methods:{handleSelectFile(){this.controller&&this.controller.abort(),this.controller=new AbortController;let t=document.createElement("input");t.type="file",t.accept=".zip",t.style="position: fixed;left: -100vw;top: -100vh;",t.onchange=()=>{let e=t.files[0],i=new FormData;i.append("file",e),(0,N.Z)({url:"/mappicture/uploadzip",method:"post",headers:{"Content-Type":"multipart/form-data"},data:i,signal:this.controller.signal,onUploadProgress:t=>{console.log(t),this.progress=Math.floor(95*t.progress),this.updoading=!0}}).then((t=>{this.handleInput(t.data)})).finally((()=>{document.body.removeChild(t),this.updoading=!1,this.progress=0}))},document.body.appendChild(t),t.click()}}},Di=Fi,Pi=(0,xt.Z)(Di,Mi,Ti,!1,null,"37f8c042",null),Ii=Pi.exports,Ni=function(){var t=this,e=t._self._c;return e("Dialog",{staticClass:"ImageListDialog",attrs:{title:"图片列表",top:50,left:100,width:"900px",hideMinimize:"",visible:t.visible},on:{close:t.handleClose}},[t.showImageList?e("div",[e("div",{staticClass:"image_title"},[e("div",{staticClass:"path"},[t._v(t._s(t.selectPath))]),e("el-button",{attrs:{icon:"el-icon-arrow-left",type:"primary",size:"mini"},on:{click:function(e){t.showImageList=!1}}},[t._v("返回")])],1),e("div",{staticClass:"image_list"},t._l(t.imageList,(function(i,a){return e("div",{key:a,staticClass:"image_box"},[e("el-image",{attrs:{src:i.url,"preview-src-list":t.previewSrcList,fit:"fill",lazy:!0}}),e("div",{staticClass:"btn_list"},[e("div",{staticClass:"el-icon-aim",on:{click:function(e){return e.stopPropagation(),t.handleSetCenter(i)}}}),e("div",{staticClass:"el-icon-delete",on:{click:function(e){return e.stopPropagation(),t.handleDeleteImage(i)}}})])],1)})),0)]):e("div",[e("el-form",{ref:"form",attrs:{model:t.queryparam,"label-width":"auto",inline:!0,size:"small"}},[e("el-form-item",{attrs:{label:"名称"}},[e("el-input",{model:{value:t.queryparam.name,callback:function(e){t.$set(t.queryparam,"name",e)},expression:"queryparam.name"}})],1),e("el-form-item",{attrs:{label:"时间"}},[e("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.queryparam.time,callback:function(e){t.$set(t.queryparam,"time",e)},expression:"queryparam.time"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.getTree}},[t._v("搜索")])],1)],1),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.dirList,"max-height":"calc(100vh - 300px)","row-key":"path",border:"","default-expand-all":"","tree-props":{children:"subdir"}}},[e("el-table-column",{attrs:{label:"名称",prop:"name"}}),e("el-table-column",{attrs:{label:"时间",prop:"createTime",width:"180"}}),e("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.handleDeleteDir(i)}}},[t._v("删除")]),i.pictures&&i.pictures.length?e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.handleShowImageList(i)}}},[t._v("查看")]):t._e()]}}],null,!1,860358421)})],1)],1)])},Ri=[],Oi={name:"ImageListDialog",inject:["rootVue"],props:{visible:{type:Boolean}},components:{},computed:{previewSrcList(){return this.imageList.map((t=>t.url))}},watch:{visible:{handler(t){t?this.handleEnable():this.handleDisable()},immediate:!0,deep:!0}},data(){return{queryparam:{name:"",time:[]},dirList:[],showImageList:!1,selectPath:"",imageList:[]}},created(){},mounted(){},beforeDestroy(){this.handleDisable()},methods:{handleSetCenter(t){this.rootVue.handleSetHMash(t),this.rootVue._Map.setCenter([t.x,t.y])},getTree(){const{name:t,time:e}=this.queryparam;_t({name:t,beginTime:(e||[])[0]||"",endTime:(e||[])[1]||""}).then((t=>{this.dirList=t.data;const e=this.dirList.find((t=>t.path==this.selectPath));e?this.imageList=e.pictures:(this.imageList=[],this.showImageList=!1)}))},handleEnable(){this.getTree()},handleDisable(){},handleClose(){this.$emit("update:visible",!1),this.$emit("close")},handleDeleteDir(t){this.$confirm(`是否确认删除${t.path}下全部图片?`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return wt({path:t.path})})).then((()=>{this.getTree(),this.$message.success("删除成功")})).catch((()=>{}))},handleShowImageList(t){this.selectPath=t.path,this.imageList=t.pictures,this.showImageList=!0},handleDeleteImage(t){this.$confirm("是否确认删除当前图片?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return bt(t.id)})).then((()=>{this.imageDialog={visible:!1,data:null},this.getTree(),this.$message.success("删除成功")})).catch((()=>{}))}}},Bi=Oi,Gi=(0,xt.Z)(Bi,Ni,Ri,!1,null,"6548203a",null),Ui=Gi.exports;const zi=14;var Wi={provide(){return{rootVue:this}},data(){return{SHOW_LINK_ZOOM:zi,activeNames:["1","2","3","4"],activeNames2:["2-1","2-2"],selectRouteId:null,selectLinkId:null,ruleForm:{zoom:13,wayWidth:5,twoWayOffset:10,frameSelectState:h.NOT_STARTED,pointSelectState:u.DISABLE,timeList:[],type:null,routeName:null,center:(0,n.ob)(113.459868,23.171394),routeId:null,linkId:null},MAP_ZOOM_RANGE:s.$X,FRAME_SELECT_STATE_KEY:h,POINT_SELECT_STATE_KEY:u,lineFlow:{visible:!1,linkId:null},frameLink:{visible:!1,xyarr:null},frameCrossroads:{visible:!1,xyarr:null},videoInputCrossroads:{visible:!1,params:{}},manuallyEnteringCrossroads:{visible:!1,params:{}},drawLine:{visible:!1,params:{}},crossroadsStatsEdit:{visible:!1,params:{}},crossroadsDetail:{visible:!1,params:{}},crossroadsList:{visible:!1,params:{}},addIntersection:{visible:!1,params:{}},imageDialog:{visible:!1,data:null},imageListDialog:{visible:!1},typeOptions:{0:"其他",1:"人工",2:"视频识别",3:"互联网路况估算"},videoTypeOptions:{0:"未知",1:"俯视航拍",1:"侧面路拍",1:"正斜角拍摄"},videoStateOptions:{0:"等待划线",1:"等待运行",2:"正在运行",3:"运行成功",4:"运行失败",5:"等待录入",6:"录入成功"},showStyleMenu:!1,styleList:[],styleActive:0,showLinkStatsLayer:!0,showIntersectionListLayer:!0,showImageListLayer:!0}},components:{LineFlow:Lt,FrameLink:Pt,HelpDialog:De,RouteSelect:Gt,LinkSelect:Yt,CenterInput:jt,VideoInputCrossroads:Be,DrawLine:ei,CrossroadsDetail:di,CrossroadsStatsEdit:fi,ManuallyEnteringCrossroads:He,CrossroadsList:Ci,AddIntersection:Ei,UploadImageZip:Ii,ImageListDialog:Ui},computed:{showSetting(){return!this.addIntersection.visible&&!this.crossroadsList.visible&&!this.videoInputCrossroads.visible&&!this.manuallyEnteringCrossroads.visible&&!this.drawLine.visible&&!this.crossroadsStatsEdit.visible&&!this.crossroadsDetail.visible&&!this.imageDialog.visible&&!this.imageListDialog.visible},showCrossroadsList(){return this.crossroadsList.visible&&!this.videoInputCrossroads.visible&&!this.manuallyEnteringCrossroads.visible&&!this.drawLine.visible&&!this.crossroadsStatsEdit.visible&&!this.crossroadsDetail.visible}},watch:{showLinkStatsLayer(t){t?this._Map.addLayer(this._LinkStatsLayer):this._Map.removeLayer(this._LinkStatsLayer)},showIntersectionListLayer(t){t?this._Map.addLayer(this._IntersectionListLayer):this._Map.removeLayer(this._IntersectionListLayer)},showImageListLayer(t){t?this._Map.addLayer(this._ImageListLayer):this._Map.removeLayer(this._ImageListLayer)}},created(){this.initLayer()},async mounted(){this.initMap(),this.handleLoadNetwork(),this.handleLoadMaker(),this.handleLoadIntersectionList(),this.handleLoadImageList(),i.e(993).then(i.t.bind(i,2993,19)).then((t=>{this._GuangZhouLayer.setData(t.default)})),i.e(177).then(i.t.bind(i,2177,19)).then((t=>{this._HuangPuLayer.setData(t.default)}))},methods:{initLayer(){this._MapLayer=new s.t5({tileClass:s.LA[0],zIndex:0});{const t=s.LA,e=[],i=Object.values(t);for(let a=0,r=i.length;a<r;a++){const t=i[a];t===this._MapLayer.tileClass&&(this.styleActive=a);const r={title:t.style_name,url:new t(15,26700,14218,200).getUrl(),c:t};e.push(r)}this.styleList=e}this._NetworkLayer=new y({zIndex:10,lineWidth:this.ruleForm.wayWidth,event:{[s.kT.HANDLE_PICK_LEFT]:t=>{this.lineFlow={visible:!1,linkId:null},this.selectRouteId=t.data.id,this.getLink()}}}),this._LinkLayer=new x({zIndex:30,color:6799930,lineWidth:this.ruleForm.wayWidth,twoWayOffset:this.ruleForm.twoWayOffset,event:{[s.kT.HANDLE_PICK_LEFT]:t=>{this.handleChangeLink(t.data)}}}),this._LinkStatsLayer=new k({zIndex:100,event:{[s.kT.HANDLE_PICK_LEFT]:t=>{this.handleMoveToLink({value:t.data.linkId,item:{origid:t.data.wayId}})}}}),this._IntersectionListLayer=new F({zIndex:110,event:{[s.kT.HANDLE_PICK_LEFT]:t=>{this.handleSubmitAddIntersection(t.data)}}}),this._ImageListLayer=new D({zIndex:110,event:{[s.kT.HANDLE_PICK_LEFT]:t=>{this.handleShowImageDialog(t.data)}}}),this._FrameSelectLayer=new c({zIndex:50,event:{[d.STATE_CHANGE]:t=>{this.ruleForm.frameSelectState=t.data.state,this.ruleForm.frameSelectState===h.ENDED?this.frameLink.xyarr=[t.data.xy.rightTop,t.data.xy.rightBottom,t.data.xy.leftBottom,t.data.xy.leftTop]:this.frameLink.xyarr=null}}}),this._PointSelectLayer=new g({zIndex:120,color:"#ff0000",event:{[p.POINT_CHANGE]:t=>{this.showAddIntersection(t.data.point)},[p.STATE_CHANGE]:t=>{this.ruleForm.pointSelectState=t.data.state}}}),this._GuangZhouLayer=new E({zIndex:10,color:"blue"}),this._HuangPuLayer=new E({zIndex:10,color:"red"})},initMap(){this._Map=new s.s1({rootId:"mapRoot",zoom:this.ruleForm.zoom,center:this.ruleForm.center,event:{[s.kT.UPDATE_ZOOM]:t=>{this.ruleForm.zoom=Number(Number(this._Map.zoom).toFixed(2)),this.ruleForm.zoom>zi?(this._Map.addLayer(this._NetworkLayer),this._Map.addLayer(this._LinkLayer)):(this._Map.removeLayer(this._NetworkLayer),this._Map.removeLayer(this._LinkLayer))},[s.kT.UPDATE_CENTER]:t=>{this.ruleForm.center=this._Map.center}}}),this._Map.addLayer(this._MapLayer),this.ruleForm.zoom>zi?(this._Map.addLayer(this._NetworkLayer),this._Map.addLayer(this._LinkLayer)):(this._Map.removeLayer(this._NetworkLayer),this._Map.removeLayer(this._LinkLayer)),this.showLinkStatsLayer&&this._Map.addLayer(this._LinkStatsLayer),this.showIntersectionListLayer&&this._Map.addLayer(this._IntersectionListLayer),this.showImageListLayer&&this._Map.addLayer(this._ImageListLayer),this._Map.addLayer(this._FrameSelectLayer),this._Map.addLayer(this._PointSelectLayer),this._Map.addLayer(this._GuangZhouLayer),this._Map.addLayer(this._HuangPuLayer)},handleLoadNetwork(){R({selectAll:!0}).then((t=>{this._NetworkData=t.data,this._NetworkLayer.setData(t.data),this.$emit("loadNetwork")}))},handleLoadMaker(){let t=this.ruleForm.timeList||[],e={beginTime:t[0]||"",endTime:t[1]||"",type:this.ruleForm.type||""};W(e).then((t=>{this._LinkStatsLayer.setData(t.data)}))},handleLoadIntersectionList(){let t={pageSize:999999999,pageNum:1};pt(t).then((t=>{this._IntersectionListLayer.setData(t.data.data)}))},handleLoadImageList(){yt().then((t=>{this._ImageListLayer.setData(t.data)}))},handleChangeLink(t){this.lineFlow={visible:!0,linkId:t.id};const{clientWidth:e,clientHeight:i}=this._Map.rootDoc,[a,r]=this._Map.WindowXYToWebMercator(e/3,i/2),[s,n]=this._Map.center;let o=[(t.fromxy[0]+t.toxy[0])/2+s-a,(t.fromxy[1]+t.toxy[1])/2];this._Map.setCenter(o),this._LinkLayer.setSelectId(t.id)},lineFlowUpdateData(){this.handleLoadMaker(),this.selectRouteId&&O(this.selectRouteId).then((t=>{this._LinkLayer.setData(t.data,this._LinkLayer.selectId)}))},lineFlowClose(){this.selectRouteId&&O(this.selectRouteId).then((t=>{this._LinkLayer.setData(t.data)}))},getLink(){this.selectRouteId&&O(this.selectRouteId).then((t=>{this._LinkLayer.setData(t.data)}))},handleChangeStyle(t){this.showStyleMenu=!1,this.styleActive=t,this._MapLayer.setTileClass(this.styleList[t].c)},handleChangeZoomLavel(){this._Map.setZoom(this.ruleForm.zoom)},handleChangeTwoWayOffset(t){this._NetworkLayer&&this._NetworkLayer.setValues({twoWayOffset:t}),this._LinkLayer&&this._LinkLayer.setValues({twoWayOffset:t})},handleChangeWayWidth(t){this._NetworkLayer&&this._NetworkLayer.setValues({lineWidth:t}),this._LinkLayer&&this._LinkLayer.setValues({lineWidth:t})},handleShowFrameLink(){this.frameLink.visible=!0},handlePlayFrameSelect(){this.handleStopFrameSelect(),this.frameLink={visible:!1,xyarr:null},this._FrameSelectLayer&&(this._FrameSelectLayer.reset(),this._FrameSelectLayer.play(),this.ruleForm.frameSelectState=this._FrameSelectLayer.state)},handleReplayFrameSelect(){this.frameLink={visible:!1,xyarr:null},this._FrameSelectLayer&&(this._FrameSelectLayer.reset(),this._FrameSelectLayer.play(),this.ruleForm.frameSelectState=this._FrameSelectLayer.state)},handleStopFrameSelect(){this.frameLink={visible:!1,xyarr:null},this._FrameSelectLayer&&(this._FrameSelectLayer.reset(),this._FrameSelectLayer.stop(),this.ruleForm.frameSelectState=this._FrameSelectLayer.state)},handlePlayPointSelect(){this._PointSelectLayer.state=u.ENABLE},handleStopPointSelect(){this._PointSelectLayer.state=u.DISABLE,this._PointSelectLayer.point=[0,0]},showAddIntersection(t){this._PointSelectLayer&&(this._PointSelectLayer.point=t),this.addIntersection.visible=!0},handleSubmitAddIntersection(t){this.handleLoadIntersectionList(),this.addIntersection.visible=!1,this.crossroadsList.params=t||{},this.crossroadsList.visible=!0,this.handleStopPointSelect()},handleShowCrossroadsDetail(t){this.crossroadsDetail.params=t,this.crossroadsDetail.visible=!0},handleShowCrossroadsStatsEdit(t){this.crossroadsStatsEdit.params=t,this.crossroadsStatsEdit.visible=!0},handleShowVideoInputCrossroads(t){this.videoInputCrossroads.params=t,this.videoInputCrossroads.visible=!0},handleSubmitVideoInputCrossroads(t){this.videoInputCrossroads.visible=!1,this.handleShowDrawLine(t)},handleShowManuallyEnteringCrossroads(t){this.manuallyEnteringCrossroads.params=t,this.manuallyEnteringCrossroads.visible=!0},handleSubmitManuallyEnteringCrossroads(t){this.manuallyEnteringCrossroads.visible=!1,this.handleShowDrawLine(t)},handleShowDrawLine(t){this.drawLine.params=t,this.drawLine.visible=!0},handleDrawLineSuccess(){this.drawLine.visible=!1,this.handleStopPointSelect(),this.handleShowCrossroadsStatsEdit(this.drawLine.params)},handleShowCrossroadsStatsEdit(t){this.crossroadsStatsEdit.params=t,this.crossroadsStatsEdit.visible=!0},handleRedraw(){this.crossroadsStatsEdit.visible=!1,this.handleShowDrawLine(this.crossroadsStatsEdit.params)},handleMoveToRoute({value:t}){this.selectRouteId=t,O(this.selectRouteId).then((t=>{let{zoom:e,center:i}=this._Map.getFitZoomAndCenter(t.data[0].map((t=>t.fromxy)));this._Map.setCenter(i),this._Map.setZoom(e),this._LinkLayer.setData(t.data)}))},handleMoveToCenter(){this._Map.setCenter(this.ruleForm.center)},handleMoveToLink({value:t,item:e}){this.selectRouteId=e.origid,this.selectLinkId=t,O(this.selectRouteId).then((e=>{let{zoom:i,center:a}=this._Map.getFitZoomAndCenter(e.data[0].map((t=>t.fromxy)));this._Map.setCenter(a),this._Map.setZoom(i),this._LinkLayer.setData(e.data);for(const r of e.data)for(const e of r)if(e.id==t)return void setTimeout((()=>{this.handleChangeLink(e)}),500)}))},handleDeleteImage(t){this.$confirm("是否确认删除当前图片?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return bt(t.id)})).then((()=>{this.imageDialog={visible:!1,data:null},this.handleSetHMash(null),this.handleLoadImageList(),this.$message.success("删除成功")})).catch((()=>{}))},handleShowImageDialog(t){this.imageDialog={visible:!0,data:t},this.handleSetHMash(t)},handleSetHMash(t){this._ImageListLayer.setHMesh(t)}}},Vi=Wi,Hi=(0,xt.Z)(Vi,a,r,!1,null,"363c3bee",null),Yi=Hi.exports},2966:function(t,e,i){i(560),Object.defineProperty(e,"__esModule",{value:!0}),e.Animation=void 0;const a=i(3552),r=i(8007),s=function(){return a.glob.performance&&a.glob.performance.now?function(){return a.glob.performance.now()}:function(){return(new Date).getTime()}}();class n{constructor(t,e){this.id=n.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:s(),frameRate:0},this.func=t,this.setLayers(e)}setLayers(t){let e=[];return t&&(e=Array.isArray(t)?t:[t]),this.layers=e,this}getLayers(){return this.layers}addLayer(t){const e=this.layers,i=e.length;for(let a=0;a<i;a++)if(e[a]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const t=n,e=t.animations,i=e.length;for(let a=0;a<i;a++)if(e[a].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=s(),n._addAnimation(this),this}stop(){return n._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const e=t.id,i=this.animations,a=i.length;for(let r=0;r<a;r++)if(i[r].id===e){this.animations.splice(r,1);break}}static _runFrames(){const t={},e=this.animations;for(let i=0;i<e.length;i++){const a=e[i],r=a.layers,n=a.func;a._updateFrameObject(s());const o=r.length;let l;if(l=!n||!1!==n.call(a,a.frame),l)for(let e=0;e<o;e++){const i=r[e];void 0!==i._id&&(t[i._id]=i)}}for(let i in t)t.hasOwnProperty(i)&&t[i].batchDraw()}static _animationLoop(){const t=n;t.animations.length?(t._runFrames(),r.Util.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,r.Util.requestAnimFrame(this._animationLoop))}}e.Animation=n,n.animations=[],n.animIdCounter=0,n.animRunning=!1},125:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.t2length=e.getQuadraticArcLength=e.getCubicArcLength=e.binomialCoefficients=e.cValues=e.tValues=void 0,e.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],e.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],e.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const i=(t,i,a)=>{let s,n,o;const l=20;s=a/2,n=0;for(let h=0;h<l;h++)o=s*e.tValues[l][h]+s,n+=e.cValues[l][h]*r(t,i,o);return s*n};e.getCubicArcLength=i;const a=(t,e,i)=>{void 0===i&&(i=1);const a=t[0]-2*t[1]+t[2],r=e[0]-2*e[1]+e[2],s=2*t[1]-2*t[0],n=2*e[1]-2*e[0],o=4*(a*a+r*r),l=4*(a*s+r*n),h=s*s+n*n;if(0===o)return i*Math.sqrt(Math.pow(t[2]-t[0],2)+Math.pow(e[2]-e[0],2));const d=l/(2*o),c=h/o,u=i+d,p=c-d*d,g=u*u+p>0?Math.sqrt(u*u+p):0,m=d*d+p>0?Math.sqrt(d*d+p):0,f=d+Math.sqrt(d*d+p)!==0?p*Math.log(Math.abs((u+g)/(d+m))):0;return Math.sqrt(o)/2*(u*g-d*m+f)};function r(t,e,i){const a=s(1,i,t),r=s(1,i,e),n=a*a+r*r;return Math.sqrt(n)}e.getQuadraticArcLength=a;const s=(t,i,a)=>{const r=a.length-1;let n,o;if(0===r)return 0;if(0===t){o=0;for(let t=0;t<=r;t++)o+=e.binomialCoefficients[r][t]*Math.pow(1-i,r-t)*Math.pow(i,t)*a[t];return o}n=new Array(r);for(let e=0;e<r;e++)n[e]=r*(a[e+1]-a[e]);return s(t-1,i,n)},n=(t,e,i)=>{let a=1,r=t/e,s=(t-i(r))/e,n=0;while(a>.001){const o=i(r+s),l=Math.abs(t-o)/e;if(l<a)a=l,r+=s;else{const n=i(r-s),o=Math.abs(t-n)/e;o<a?(a=o,r-=s):s/=2}if(n++,n>500)break}return r};e.t2length=n},7383:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.HitCanvas=e.SceneCanvas=e.Canvas=void 0;const a=i(8007),r=i(3902),s=i(3552),n=i(9658),o=i(7723);var l;function h(){if(l)return l;var t=a.Util.createCanvasElement(),e=t.getContext("2d");return l=function(){var t=s.Konva._global.devicePixelRatio||1,i=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/i}(),a.Util.releaseCanvas(t),l}class d{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var e=t||{},i=e.pixelRatio||s.Konva.pixelRatio||h();this.pixelRatio=i,this._canvas=a.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){var e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";var e=this.pixelRatio,i=this.getContext()._context;i.scale(e,e)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";var e=this.pixelRatio,i=this.getContext()._context;i.scale(e,e)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,e){this.setWidth(t||0),this.setHeight(e||0)}toDataURL(t,e){try{return this._canvas.toDataURL(t,e)}catch(i){try{return this._canvas.toDataURL()}catch(r){return a.Util.error("Unable to get data URL. "+r.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}e.Canvas=d,n.Factory.addGetterSetter(d,"pixelRatio",void 0,(0,o.getNumberValidator)());class c extends d{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new r.SceneContext(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}e.SceneCanvas=c;class u extends d{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new r.HitContext(this),this.setSize(t.width,t.height)}}e.HitCanvas=u},7867:function(t,e,i){i(560),Object.defineProperty(e,"__esModule",{value:!0}),e.Container=void 0;const a=i(9658),r=i(6205),s=i(7723);class n extends r.Node{constructor(){super(...arguments),this.children=[]}getChildren(t){if(!t)return this.children||[];const e=this.children||[];var i=[];return e.forEach((function(e){t(e)&&i.push(e)})),i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach((t=>{t.parent=null,t.index=0,t.remove()})),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach((t=>{t.parent=null,t.index=0,t.destroy()})),this.children=[],this._requestDraw(),this}add(...t){if(0===t.length)return this;if(t.length>1){for(var e=0;e<t.length;e++)this.add(t[e]);return this}const i=t[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){var e=this._generalFind(t,!0);return e.length>0?e[0]:void 0}_generalFind(t,e){var i=[];return this._descendants((a=>{const r=a._isMatch(t);return r&&i.push(a),!(!r||!e)})),i}_descendants(t){let e=!1;const i=this.getChildren();for(const a of i){if(e=t(a),e)return!0;if(a.hasChildren()&&(e=a._descendants(t),e))return!0}return!1}toObject(){var t=r.Node.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach((e=>{t.children.push(e.toObject())})),t}isAncestorOf(t){var e=t.getParent();while(e){if(e._id===this._id)return!0;e=e.getParent()}return!1}clone(t){var e=r.Node.prototype.clone.call(this,t);return this.getChildren().forEach((function(t){e.add(t.clone())})),e}getAllIntersections(t){var e=[];return this.find("Shape").forEach((i=>{i.isVisible()&&i.intersects(t)&&e.push(i)})),e}_clearSelfAndDescendantCache(t){var e;super._clearSelfAndDescendantCache(t),this.isCached()||null===(e=this.children)||void 0===e||e.forEach((function(e){e._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;null===(t=this.children)||void 0===t||t.forEach((function(t,e){t.index=e})),this._requestDraw()}drawScene(t,e,i){var a=this.getLayer(),r=t||a&&a.getCanvas(),s=r&&r.getContext(),n=this._getCanvasCache(),o=n&&n.scene,l=r&&r.isCache;if(!this.isVisible()&&!l)return this;if(o){s.save();var h=this.getAbsoluteTransform(e).getMatrix();s.transform(h[0],h[1],h[2],h[3],h[4],h[5]),this._drawCachedSceneCanvas(s),s.restore()}else this._drawChildren("drawScene",r,e,i);return this}drawHit(t,e){if(!this.shouldDrawHit(e))return this;var i=this.getLayer(),a=t||i&&i.hitCanvas,r=a&&a.getContext(),s=this._getCanvasCache(),n=s&&s.hit;if(n){r.save();var o=this.getAbsoluteTransform(e).getMatrix();r.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this._drawCachedHitCanvas(r),r.restore()}else this._drawChildren("drawHit",a,e);return this}_drawChildren(t,e,i,a){var r,s=e&&e.getContext(),n=this.clipWidth(),o=this.clipHeight(),l=this.clipFunc(),h="number"===typeof n&&"number"===typeof o||l;const d=i===this;if(h){s.save();var c=this.getAbsoluteTransform(i),u=c.getMatrix();let t;if(s.transform(u[0],u[1],u[2],u[3],u[4],u[5]),s.beginPath(),l)t=l.call(this,s,this);else{var p=this.clipX(),g=this.clipY();s.rect(p||0,g||0,n,o)}s.clip.apply(s,t),u=c.copy().invert().getMatrix(),s.transform(u[0],u[1],u[2],u[3],u[4],u[5])}var m=!d&&"source-over"!==this.globalCompositeOperation()&&"drawScene"===t;m&&(s.save(),s._applyGlobalCompositeOperation(this)),null===(r=this.children)||void 0===r||r.forEach((function(r){r[t](e,i,a)})),m&&s.restore(),h&&s.restore()}getClientRect(t={}){var e,i,a,r,s,n=t.skipTransform,o=t.relativeTo,l={x:1/0,y:1/0,width:0,height:0},h=this;null===(e=this.children)||void 0===e||e.forEach((function(e){if(e.visible()){var n=e.getClientRect({relativeTo:h,skipShadow:t.skipShadow,skipStroke:t.skipStroke});0===n.width&&0===n.height||(void 0===i?(i=n.x,a=n.y,r=n.x+n.width,s=n.y+n.height):(i=Math.min(i,n.x),a=Math.min(a,n.y),r=Math.max(r,n.x+n.width),s=Math.max(s,n.y+n.height)))}}));for(var d=this.find("Shape"),c=!1,u=0;u<d.length;u++){var p=d[u];if(p._isVisible(this)){c=!0;break}}return l=c&&void 0!==i?{x:i,y:a,width:r-i,height:s-a}:{x:0,y:0,width:0,height:0},n?l:this._transformedRect(l,o)}}e.Container=n,a.Factory.addComponentsGetterSetter(n,"clip",["x","y","width","height"]),a.Factory.addGetterSetter(n,"clipX",void 0,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(n,"clipY",void 0,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(n,"clipWidth",void 0,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(n,"clipHeight",void 0,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(n,"clipFunc")},3902:function(t,e,i){i(560),Object.defineProperty(e,"__esModule",{value:!0}),e.HitContext=e.SceneContext=e.Context=void 0;const a=i(8007),r=i(3552);function s(t){var e,i,r=[],s=t.length,n=a.Util;for(e=0;e<s;e++)i=t[e],n._isNumber(i)?i=Math.round(1e3*i)/1e3:n._isString(i)||(i+=""),r.push(i);return r}var n=",",o="(",l=")",h="([",d="])",c=";",u="()",p="=",g=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],m=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"];const f=100;class v{constructor(t){this.canvas=t,r.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,e){var i,r,s,g,m=this.traceArr,f=m.length,v="";for(i=0;i<f;i++)r=m[i],s=r.method,s?(g=r.args,v+=s,t?v+=u:a.Util._isArray(g[0])?v+=h+g.join(n)+d:(e&&(g=g.map((t=>"number"===typeof t?Math.floor(t):t))),v+=o+g.join(n)+l)):(v+=r.property,t||(v+=p+r.val)),v+=c;return v}clearTrace(){this.traceArr=[]}_trace(t){var e,i=this.traceArr;i.push(t),e=i.length,e>=f&&i.shift()}reset(){var t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){var e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth()/e.pixelRatio,e.getHeight()/e.pixelRatio)}_applyLineCap(t){const e=t.attrs.lineCap;e&&this.setAttr("lineCap",e)}_applyOpacity(t){var e=t.getAbsoluteOpacity();1!==e&&this.setAttr("globalAlpha",e)}_applyLineJoin(t){const e=t.attrs.lineJoin;e&&this.setAttr("lineJoin",e)}setAttr(t,e){this._context[t]=e}arc(t,e,i,a,r,s){this._context.arc(t,e,i,a,r,s)}arcTo(t,e,i,a,r){this._context.arcTo(t,e,i,a,r)}beginPath(){this._context.beginPath()}bezierCurveTo(t,e,i,a,r,s){this._context.bezierCurveTo(t,e,i,a,r,s)}clearRect(t,e,i,a){this._context.clearRect(t,e,i,a)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,e){var i=arguments;return 2===i.length?this._context.createImageData(t,e):1===i.length?this._context.createImageData(t):void 0}createLinearGradient(t,e,i,a){return this._context.createLinearGradient(t,e,i,a)}createPattern(t,e){return this._context.createPattern(t,e)}createRadialGradient(t,e,i,a,r,s){return this._context.createRadialGradient(t,e,i,a,r,s)}drawImage(t,e,i,a,r,s,n,o,l){var h=arguments,d=this._context;3===h.length?d.drawImage(t,e,i):5===h.length?d.drawImage(t,e,i,a,r):9===h.length&&d.drawImage(t,e,i,a,r,s,n,o,l)}ellipse(t,e,i,a,r,s,n,o){this._context.ellipse(t,e,i,a,r,s,n,o)}isPointInPath(t,e,i,a){return i?this._context.isPointInPath(i,t,e,a):this._context.isPointInPath(t,e,a)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,e,i,a){this._context.fillRect(t,e,i,a)}strokeRect(t,e,i,a){this._context.strokeRect(t,e,i,a)}fillText(t,e,i,a){a?this._context.fillText(t,e,i,a):this._context.fillText(t,e,i)}measureText(t){return this._context.measureText(t)}getImageData(t,e,i,a){return this._context.getImageData(t,e,i,a)}lineTo(t,e){this._context.lineTo(t,e)}moveTo(t,e){this._context.moveTo(t,e)}rect(t,e,i,a){this._context.rect(t,e,i,a)}roundRect(t,e,i,a,r){this._context.roundRect(t,e,i,a,r)}putImageData(t,e,i){this._context.putImageData(t,e,i)}quadraticCurveTo(t,e,i,a){this._context.quadraticCurveTo(t,e,i,a)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,e){this._context.scale(t,e)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context["mozDash"]=t:"webkitLineDash"in this._context&&(this._context["webkitLineDash"]=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,e,i,a,r,s){this._context.setTransform(t,e,i,a,r,s)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,e,i,a){this._context.strokeText(t,e,i,a)}transform(t,e,i,a,r,s){this._context.transform(t,e,i,a,r,s)}translate(t,e){this._context.translate(t,e)}_enableTrace(){var t,e,i=this,a=g.length,r=this.setAttr,n=function(t){var a,r=i[t];i[t]=function(){return e=s(Array.prototype.slice.call(arguments,0)),a=r.apply(i,arguments),i._trace({method:t,args:e}),a}};for(t=0;t<a;t++)n(g[t]);i.setAttr=function(){r.apply(i,arguments);var t=arguments[0],e=arguments[1];"shadowOffsetX"!==t&&"shadowOffsetY"!==t&&"shadowBlur"!==t||(e/=this.canvas.getPixelRatio()),i._trace({property:t,val:e})}}_applyGlobalCompositeOperation(t){const e=t.attrs.globalCompositeOperation;var i=!e||"source-over"===e;i||this.setAttr("globalCompositeOperation",e)}}e.Context=v,m.forEach((function(t){Object.defineProperty(v.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})}));class y extends v{constructor(t,{willReadFrequently:e=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:e})}_fillColor(t){var e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){var e=t._getLinearGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fillRadialGradient(t){const e=t._getRadialGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fill(t){const e=t.fill(),i=t.getFillPriority();if(e&&"color"===i)return void this._fillColor(t);const a=t.getFillPatternImage();if(a&&"pattern"===i)return void this._fillPattern(t);const r=t.getFillLinearGradientColorStops();if(r&&"linear-gradient"===i)return void this._fillLinearGradient(t);const s=t.getFillRadialGradientColorStops();s&&"radial-gradient"===i?this._fillRadialGradient(t):e?this._fillColor(t):a?this._fillPattern(t):r?this._fillLinearGradient(t):s&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const e=t.getStrokeLinearGradientStartPoint(),i=t.getStrokeLinearGradientEndPoint(),a=t.getStrokeLinearGradientColorStops(),r=this.createLinearGradient(e.x,e.y,i.x,i.y);if(a){for(var s=0;s<a.length;s+=2)r.addColorStop(a[s],a[s+1]);this.setAttr("strokeStyle",r)}}_stroke(t){var e=t.dash(),i=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!i){this.save();var a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(t),e&&t.dashEnabled()&&(this.setLineDash(e),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)");var r=t.getStrokeLinearGradientColorStops();r?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),i||this.restore()}}_applyShadow(t){var e,i,a,r=null!==(e=t.getShadowRGBA())&&void 0!==e?e:"black",s=null!==(i=t.getShadowBlur())&&void 0!==i?i:5,n=null!==(a=t.getShadowOffset())&&void 0!==a?a:{x:0,y:0},o=t.getAbsoluteScale(),l=this.canvas.getPixelRatio(),h=o.x*l,d=o.y*l;this.setAttr("shadowColor",r),this.setAttr("shadowBlur",s*Math.min(Math.abs(h),Math.abs(d))),this.setAttr("shadowOffsetX",n.x*h),this.setAttr("shadowOffsetY",n.y*d)}}e.SceneContext=y;class b extends v{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const r=t.getStrokeScaleEnabled();if(!r){this.save();var e=this.getCanvas().getPixelRatio();this.setTransform(e,0,0,e,0,0)}this._applyLineCap(t);var i=t.hitStrokeWidth(),a="auto"===i?t.strokeWidth():i;this.setAttr("lineWidth",a),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),r||this.restore()}}}e.HitContext=b},2448:function(t,e,i){i(560),Object.defineProperty(e,"__esModule",{value:!0}),e.DD=void 0;const a=i(3552),r=i(8007);e.DD={get isDragging(){var t=!1;return e.DD._dragElements.forEach((e=>{"dragging"===e.dragStatus&&(t=!0)})),t},justDragged:!1,get node(){var t;return e.DD._dragElements.forEach((e=>{t=e.node})),t},_dragElements:new Map,_drag(t){const i=[];e.DD._dragElements.forEach(((e,a)=>{const{node:s}=e,n=s.getStage();n.setPointersPositions(t),void 0===e.pointerId&&(e.pointerId=r.Util._getFirstPointerId(t));const o=n._changedPointerPositions.find((t=>t.id===e.pointerId));if(o){if("dragging"!==e.dragStatus){var l=s.dragDistance(),h=Math.max(Math.abs(o.x-e.startPointerPos.x),Math.abs(o.y-e.startPointerPos.y));if(h<l)return;if(s.startDrag({evt:t}),!s.isDragging())return}s._setDragPosition(t,e),i.push(s)}})),i.forEach((e=>{e.fire("dragmove",{type:"dragmove",target:e,evt:t},!0)}))},_endDragBefore(t){const i=[];e.DD._dragElements.forEach((r=>{const{node:s}=r,n=s.getStage();t&&n.setPointersPositions(t);const o=n._changedPointerPositions.find((t=>t.id===r.pointerId));if(!o)return;"dragging"!==r.dragStatus&&"stopped"!==r.dragStatus||(e.DD.justDragged=!0,a.Konva._mouseListenClick=!1,a.Konva._touchListenClick=!1,a.Konva._pointerListenClick=!1,r.dragStatus="stopped");const l=r.node.getLayer()||r.node instanceof a.Konva["Stage"]&&r.node;l&&-1===i.indexOf(l)&&i.push(l)})),i.forEach((t=>{t.draw()}))},_endDragAfter(t){e.DD._dragElements.forEach(((i,a)=>{"stopped"===i.dragStatus&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:t},!0),"dragging"!==i.dragStatus&&e.DD._dragElements.delete(a)}))}},a.Konva.isBrowser&&(window.addEventListener("mouseup",e.DD._endDragBefore,!0),window.addEventListener("touchend",e.DD._endDragBefore,!0),window.addEventListener("mousemove",e.DD._drag),window.addEventListener("touchmove",e.DD._drag),window.addEventListener("mouseup",e.DD._endDragAfter,!1),window.addEventListener("touchend",e.DD._endDragAfter,!1))},9658:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Factory=void 0;const a=i(8007),r=i(7723);var s="get",n="set";e.Factory={addGetterSetter(t,i,a,r,s){e.Factory.addGetter(t,i,a),e.Factory.addSetter(t,i,r,s),e.Factory.addOverloadedGetterSetter(t,i)},addGetter(t,e,i){var r=s+a.Util._capitalize(e);t.prototype[r]=t.prototype[r]||function(){var t=this.attrs[e];return void 0===t?i:t}},addSetter(t,i,r,s){var o=n+a.Util._capitalize(i);t.prototype[o]||e.Factory.overWriteSetter(t,i,r,s)},overWriteSetter(t,e,i,r){var s=n+a.Util._capitalize(e);t.prototype[s]=function(t){return i&&void 0!==t&&null!==t&&(t=i.call(this,t,e)),this._setAttr(e,t),r&&r.call(this),this}},addComponentsGetterSetter(t,i,o,l,h){var d,c,u=o.length,p=a.Util._capitalize,g=s+p(i),m=n+p(i);t.prototype[g]=function(){var t={};for(d=0;d<u;d++)c=o[d],t[c]=this.getAttr(i+p(c));return t};var f=(0,r.getComponentValidator)(o);t.prototype[m]=function(t){var e,a=this.attrs[i];for(e in l&&(t=l.call(this,t)),f&&f.call(this,t,i),t)t.hasOwnProperty(e)&&this._setAttr(i+p(e),t[e]);return t||o.forEach((t=>{this._setAttr(i+p(t),void 0)})),this._fireChangeEvent(i,a,t),h&&h.call(this),this},e.Factory.addOverloadedGetterSetter(t,i)},addOverloadedGetterSetter(t,e){var i=a.Util._capitalize(e),r=n+i,o=s+i;t.prototype[e]=function(){return arguments.length?(this[r](arguments[0]),this):this[o]()}},addDeprecatedGetterSetter(t,i,r,n){a.Util.error("Adding deprecated "+i);var o=s+a.Util._capitalize(i),l=i+" property is deprecated and will be removed soon. Look at Konva change log for more information.";t.prototype[o]=function(){a.Util.error(l);var t=this.attrs[i];return void 0===t?r:t},e.Factory.addSetter(t,i,n,(function(){a.Util.error(l)})),e.Factory.addOverloadedGetterSetter(t,i)},backCompat(t,e){a.Util.each(e,(function(e,i){var r=t.prototype[i],o=s+a.Util._capitalize(e),l=n+a.Util._capitalize(e);function h(){r.apply(this,arguments),a.Util.error('"'+e+'" method is deprecated and will be removed soon. Use ""'+i+'" instead.')}t.prototype[e]=h,t.prototype[o]=h,t.prototype[l]=h}))},afterSetFilter(){this._filterUpToDate=!1}}},1503:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.FastLayer=void 0;const a=i(8007),r=i(5783),s=i(3552);class n extends r.Layer{constructor(t){super(t),this.listening(!1),a.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}e.FastLayer=n,n.prototype.nodeType="FastLayer",(0,s._registerNode)(n)},3552:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e._registerNode=e.Konva=e.glob=void 0;const a=Math.PI/180;function r(){return"undefined"!==typeof window&&("[object Window]"==={}.toString.call(window)||"[object global]"==={}.toString.call(window))}e.glob="undefined"!==typeof i.g?i.g:"undefined"!==typeof window?window:"undefined"!==typeof WorkerGlobalScope?self:{},e.Konva={_global:e.glob,version:"9.3.14",isBrowser:r(),isUnminified:/param/.test(function(t){}.toString()),dblClickWindow:400,getAngle(t){return e.Konva.angleDeg?t*a:t},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:"undefined"!==typeof window&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return e.Konva["DD"].isDragging},isTransforming(){var t;return null===(t=e.Konva["Transformer"])||void 0===t?void 0:t.isTransforming()},isDragReady(){return!!e.Konva["DD"].node},releaseCanvasOnDestroy:!0,document:e.glob.document,_injectGlobal(t){e.glob.Konva=t}};const s=t=>{e.Konva[t.prototype.getClassName()]=t};e._registerNode=s,e.Konva._injectGlobal(e.Konva)},1763:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Group=void 0;const a=i(8007),r=i(7867),s=i(3552);class n extends r.Container{_validateAdd(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&a.Util.throw("You may only add groups and shapes to groups.")}}e.Group=n,n.prototype.nodeType="Group",(0,s._registerNode)(n)},5783:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Layer=void 0;const a=i(8007),r=i(7867),s=i(6205),n=i(9658),o=i(7383),l=i(7723),h=i(4718),d=i(3552);var c="#",u="beforeDraw",p="draw",g=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],m=g.length;class f extends r.Container{constructor(t){super(t),this.canvas=new o.SceneCanvas,this.hitCanvas=new o.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){const t=this.canvas._canvas;return t.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);var e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),t<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[t+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){s.Node.prototype.moveToTop.call(this);var t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){var t=s.Node.prototype.moveUp.call(this);if(!t)return!1;var e=this.getStage();return!(!e||!e.content)&&(e.content.removeChild(this.getNativeCanvasElement()),this.index<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[this.index+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(s.Node.prototype.moveDown.call(this)){var t=this.getStage();if(t){var e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(s.Node.prototype.moveToBottom.call(this)){var t=this.getStage();if(t){var e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){var t=this.getNativeCanvasElement();return s.Node.prototype.remove.call(this),t&&t.parentNode&&a.Util._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:e}){return this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e),this._setSmoothEnabled(),this}_validateAdd(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&a.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t=t||{},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=void 0!==t.x?t.x:this.x(),t.y=void 0!==t.y?t.y:this.y(),s.Node.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){const t=this.visible();this.canvas._canvas.style.display=t?"block":"none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){a.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){a.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,a.Util.requestAnimFrame((()=>{this.draw(),this._waitingForDraw=!1}))),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;var e=1,i=!1;while(1){for(let a=0;a<m;a++){const r=g[a],s=this._getIntersection({x:t.x+r.x*e,y:t.y+r.y*e}),n=s.shape;if(n)return n;if(i=!!s.antialiased,!s.antialiased)break}if(!i)return null;e+=1}}_getIntersection(t){const e=this.hitCanvas.pixelRatio,i=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,r=i[3];if(255===r){const t=a.Util._rgbToHex(i[0],i[1],i[2]),e=h.shapes[c+t];return e?{shape:e}:{antialiased:!0}}return r>0?{antialiased:!0}:{}}drawScene(t,e){var i=this.getLayer(),a=t||i&&i.getCanvas();return this._fire(u,{node:this}),this.clearBeforeDraw()&&a.getContext().clear(),r.Container.prototype.drawScene.call(this,a,e),this._fire(p,{node:this}),this}drawHit(t,e){var i=this.getLayer(),a=t||i&&i.hitCanvas;return i&&i.clearBeforeDraw()&&i.getHitCanvas().getContext().clear(),r.Container.prototype.drawHit.call(this,a,e),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){a.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return a.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(this.parent&&this.parent["content"]){var t=this.parent,e=!!this.hitCanvas._canvas.parentNode;e?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}}destroy(){return a.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}e.Layer=f,f.prototype.nodeType="Layer",(0,d._registerNode)(f),n.Factory.addGetterSetter(f,"imageSmoothingEnabled",!0),n.Factory.addGetterSetter(f,"clearBeforeDraw",!0),n.Factory.addGetterSetter(f,"hitGraphEnabled",!0,(0,l.getBooleanValidator)())},6205:function(t,e,i){i(560),Object.defineProperty(e,"__esModule",{value:!0}),e.Node=void 0;const a=i(8007),r=i(9658),s=i(7383),n=i(3552),o=i(2448),l=i(7723);var h="absoluteOpacity",d="allEventListeners",c="absoluteTransform",u="absoluteScale",p="canvas",g="Change",m="children",f="konva",v="listening",y="mouseenter",b="mouseleave",_="set",w="Shape",C=" ",A="stage",S="transform",x="Stage",k="visible",L=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(C);let E=1;class M{constructor(t){this._id=E++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){t!==S&&t!==c||!this._cache.get(t)?t?this._cache.delete(t):this._cache.clear():this._cache.get(t).dirty=!0}_getCache(t,e){var i=this._cache.get(t),a=t===S||t===c,r=void 0===i||a&&!0===i.dirty;return r&&(i=e.call(this),this._cache.set(t,i)),i}_calculate(t,e,i){if(!this._attachedDepsListeners.get(t)){const i=e.map((t=>t+"Change.konva")).join(C);this.on(i,(()=>{this._clearCache(t)})),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,i)}_getCanvasCache(){return this._cache.get(p)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===c&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(p)){const{scene:t,filter:e,hit:i}=this._cache.get(p);a.Util.releaseCanvas(t,e,i),this._cache.delete(p)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){var e=t||{},i={};void 0!==e.x&&void 0!==e.y&&void 0!==e.width&&void 0!==e.height||(i=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));var r=Math.ceil(e.width||i.width),n=Math.ceil(e.height||i.height),o=e.pixelRatio,l=void 0===e.x?Math.floor(i.x):e.x,d=void 0===e.y?Math.floor(i.y):e.y,c=e.offset||0,g=e.drawBorder||!1,m=e.hitCanvasPixelRatio||1;if(!r||!n)return void a.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");const f=Math.abs(Math.round(i.x)-l)>.5?1:0,v=Math.abs(Math.round(i.y)-d)>.5?1:0;r+=2*c+f,n+=2*c+v,l-=c,d-=c;var y=new s.SceneCanvas({pixelRatio:o,width:r,height:n}),b=new s.SceneCanvas({pixelRatio:o,width:0,height:0,willReadFrequently:!0}),_=new s.HitCanvas({pixelRatio:m,width:r,height:n}),w=y.getContext(),C=_.getContext();return _.isCache=!0,y.isCache=!0,this._cache.delete(p),this._filterUpToDate=!1,!1===e.imageSmoothingEnabled&&(y.getContext()._context.imageSmoothingEnabled=!1,b.getContext()._context.imageSmoothingEnabled=!1),w.save(),C.save(),w.translate(-l,-d),C.translate(-l,-d),this._isUnderCache=!0,this._clearSelfAndDescendantCache(h),this._clearSelfAndDescendantCache(u),this.drawScene(y,this),this.drawHit(_,this),this._isUnderCache=!1,w.restore(),C.restore(),g&&(w.save(),w.beginPath(),w.rect(0,0,r,n),w.closePath(),w.setAttr("strokeStyle","red"),w.setAttr("lineWidth",5),w.stroke(),w.restore()),this._cache.set(p,{scene:y,filter:b,hit:_,x:l,y:d}),this._requestDraw(),this}isCached(){return this._cache.has(p)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,e){var i=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],a=1/0,r=1/0,s=-1/0,n=-1/0,o=this.getAbsoluteTransform(e);return i.forEach((function(t){var e=o.point(t);void 0===a&&(a=s=e.x,r=n=e.y),a=Math.min(a,e.x),r=Math.min(r,e.y),s=Math.max(s,e.x),n=Math.max(n,e.y)})),{x:a,y:r,width:s-a,height:n-r}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const e=this._getCanvasCache();t.translate(e.x,e.y);var i=this._getCachedSceneCanvas(),a=i.pixelRatio;t.drawImage(i._canvas,0,0,i.width/a,i.height/a),t.restore()}_drawCachedHitCanvas(t){var e=this._getCanvasCache(),i=e.hit;t.save(),t.translate(e.x,e.y),t.drawImage(i._canvas,0,0,i.width/i.pixelRatio,i.height/i.pixelRatio),t.restore()}_getCachedSceneCanvas(){var t,e,i,r,s=this.filters(),n=this._getCanvasCache(),o=n.scene,l=n.filter,h=l.getContext();if(s){if(!this._filterUpToDate){var d=o.pixelRatio;l.setSize(o.width/o.pixelRatio,o.height/o.pixelRatio);try{for(t=s.length,h.clear(),h.drawImage(o._canvas,0,0,o.getWidth()/d,o.getHeight()/d),e=h.getImageData(0,0,l.getWidth(),l.getHeight()),i=0;i<t;i++)r=s[i],"function"===typeof r?(r.call(this,e),h.putImageData(e,0,0)):a.Util.error("Filter should be type of function, but got "+typeof r+" instead. Please check correct filters")}catch(c){a.Util.error("Unable to apply filter. "+c.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return l}return o}on(t,e){if(this._cache&&this._cache.delete(d),3===arguments.length)return this._delegate.apply(this,arguments);var i,a,r,s,n,o=t.split(C),l=o.length;for(i=0;i<l;i++)a=o[i],r=a.split("."),s=r[0],n=r[1]||"",this.eventListeners[s]||(this.eventListeners[s]=[]),this.eventListeners[s].push({name:n,handler:e});return this}off(t,e){var i,a,r,s,n,o,l=(t||"").split(C),h=l.length;if(this._cache&&this._cache.delete(d),!t)for(a in this.eventListeners)this._off(a);for(i=0;i<h;i++)if(r=l[i],s=r.split("."),n=s[0],o=s[1],n)this.eventListeners[n]&&this._off(n,o,e);else for(a in this.eventListeners)this._off(a,o,e);return this}dispatchEvent(t){var e={target:this,type:t.type,evt:t};return this.fire(t.type,e),this}addEventListener(t,e){return this.on(t,(function(t){e.call(this,t.evt)})),this}removeEventListener(t){return this.off(t),this}_delegate(t,e,i){var r=this;this.on(t,(function(t){for(var s=t.target.findAncestors(e,!0,r),n=0;n<s.length;n++)t=a.Util.cloneObject(t),t.currentTarget=s[n],i.call(s[n],t)}))}remove(){return this.isDragging()&&this.stopDrag(),o.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(h),this._clearSelfAndDescendantCache(u),this._clearSelfAndDescendantCache(A),this._clearSelfAndDescendantCache(k),this._clearSelfAndDescendantCache(v)}_remove(){this._clearCaches();var t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){var e="get"+a.Util._capitalize(t);return a.Util._isFunction(this[e])?this[e]():this.attrs[t]}getAncestors(){var t=this.getParent(),e=[];while(t)e.push(t),t=t.getParent();return e}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges((()=>{var e,i;if(!t)return this;for(e in t)e!==m&&(i=_+a.Util._capitalize(e),a.Util._isFunction(this[i])?this[i](t[e]):this._setAttr(e,t[e]))})),this}isListening(){return this._getCache(v,this._isListening)}_isListening(t){const e=this.listening();if(!e)return!1;const i=this.getParent();return!i||i===t||this===t||i._isListening(t)}isVisible(){return this._getCache(k,this._isVisible)}_isVisible(t){const e=this.visible();if(!e)return!1;const i=this.getParent();return!i||i===t||this===t||i._isVisible(t)}shouldDrawHit(t,e=!1){if(t)return this._isVisible(t)&&this._isListening(t);var i=this.getLayer(),a=!1;o.DD._dragElements.forEach((t=>{"dragging"===t.dragStatus&&("Stage"===t.node.nodeType||t.node.getLayer()===i)&&(a=!0)}));var r=!e&&!n.Konva.hitOnDragEnabled&&(a||n.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!r}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){var t,e,i,a,r=this.getDepth(),s=this,n=0;function o(l){for(t=[],e=l.length,i=0;i<e;i++)a=l[i],n++,a.nodeType!==w&&(t=t.concat(a.getChildren().slice())),a._id===s._id&&(i=e);t.length>0&&t[0].getDepth()<=r&&o(t)}const l=this.getStage();return s.nodeType!==x&&l&&o(l.getChildren()),n}getDepth(){var t=0,e=this.parent;while(e)t++,e=e.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(S),this._clearSelfAndDescendantCache(c)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges((()=>{this.x(t.x),this.y(t.y)})),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;var e=t.getPointerPosition();if(!e)return null;var i=this.getAbsoluteTransform().copy();return i.invert(),i.point(e)}getAbsolutePosition(t){let e=!1,i=this.parent;while(i){if(i.isCached()){e=!0;break}i=i.parent}e&&!t&&(t=!0);var r=this.getAbsoluteTransform(t).getMatrix(),s=new a.Transform,n=this.offset();return s.m=r.slice(),s.translate(n.x,n.y),s.getTranslation()}setAbsolutePosition(t){const{x:e,y:i,...a}=this._clearTransform();this.attrs.x=e,this.attrs.y=i,this._clearCache(S);var r=this._getAbsoluteTransform().copy();return r.invert(),r.translate(t.x,t.y),t={x:this.attrs.x+r.getTranslation().x,y:this.attrs.y+r.getTranslation().y},this._setTransform(a),this.setPosition({x:t.x,y:t.y}),this._clearCache(S),this._clearSelfAndDescendantCache(c),this}_setTransform(t){var e;for(e in t)this.attrs[e]=t[e]}_clearTransform(){var t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){var e=t.x,i=t.y,a=this.x(),r=this.y();return void 0!==e&&(a+=e),void 0!==i&&(r+=i),this.setPosition({x:a,y:r}),this}_eachAncestorReverse(t,e){var i,a,r=[],s=this.getParent();if(!e||e._id!==this._id){r.unshift(this);while(s&&(!e||s._id!==e._id))r.unshift(s),s=s.parent;for(i=r.length,a=0;a<i;a++)t(r[a])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return a.Util.warn("Node has no parent. moveToTop function is ignored."),!1;var t=this.index,e=this.parent.getChildren().length;return t<e-1&&(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0)}moveUp(){if(!this.parent)return a.Util.warn("Node has no parent. moveUp function is ignored."),!1;var t=this.index,e=this.parent.getChildren().length;return t<e-1&&(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0)}moveDown(){if(!this.parent)return a.Util.warn("Node has no parent. moveDown function is ignored."),!1;var t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0)}moveToBottom(){if(!this.parent)return a.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;var t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0)}setZIndex(t){if(!this.parent)return a.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&a.Util.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var e=this.index;return this.parent.children.splice(e,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(h,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){var t=this.opacity(),e=this.getParent();return e&&!e._isUnderCache&&(t*=e.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){var t,e,i,r,s,n=this.getAttrs();const o={attrs:{},className:this.getClassName()};for(t in n)e=n[t],s=a.Util.isObject(e)&&!a.Util._isPlainObject(e)&&!a.Util._isArray(e),s||(i="function"===typeof this[t]&&this[t],delete n[t],r=i?i.call(this):null,n[t]=e,r!==e&&(o.attrs[t]=e));return a.Util._prepareToStringify(o)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,e,i){var a=[];e&&this._isMatch(t)&&a.push(this);var r=this.parent;while(r){if(r===i)return a;r._isMatch(t)&&a.push(r),r=r.parent}return a}isAncestorOf(t){return!1}findAncestor(t,e,i){return this.findAncestors(t,e,i)[0]}_isMatch(t){if(!t)return!1;if("function"===typeof t)return t(this);var e,i,r=t.replace(/ /g,"").split(","),s=r.length;for(e=0;e<s;e++)if(i=r[e],a.Util.isValidSelector(i)||(a.Util.warn('Selector "'+i+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),a.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),a.Util.warn("Konva is awesome, right?")),"#"===i.charAt(0)){if(this.id()===i.slice(1))return!0}else if("."===i.charAt(0)){if(this.hasName(i.slice(1)))return!0}else if(this.className===i||this.nodeType===i)return!0;return!1}getLayer(){var t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(A,this._getStage)}_getStage(){var t=this.getParent();return t?t.getStage():null}fire(t,e={},i){return e.target=e.target||this,i?this._fireAndBubble(t,e):this._fire(t,e),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(c,this._getAbsoluteTransform)}_getAbsoluteTransform(t){var e;if(t)return e=new a.Transform,this._eachAncestorReverse((function(t){var i=t.transformsEnabled();"all"===i?e.multiply(t.getTransform()):"position"===i&&e.translate(t.x()-t.offsetX(),t.y()-t.offsetY())}),t),e;e=this._cache.get(c)||new a.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(e):e.reset();var i=this.transformsEnabled();if("all"===i)e.multiply(this.getTransform());else if("position"===i){const t=this.attrs.x||0,i=this.attrs.y||0,a=this.attrs.offsetX||0,r=this.attrs.offsetY||0;e.translate(t-a,i-r)}return e.dirty=!1,e}getAbsoluteScale(t){var e=this;while(e)e._isUnderCache&&(t=e),e=e.getParent();const i=this.getAbsoluteTransform(t),a=i.decompose();return{x:a.scaleX,y:a.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(S,this._getTransform)}_getTransform(){var t,e,i=this._cache.get(S)||new a.Transform;i.reset();var r=this.x(),s=this.y(),o=n.Konva.getAngle(this.rotation()),l=null!==(t=this.attrs.scaleX)&&void 0!==t?t:1,h=null!==(e=this.attrs.scaleY)&&void 0!==e?e:1,d=this.attrs.skewX||0,c=this.attrs.skewY||0,u=this.attrs.offsetX||0,p=this.attrs.offsetY||0;return 0===r&&0===s||i.translate(r,s),0!==o&&i.rotate(o),0===d&&0===c||i.skew(d,c),1===l&&1===h||i.scale(l,h),0===u&&0===p||i.translate(-1*u,-1*p),i.dirty=!1,i}clone(t){var e,i,r,s,n,o=a.Util.cloneObject(this.attrs);for(e in t)o[e]=t[e];var l=new this.constructor(o);for(e in this.eventListeners)for(i=this.eventListeners[e],r=i.length,s=0;s<r;s++)n=i[s],n.name.indexOf(f)<0&&(l.eventListeners[e]||(l.eventListeners[e]=[]),l.eventListeners[e].push(n));return l}_toKonvaCanvas(t){t=t||{};var e=this.getClientRect(),i=this.getStage(),a=void 0!==t.x?t.x:Math.floor(e.x),r=void 0!==t.y?t.y:Math.floor(e.y),n=t.pixelRatio||1,o=new s.SceneCanvas({width:t.width||Math.ceil(e.width)||(i?i.width():0),height:t.height||Math.ceil(e.height)||(i?i.height():0),pixelRatio:n}),l=o.getContext();const h=new s.SceneCanvas({width:o.width/o.pixelRatio+Math.abs(a),height:o.height/o.pixelRatio+Math.abs(r),pixelRatio:o.pixelRatio});return!1===t.imageSmoothingEnabled&&(l._context.imageSmoothingEnabled=!1),l.save(),(a||r)&&l.translate(-1*a,-1*r),this.drawScene(o,void 0,h),l.restore(),o}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};var e=t.mimeType||null,i=t.quality||null,a=this._toKonvaCanvas(t).toDataURL(e,i);return t.callback&&t.callback(a),a}toImage(t){return new Promise(((e,i)=>{try{const i=null===t||void 0===t?void 0:t.callback;i&&delete t.callback,a.Util._urlToImage(this.toDataURL(t),(function(t){e(t),null===i||void 0===i||i(t)}))}catch(r){i(r)}}))}toBlob(t){return new Promise(((e,i)=>{try{const i=null===t||void 0===t?void 0:t.callback;i&&delete t.callback,this.toCanvas(t).toBlob((t=>{e(t),null===i||void 0===i||i(t)}),null===t||void 0===t?void 0:t.mimeType,null===t||void 0===t?void 0:t.quality)}catch(a){i(a)}}))}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return void 0!==this.attrs.dragDistance?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():n.Konva.dragDistance}_off(t,e,i){var a,r,s,n=this.eventListeners[t];for(a=0;a<n.length;a++)if(r=n[a].name,s=n[a].handler,("konva"!==r||"konva"===e)&&(!e||r===e)&&(!i||i===s)){if(n.splice(a,1),0===n.length){delete this.eventListeners[t];break}a--}}_fireChangeEvent(t,e,i){this._fire(t+g,{oldVal:e,newVal:i})}addName(t){if(!this.hasName(t)){var e=this.name(),i=e?e+" "+t:t;this.name(i)}return this}hasName(t){if(!t)return!1;const e=this.name();if(!e)return!1;var i=(e||"").split(/\s/g);return-1!==i.indexOf(t)}removeName(t){var e=(this.name()||"").split(/\s/g),i=e.indexOf(t);return-1!==i&&(e.splice(i,1),this.name(e.join(" "))),this}setAttr(t,e){var i=this[_+a.Util._capitalize(t)];return a.Util._isFunction(i)?i.call(this,e):this._setAttr(t,e),this}_requestDraw(){if(n.Konva.autoDrawEnabled){const t=this.getLayer()||this.getStage();null===t||void 0===t||t.batchDraw()}}_setAttr(t,e){var i=this.attrs[t];(i!==e||a.Util.isObject(e))&&(void 0===e||null===e?delete this.attrs[t]:this.attrs[t]=e,this._shouldFireChangeEvents&&this._fireChangeEvent(t,i,e),this._requestDraw())}_setComponentAttr(t,e,i){var a;void 0!==i&&(a=this.attrs[t],a||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=i,this._fireChangeEvent(t,a,i))}_fireAndBubble(t,e,i){e&&this.nodeType===w&&(e.target=this);var a=(t===y||t===b)&&(i&&(this===i||this.isAncestorOf&&this.isAncestorOf(i))||"Stage"===this.nodeType&&!i);if(!a){this._fire(t,e);var r=(t===y||t===b)&&i&&i.isAncestorOf&&i.isAncestorOf(this)&&!i.isAncestorOf(this.parent);(e&&!e.cancelBubble||!e)&&this.parent&&this.parent.isListening()&&!r&&(i&&i.parent?this._fireAndBubble.call(this.parent,t,e,i):this._fireAndBubble.call(this.parent,t,e))}}_getProtoListeners(t){var e,i,a;const r=null!==(e=this._cache.get(d))&&void 0!==e?e:{};let s=null===r||void 0===r?void 0:r[t];if(void 0===s){s=[];let e=Object.getPrototypeOf(this);while(e){const r=null!==(a=null===(i=e.eventListeners)||void 0===i?void 0:i[t])&&void 0!==a?a:[];s.push(...r),e=Object.getPrototypeOf(e)}r[t]=s,this._cache.set(d,r)}return s}_fire(t,e){e=e||{},e.currentTarget=this,e.type=t;const i=this._getProtoListeners(t);if(i)for(var a=0;a<i.length;a++)i[a].handler.call(this,e);const r=this.eventListeners[t];if(r)for(a=0;a<r.length;a++)r[a].handler.call(this,e)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){var e=t?t.pointerId:void 0,i=this.getStage(),a=this.getAbsolutePosition();if(i){var r=i._getPointerById(e)||i._changedPointerPositions[0]||a;o.DD._dragElements.set(this._id,{node:this,startPointerPos:r,offset:{x:r.x-a.x,y:r.y-a.y},dragStatus:"ready",pointerId:e})}}startDrag(t,e=!0){o.DD._dragElements.has(this._id)||this._createDragElement(t);const i=o.DD._dragElements.get(this._id);i.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},e)}_setDragPosition(t,e){const i=this.getStage()._getPointerById(e.pointerId);if(i){var r={x:i.x-e.offset.x,y:i.y-e.offset.y},s=this.dragBoundFunc();if(void 0!==s){const e=s.call(this,r,t);e?r=e:a.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}this._lastPos&&this._lastPos.x===r.x&&this._lastPos.y===r.y||(this.setAbsolutePosition(r),this._requestDraw()),this._lastPos=r}}stopDrag(t){const e=o.DD._dragElements.get(this._id);e&&(e.dragStatus="stopped"),o.DD._endDragBefore(t),o.DD._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=o.DD._dragElements.get(this._id);return!!t&&"dragging"===t.dragStatus}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",(function(t){var e=void 0!==t.evt["button"],i=!e||n.Konva.dragButtons.indexOf(t.evt["button"])>=0;if(i&&!this.isDragging()){var a=!1;o.DD._dragElements.forEach((t=>{this.isAncestorOf(t.node)&&(a=!0)})),a||this._createDragElement(t)}}))}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var t=this.getStage();if(!t)return;const e=o.DD._dragElements.get(this._id),i=e&&"dragging"===e.dragStatus,a=e&&"ready"===e.dragStatus;i?this.stopDrag():a&&o.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const e=this.getStage();if(!e)return!1;const i={x:-t.x,y:-t.y,width:e.width()+2*t.x,height:e.height()+2*t.y};return a.Util.haveIntersection(i,this.getClientRect())}static create(t,e){return a.Util._isString(t)&&(t=JSON.parse(t)),this._createNode(t,e)}static _createNode(t,e){var i,r,s,o=M.prototype.getClassName.call(t),l=t.children;e&&(t.attrs.container=e),n.Konva[o]||(a.Util.warn('Can not find a node with class name "'+o+'". Fallback to "Shape".'),o="Shape");const h=n.Konva[o];if(i=new h(t.attrs),l)for(r=l.length,s=0;s<r;s++)i.add(M._createNode(l[s]));return i}}e.Node=M,M.prototype.nodeType="Node",M.prototype._attrsAffectingSize=[],M.prototype.eventListeners={},M.prototype.on.call(M.prototype,L,(function(){this._batchingTransformChange?this._needClearTransformCache=!0:(this._clearCache(S),this._clearSelfAndDescendantCache(c))})),M.prototype.on.call(M.prototype,"visibleChange.konva",(function(){this._clearSelfAndDescendantCache(k)})),M.prototype.on.call(M.prototype,"listeningChange.konva",(function(){this._clearSelfAndDescendantCache(v)})),M.prototype.on.call(M.prototype,"opacityChange.konva",(function(){this._clearSelfAndDescendantCache(h)}));const T=r.Factory.addGetterSetter;T(M,"zIndex"),T(M,"absolutePosition"),T(M,"position"),T(M,"x",0,(0,l.getNumberValidator)()),T(M,"y",0,(0,l.getNumberValidator)()),T(M,"globalCompositeOperation","source-over",(0,l.getStringValidator)()),T(M,"opacity",1,(0,l.getNumberValidator)()),T(M,"name","",(0,l.getStringValidator)()),T(M,"id","",(0,l.getStringValidator)()),T(M,"rotation",0,(0,l.getNumberValidator)()),r.Factory.addComponentsGetterSetter(M,"scale",["x","y"]),T(M,"scaleX",1,(0,l.getNumberValidator)()),T(M,"scaleY",1,(0,l.getNumberValidator)()),r.Factory.addComponentsGetterSetter(M,"skew",["x","y"]),T(M,"skewX",0,(0,l.getNumberValidator)()),T(M,"skewY",0,(0,l.getNumberValidator)()),r.Factory.addComponentsGetterSetter(M,"offset",["x","y"]),T(M,"offsetX",0,(0,l.getNumberValidator)()),T(M,"offsetY",0,(0,l.getNumberValidator)()),T(M,"dragDistance",null,(0,l.getNumberValidator)()),T(M,"width",0,(0,l.getNumberValidator)()),T(M,"height",0,(0,l.getNumberValidator)()),T(M,"listening",!0,(0,l.getBooleanValidator)()),T(M,"preventDefault",!0,(0,l.getBooleanValidator)()),T(M,"filters",null,(function(t){return this._filterUpToDate=!1,t})),T(M,"visible",!0,(0,l.getBooleanValidator)()),T(M,"transformsEnabled","all",(0,l.getStringValidator)()),T(M,"size"),T(M,"dragBoundFunc"),T(M,"draggable",!1,(0,l.getBooleanValidator)()),r.Factory.backCompat(M,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"})},1704:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.releaseCapture=e.setPointerCapture=e.hasPointerCapture=e.createEvent=e.getCapturedShape=void 0;const a=i(3552),r=new Map,s=void 0!==a.Konva._global["PointerEvent"];function n(t){return r.get(t)}function o(t){return{evt:t,pointerId:t.pointerId}}function l(t,e){return r.get(t)===e}function h(t,e){d(t);const i=e.getStage();i&&(r.set(t,e),s&&e._fire("gotpointercapture",o(new PointerEvent("gotpointercapture"))))}function d(t,e){const i=r.get(t);if(!i)return;const a=i.getStage();a&&a.content,r.delete(t),s&&i._fire("lostpointercapture",o(new PointerEvent("lostpointercapture")))}e.getCapturedShape=n,e.createEvent=o,e.hasPointerCapture=l,e.setPointerCapture=h,e.releaseCapture=d},4718:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=e.shapes=void 0;const a=i(3552),r=i(8007),s=i(9658),n=i(6205),o=i(7723),l=i(3552),h=i(1704);var d="hasShadow",c="shadowRGBA",u="patternImage",p="linearGradient",g="radialGradient";let m;function f(){return m||(m=r.Util.createCanvasElement().getContext("2d"),m)}function v(t){const e=this.attrs.fillRule;e?t.fill(e):t.fill()}function y(t){t.stroke()}function b(t){const e=this.attrs.fillRule;e?t.fill(e):t.fill()}function _(t){t.stroke()}function w(){this._clearCache(d)}function C(){this._clearCache(c)}function A(){this._clearCache(u)}function S(){this._clearCache(p)}function x(){this._clearCache(g)}e.shapes={};class k extends n.Node{constructor(t){let i;super(t);while(1)if(i=r.Util.getRandomColor(),i&&!(i in e.shapes))break;this.colorKey=i,e.shapes[i]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this["_sceneFunc"]}getHitFunc(){return this.attrs.hitFunc||this["_hitFunc"]}hasShadow(){return this._getCache(d,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&0!==this.shadowOpacity()&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(u,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){var t=f();const e=t.createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(e&&e.setTransform){const t=new r.Transform;t.translate(this.fillPatternX(),this.fillPatternY()),t.rotate(a.Konva.getAngle(this.fillPatternRotation())),t.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),t.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const i=t.getMatrix(),s="undefined"===typeof DOMMatrix?{a:i[0],b:i[1],c:i[2],d:i[3],e:i[4],f:i[5]}:new DOMMatrix(i);e.setTransform(s)}return e}}_getLinearGradient(){return this._getCache(p,this.__getLinearGradient)}__getLinearGradient(){var t=this.fillLinearGradientColorStops();if(t){for(var e=f(),i=this.fillLinearGradientStartPoint(),a=this.fillLinearGradientEndPoint(),r=e.createLinearGradient(i.x,i.y,a.x,a.y),s=0;s<t.length;s+=2)r.addColorStop(t[s],t[s+1]);return r}}_getRadialGradient(){return this._getCache(g,this.__getRadialGradient)}__getRadialGradient(){var t=this.fillRadialGradientColorStops();if(t){for(var e=f(),i=this.fillRadialGradientStartPoint(),a=this.fillRadialGradientEndPoint(),r=e.createRadialGradient(i.x,i.y,this.fillRadialGradientStartRadius(),a.x,a.y,this.fillRadialGradientEndRadius()),s=0;s<t.length;s+=2)r.addColorStop(t[s],t[s+1]);return r}}getShadowRGBA(){return this._getCache(c,this._getShadowRGBA)}_getShadowRGBA(){if(this.hasShadow()){var t=r.Util.colorToRGBA(this.shadowColor());return t?"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")":void 0}}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],(()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops())))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],(()=>this.strokeEnabled()&&this.strokeWidth()&&!(!this.stroke()&&!this.strokeLinearGradientColorStops())))}hasHitStroke(){const t=this.hitStrokeWidth();return"auto"===t?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){var e=this.getStage();if(!e)return!1;const i=e.bufferHitCanvas;i.getContext().clear(),this.drawHit(i,void 0,!0);const a=i.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data;return a[3]>0}destroy(){return n.Node.prototype.destroy.call(this),delete e.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var e;const i=null===(e=this.attrs.perfectDrawEnabled)||void 0===e||e;if(!i)return!1;const a=t||this.hasFill(),r=this.hasStroke(),s=1!==this.getAbsoluteOpacity();if(a&&r&&s)return!0;const n=this.hasShadow(),o=this.shadowForStrokeEnabled();return!!(a&&r&&n&&o)}setStrokeHitEnabled(t){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return 0!==this.hitStrokeWidth()}getSelfRect(){var t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let e=!1,i=this.getParent();while(i){if(i.isCached()){e=!0;break}i=i.getParent()}const a=t.skipTransform,r=t.relativeTo||e&&this.getStage()||void 0,s=this.getSelfRect(),n=!t.skipStroke&&this.hasStroke(),o=n&&this.strokeWidth()||0,l=s.width+o,h=s.height+o,d=!t.skipShadow&&this.hasShadow(),c=d?this.shadowOffsetX():0,u=d?this.shadowOffsetY():0,p=l+Math.abs(c),g=h+Math.abs(u),m=d&&this.shadowBlur()||0,f=p+2*m,v=g+2*m,y={width:f,height:v,x:-(o/2+m)+Math.min(c,0)+s.x,y:-(o/2+m)+Math.min(u,0)+s.y};return a?y:this._transformedRect(y,r)}drawScene(t,e,i){var a,r,s=this.getLayer(),n=t||s.getCanvas(),o=n.getContext(),l=this._getCanvasCache(),h=this.getSceneFunc(),d=this.hasShadow(),c=n.isCache,u=e===this;if(!this.isVisible()&&!u)return this;if(l){o.save();var p=this.getAbsoluteTransform(e).getMatrix();return o.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(o),o.restore(),this}if(!h)return this;if(o.save(),this._useBufferCanvas()&&!c){a=this.getStage();const t=i||a.bufferCanvas;r=t.getContext(),r.clear(),r.save(),r._applyLineJoin(this);var g=this.getAbsoluteTransform(e).getMatrix();r.transform(g[0],g[1],g[2],g[3],g[4],g[5]),h.call(this,r,this),r.restore();var m=t.pixelRatio;d&&o._applyShadow(this),o._applyOpacity(this),o._applyGlobalCompositeOperation(this),o.drawImage(t._canvas,0,0,t.width/m,t.height/m)}else{if(o._applyLineJoin(this),!u){g=this.getAbsoluteTransform(e).getMatrix();o.transform(g[0],g[1],g[2],g[3],g[4],g[5]),o._applyOpacity(this),o._applyGlobalCompositeOperation(this)}d&&o._applyShadow(this),h.call(this,o,this)}return o.restore(),this}drawHit(t,e,i=!1){if(!this.shouldDrawHit(e,i))return this;var a=this.getLayer(),s=t||a.hitCanvas,n=s&&s.getContext(),o=this.hitFunc()||this.sceneFunc(),l=this._getCanvasCache(),h=l&&l.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),h){n.save();var d=this.getAbsoluteTransform(e).getMatrix();return n.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedHitCanvas(n),n.restore(),this}if(!o)return this;n.save(),n._applyLineJoin(this);const c=this===e;if(!c){var u=this.getAbsoluteTransform(e).getMatrix();n.transform(u[0],u[1],u[2],u[3],u[4],u[5])}return o.call(this,n,this),n.restore(),this}drawHitFromCache(t=0){var e,i,a,s,n,o,l=this._getCanvasCache(),h=this._getCachedSceneCanvas(),d=l.hit,c=d.getContext(),u=d.getWidth(),p=d.getHeight();c.clear(),c.drawImage(h._canvas,0,0,u,p);try{for(e=c.getImageData(0,0,u,p),i=e.data,a=i.length,s=r.Util._hexToRgb(this.colorKey),n=0;n<a;n+=4)o=i[n+3],o>t?(i[n]=s.r,i[n+1]=s.g,i[n+2]=s.b,i[n+3]=255):i[n+3]=0;c.putImageData(e,0,0)}catch(g){r.Util.error("Unable to draw hit graph from cached scene canvas. "+g.message)}return this}hasPointerCapture(t){return h.hasPointerCapture(t,this)}setPointerCapture(t){h.setPointerCapture(t,this)}releaseCapture(t){h.releaseCapture(t,this)}}e.Shape=k,k.prototype._fillFunc=v,k.prototype._strokeFunc=y,k.prototype._fillFuncHit=b,k.prototype._strokeFuncHit=_,k.prototype._centroid=!1,k.prototype.nodeType="Shape",(0,l._registerNode)(k),k.prototype.eventListeners={},k.prototype.on.call(k.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",w),k.prototype.on.call(k.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",C),k.prototype.on.call(k.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",A),k.prototype.on.call(k.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",S),k.prototype.on.call(k.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",x),s.Factory.addGetterSetter(k,"stroke",void 0,(0,o.getStringOrGradientValidator)()),s.Factory.addGetterSetter(k,"strokeWidth",2,(0,o.getNumberValidator)()),s.Factory.addGetterSetter(k,"fillAfterStrokeEnabled",!1),s.Factory.addGetterSetter(k,"hitStrokeWidth","auto",(0,o.getNumberOrAutoValidator)()),s.Factory.addGetterSetter(k,"strokeHitEnabled",!0,(0,o.getBooleanValidator)()),s.Factory.addGetterSetter(k,"perfectDrawEnabled",!0,(0,o.getBooleanValidator)()),s.Factory.addGetterSetter(k,"shadowForStrokeEnabled",!0,(0,o.getBooleanValidator)()),s.Factory.addGetterSetter(k,"lineJoin"),s.Factory.addGetterSetter(k,"lineCap"),s.Factory.addGetterSetter(k,"sceneFunc"),s.Factory.addGetterSetter(k,"hitFunc"),s.Factory.addGetterSetter(k,"dash"),s.Factory.addGetterSetter(k,"dashOffset",0,(0,o.getNumberValidator)()),s.Factory.addGetterSetter(k,"shadowColor",void 0,(0,o.getStringValidator)()),s.Factory.addGetterSetter(k,"shadowBlur",0,(0,o.getNumberValidator)()),s.Factory.addGetterSetter(k,"shadowOpacity",1,(0,o.getNumberValidator)()),s.Factory.addComponentsGetterSetter(k,"shadowOffset",["x","y"]),s.Factory.addGetterSetter(k,"shadowOffsetX",0,(0,o.getNumberValidator)()),s.Factory.addGetterSetter(k,"shadowOffsetY",0,(0,o.getNumberValidator)()),s.Factory.addGetterSetter(k,"fillPatternImage"),s.Factory.addGetterSetter(k,"fill",void 0,(0,o.getStringOrGradientValidator)()),s.Factory.addGetterSetter(k,"fillPatternX",0,(0,o.getNumberValidator)()),s.Factory.addGetterSetter(k,"fillPatternY",0,(0,o.getNumberValidator)()),s.Factory.addGetterSetter(k,"fillLinearGradientColorStops"),s.Factory.addGetterSetter(k,"strokeLinearGradientColorStops"),s.Factory.addGetterSetter(k,"fillRadialGradientStartRadius",0),s.Factory.addGetterSetter(k,"fillRadialGradientEndRadius",0),s.Factory.addGetterSetter(k,"fillRadialGradientColorStops"),s.Factory.addGetterSetter(k,"fillPatternRepeat","repeat"),s.Factory.addGetterSetter(k,"fillEnabled",!0),s.Factory.addGetterSetter(k,"strokeEnabled",!0),s.Factory.addGetterSetter(k,"shadowEnabled",!0),s.Factory.addGetterSetter(k,"dashEnabled",!0),s.Factory.addGetterSetter(k,"strokeScaleEnabled",!0),s.Factory.addGetterSetter(k,"fillPriority","color"),s.Factory.addComponentsGetterSetter(k,"fillPatternOffset",["x","y"]),s.Factory.addGetterSetter(k,"fillPatternOffsetX",0,(0,o.getNumberValidator)()),s.Factory.addGetterSetter(k,"fillPatternOffsetY",0,(0,o.getNumberValidator)()),s.Factory.addComponentsGetterSetter(k,"fillPatternScale",["x","y"]),s.Factory.addGetterSetter(k,"fillPatternScaleX",1,(0,o.getNumberValidator)()),s.Factory.addGetterSetter(k,"fillPatternScaleY",1,(0,o.getNumberValidator)()),s.Factory.addComponentsGetterSetter(k,"fillLinearGradientStartPoint",["x","y"]),s.Factory.addComponentsGetterSetter(k,"strokeLinearGradientStartPoint",["x","y"]),s.Factory.addGetterSetter(k,"fillLinearGradientStartPointX",0),s.Factory.addGetterSetter(k,"strokeLinearGradientStartPointX",0),s.Factory.addGetterSetter(k,"fillLinearGradientStartPointY",0),s.Factory.addGetterSetter(k,"strokeLinearGradientStartPointY",0),s.Factory.addComponentsGetterSetter(k,"fillLinearGradientEndPoint",["x","y"]),s.Factory.addComponentsGetterSetter(k,"strokeLinearGradientEndPoint",["x","y"]),s.Factory.addGetterSetter(k,"fillLinearGradientEndPointX",0),s.Factory.addGetterSetter(k,"strokeLinearGradientEndPointX",0),s.Factory.addGetterSetter(k,"fillLinearGradientEndPointY",0),s.Factory.addGetterSetter(k,"strokeLinearGradientEndPointY",0),s.Factory.addComponentsGetterSetter(k,"fillRadialGradientStartPoint",["x","y"]),s.Factory.addGetterSetter(k,"fillRadialGradientStartPointX",0),s.Factory.addGetterSetter(k,"fillRadialGradientStartPointY",0),s.Factory.addComponentsGetterSetter(k,"fillRadialGradientEndPoint",["x","y"]),s.Factory.addGetterSetter(k,"fillRadialGradientEndPointX",0),s.Factory.addGetterSetter(k,"fillRadialGradientEndPointY",0),s.Factory.addGetterSetter(k,"fillPatternRotation",0),s.Factory.addGetterSetter(k,"fillRule",void 0,(0,o.getStringValidator)()),s.Factory.backCompat(k,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})},7195:function(t,e,i){i(560),Object.defineProperty(e,"__esModule",{value:!0}),e.Stage=e.stages=void 0;const a=i(8007),r=i(9658),s=i(7867),n=i(3552),o=i(7383),l=i(2448),h=i(3552),d=i(1704);var c="Stage",u="string",p="px",g="mouseout",m="mouseleave",f="mouseover",v="mouseenter",y="mousemove",b="mousedown",_="mouseup",w="pointermove",C="pointerdown",A="pointerup",S="pointercancel",x="lostpointercapture",k="pointerout",L="pointerleave",E="pointerover",M="pointerenter",T="contextmenu",F="touchstart",D="touchend",P="touchmove",I="touchcancel",N="wheel",R=5,O=[[v,"_pointerenter"],[b,"_pointerdown"],[y,"_pointermove"],[_,"_pointerup"],[m,"_pointerleave"],[F,"_pointerdown"],[P,"_pointermove"],[D,"_pointerup"],[I,"_pointercancel"],[f,"_pointerover"],[N,"_wheel"],[T,"_contextmenu"],[C,"_pointerdown"],[w,"_pointermove"],[A,"_pointerup"],[S,"_pointercancel"],[x,"_lostpointercapture"]];const B={mouse:{[k]:g,[L]:m,[E]:f,[M]:v,[w]:y,[C]:b,[A]:_,[S]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[k]:"touchout",[L]:"touchleave",[E]:"touchover",[M]:"touchenter",[w]:P,[C]:F,[A]:D,[S]:I,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[k]:k,[L]:L,[E]:E,[M]:M,[w]:w,[C]:C,[A]:A,[S]:S,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},G=t=>t.indexOf("pointer")>=0?"pointer":t.indexOf("touch")>=0?"touch":"mouse",U=t=>{const e=G(t);return"pointer"===e?n.Konva.pointerEventsEnabled&&B.pointer:"touch"===e?B.touch:"mouse"===e?B.mouse:void 0};function z(t={}){return(t.clipFunc||t.clipWidth||t.clipHeight)&&a.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),t}const W="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";e.stages=[];class V extends s.Container{constructor(t){super(z(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),e.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",(()=>{z(this.attrs)})),this._checkVisibility()}_validateAdd(t){const e="Layer"===t.getType(),i="FastLayer"===t.getType(),r=e||i;r||a.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if(typeof t===u){if("."===t.charAt(0)){var e=t.slice(1);t=document.getElementsByClassName(e)[0]}else{var i;i="#"!==t.charAt(0)?t:t.slice(1),t=document.getElementById(i)}if(!t)throw"Can not find container in document with id "+i}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){var t,e=this.children,i=e.length;for(t=0;t<i;t++)e[t].clear();return this}clone(t){return t||(t={}),t.container="undefined"!==typeof document&&document.createElement("div"),s.Container.prototype.clone.call(this,t)}destroy(){super.destroy();var t=this.content;t&&a.Util._isInDocument(t)&&this.container().removeChild(t);var i=e.stages.indexOf(this);return i>-1&&e.stages.splice(i,1),a.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(a.Util.warn(W),null)}_getPointerById(t){return this._pointerPositions.find((e=>e.id===t))}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){t=t||{},t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();var e=new o.SceneCanvas({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),i=e.getContext()._context,a=this.children;return(t.x||t.y)&&i.translate(-1*t.x,-1*t.y),a.forEach((function(e){if(e.isVisible()){var a=e._toKonvaCanvas(t);i.drawImage(a._canvas,t.x,t.y,a.getWidth()/a.getPixelRatio(),a.getHeight()/a.getPixelRatio())}})),e}getIntersection(t){if(!t)return null;var e,i=this.children,a=i.length,r=a-1;for(e=r;e>=0;e--){const a=i[e].getIntersection(t);if(a)return a}return null}_resizeDOM(){var t=this.width(),e=this.height();this.content&&(this.content.style.width=t+p,this.content.style.height=e+p),this.bufferCanvas.setSize(t,e),this.bufferHitCanvas.setSize(t,e),this.children.forEach((i=>{i.setSize({width:t,height:e}),i.draw()}))}add(t,...e){if(arguments.length>1){for(var i=0;i<arguments.length;i++)this.add(arguments[i]);return this}super.add(t);var r=this.children.length;return r>R&&a.Util.warn("The stage has "+r+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),n.Konva.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return d.hasPointerCapture(t,this)}setPointerCapture(t){d.setPointerCapture(t,this)}releaseCapture(t){d.releaseCapture(t,this)}getLayers(){return this.children}_bindContentEvents(){n.Konva.isBrowser&&O.forEach((([t,e])=>{this.content.addEventListener(t,(t=>{this[e](t)}),{passive:!1})}))}_pointerenter(t){this.setPointersPositions(t);const e=U(t.type);e&&this._fire(e.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);const e=U(t.type);e&&this._fire(e.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let e=this[t+"targetShape"];return e&&!e.getStage()&&(e=null),e}_pointerleave(t){const e=U(t.type),i=G(t.type);if(e){this.setPointersPositions(t);var a=this._getTargetShape(i),r=!(n.Konva.isDragging()||n.Konva.isTransforming())||n.Konva.hitOnDragEnabled;a&&r?(a._fireAndBubble(e.pointerout,{evt:t}),a._fireAndBubble(e.pointerleave,{evt:t}),this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this[i+"targetShape"]=null):r&&(this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(e.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}}_pointerdown(t){const e=U(t.type),i=G(t.type);if(e){this.setPointersPositions(t);var a=!1;this._changedPointerPositions.forEach((r=>{var s=this.getIntersection(r);if(l.DD.justDragged=!1,n.Konva["_"+i+"ListenClick"]=!0,!s||!s.isListening())return void(this[i+"ClickStartShape"]=void 0);n.Konva.capturePointerEventsEnabled&&s.setPointerCapture(r.id),this[i+"ClickStartShape"]=s,s._fireAndBubble(e.pointerdown,{evt:t,pointerId:r.id}),a=!0;const o=t.type.indexOf("touch")>=0;s.preventDefault()&&t.cancelable&&o&&t.preventDefault()})),a||this._fire(e.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}}_pointermove(t){const e=U(t.type),i=G(t.type);if(!e)return;n.Konva.isDragging()&&l.DD.node.preventDefault()&&t.cancelable&&t.preventDefault(),this.setPointersPositions(t);var a=!(n.Konva.isDragging()||n.Konva.isTransforming())||n.Konva.hitOnDragEnabled;if(!a)return;var r={};let s=!1;var o=this._getTargetShape(i);this._changedPointerPositions.forEach((a=>{const n=d.getCapturedShape(a.id)||this.getIntersection(a),l=a.id,h={evt:t,pointerId:l};var c=o!==n;if(c&&o&&(o._fireAndBubble(e.pointerout,{...h},n),o._fireAndBubble(e.pointerleave,{...h},n)),n){if(r[n._id])return;r[n._id]=!0}n&&n.isListening()?(s=!0,c&&(n._fireAndBubble(e.pointerover,{...h},o),n._fireAndBubble(e.pointerenter,{...h},o),this[i+"targetShape"]=n),n._fireAndBubble(e.pointermove,{...h})):o&&(this._fire(e.pointerover,{evt:t,target:this,currentTarget:this,pointerId:l}),this[i+"targetShape"]=null)})),s||this._fire(e.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){const e=U(t.type),i=G(t.type);if(!e)return;this.setPointersPositions(t);const a=this[i+"ClickStartShape"],r=this[i+"ClickEndShape"];var s={};let o=!1;this._changedPointerPositions.forEach((h=>{const c=d.getCapturedShape(h.id)||this.getIntersection(h);if(c){if(c.releaseCapture(h.id),s[c._id])return;s[c._id]=!0}const u=h.id,p={evt:t,pointerId:u};let g=!1;n.Konva["_"+i+"InDblClickWindow"]?(g=!0,clearTimeout(this[i+"DblTimeout"])):l.DD.justDragged||(n.Konva["_"+i+"InDblClickWindow"]=!0,clearTimeout(this[i+"DblTimeout"])),this[i+"DblTimeout"]=setTimeout((function(){n.Konva["_"+i+"InDblClickWindow"]=!1}),n.Konva.dblClickWindow),c&&c.isListening()?(o=!0,this[i+"ClickEndShape"]=c,c._fireAndBubble(e.pointerup,{...p}),n.Konva["_"+i+"ListenClick"]&&a&&a===c&&(c._fireAndBubble(e.pointerclick,{...p}),g&&r&&r===c&&c._fireAndBubble(e.pointerdblclick,{...p}))):(this[i+"ClickEndShape"]=null,n.Konva["_"+i+"ListenClick"]&&this._fire(e.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:u}),g&&this._fire(e.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:u}))})),o||this._fire(e.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),n.Konva["_"+i+"ListenClick"]=!1,t.cancelable&&"touch"!==i&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);var e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(T,{evt:t}):this._fire(T,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);var e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(N,{evt:t}):this._fire(N,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);const e=d.getCapturedShape(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble(A,d.createEvent(t)),d.releaseCapture(t.pointerId)}_lostpointercapture(t){d.releaseCapture(t.pointerId)}setPointersPositions(t){var e=this._getContentPosition(),i=null,r=null;t=t||window.event,void 0!==t.touches?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,(t=>{this._pointerPositions.push({id:t.identifier,x:(t.clientX-e.left)/e.scaleX,y:(t.clientY-e.top)/e.scaleY})})),Array.prototype.forEach.call(t.changedTouches||t.touches,(t=>{this._changedPointerPositions.push({id:t.identifier,x:(t.clientX-e.left)/e.scaleX,y:(t.clientY-e.top)/e.scaleY})}))):(i=(t.clientX-e.left)/e.scaleX,r=(t.clientY-e.top)/e.scaleY,this.pointerPos={x:i,y:r},this._pointerPositions=[{x:i,y:r,id:a.Util._getFirstPointerId(t)}],this._changedPointerPositions=[{x:i,y:r,id:a.Util._getFirstPointerId(t)}])}_setPointerPosition(t){a.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new o.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new o.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),n.Konva.isBrowser){var t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}}cache(){return a.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach((function(t){t.batchDraw()})),this}}e.Stage=V,V.prototype.nodeType=c,(0,h._registerNode)(V),r.Factory.addGetterSetter(V,"container"),n.Konva.isBrowser&&document.addEventListener("visibilitychange",(()=>{e.stages.forEach((t=>{t.batchDraw()}))}))},4262:function(t,e,i){i(560),Object.defineProperty(e,"__esModule",{value:!0}),e.Easings=e.Tween=void 0;const a=i(8007),r=i(2966),s=i(6205),n=i(3552);var o={node:1,duration:1,easing:1,onFinish:1,yoyo:1},l=1,h=2,d=3,c=0,u=["fill","stroke","shadowColor"];class p{constructor(t,e,i,a,r,s,n){this.prop=t,this.propFunc=e,this.begin=a,this._pos=a,this.duration=s,this._change=0,this.prevPos=0,this.yoyo=n,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=i,this._change=r-this.begin,this.pause()}fire(t){var e=this[t];e&&e()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return void 0===t&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=h,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=d,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){var t=this.getTimer()-this._startTime;this.state===h?this.setTime(t):this.state===d&&this.setTime(this.duration-t)}pause(){this.state=l,this.fire("onPause")}getTimer(){return(new Date).getTime()}}class g{constructor(t){var i,s,l=this,h=t.node,d=h._id,u=t.easing||e.Easings.Linear,m=!!t.yoyo;i="undefined"===typeof t.duration?.3:0===t.duration?.001:t.duration,this.node=h,this._id=c++;var f=h.getLayer()||(h instanceof n.Konva["Stage"]?h.getLayers():null);for(s in f||a.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation((function(){l.tween.onEnterFrame()}),f),this.tween=new p(s,(function(t){l._tweenFunc(t)}),u,0,1,1e3*i,m),this._addListeners(),g.attrs[d]||(g.attrs[d]={}),g.attrs[d][this._id]||(g.attrs[d][this._id]={}),g.tweens[d]||(g.tweens[d]={}),t)void 0===o[s]&&this._addAttr(s,t[s]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,e){var i,r,s,n,o,l,h,d,c=this.node,p=c._id;if(s=g.tweens[p][t],s&&delete g.attrs[p][s][t],i=c.getAttr(t),a.Util._isArray(e))if(r=[],o=Math.max(e.length,i.length),"points"===t&&e.length!==i.length&&(e.length>i.length?(h=i,i=a.Util._prepareArrayForTween(i,e,c.closed())):(l=e,e=a.Util._prepareArrayForTween(e,i,c.closed()))),0===t.indexOf("fill"))for(n=0;n<o;n++)if(n%2===0)r.push(e[n]-i[n]);else{var m=a.Util.colorToRGBA(i[n]);d=a.Util.colorToRGBA(e[n]),i[n]=m,r.push({r:d.r-m.r,g:d.g-m.g,b:d.b-m.b,a:d.a-m.a})}else for(n=0;n<o;n++)r.push(e[n]-i[n]);else-1!==u.indexOf(t)?(i=a.Util.colorToRGBA(i),d=a.Util.colorToRGBA(e),r={r:d.r-i.r,g:d.g-i.g,b:d.b-i.b,a:d.a-i.a}):r=e-i;g.attrs[p][this._id][t]={start:i,diff:r,end:e,trueEnd:l,trueStart:h},g.tweens[p][t]=this._id}_tweenFunc(t){var e,i,r,s,n,o,l,h,d=this.node,c=g.attrs[d._id][this._id];for(e in c){if(i=c[e],r=i.start,s=i.diff,h=i.end,a.Util._isArray(r))if(n=[],l=Math.max(r.length,h.length),0===e.indexOf("fill"))for(o=0;o<l;o++)o%2===0?n.push((r[o]||0)+s[o]*t):n.push("rgba("+Math.round(r[o].r+s[o].r*t)+","+Math.round(r[o].g+s[o].g*t)+","+Math.round(r[o].b+s[o].b*t)+","+(r[o].a+s[o].a*t)+")");else for(o=0;o<l;o++)n.push((r[o]||0)+s[o]*t);else n=-1!==u.indexOf(e)?"rgba("+Math.round(r.r+s.r*t)+","+Math.round(r.g+s.g*t)+","+Math.round(r.b+s.b*t)+","+(r.a+s.a*t)+")":r+s*t;d.setAttr(e,n)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{var t=this.node,e=g.attrs[t._id][this._id];e.points&&e.points.trueEnd&&t.setAttr("points",e.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{var t=this.node,e=g.attrs[t._id][this._id];e.points&&e.points.trueStart&&t.points(e.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(1e3*t),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){var t,e=this.node._id,i=this._id,a=g.tweens[e];for(t in this.pause(),a)delete g.tweens[e][t];delete g.attrs[e][i]}}e.Tween=g,g.attrs={},g.tweens={},s.Node.prototype.to=function(t){var e=t.onFinish;t.node=this,t.onFinish=function(){this.destroy(),e&&e()};var i=new g(t);i.play()},e.Easings={BackEaseIn(t,e,i,a){var r=1.70158;return i*(t/=a)*t*((r+1)*t-r)+e},BackEaseOut(t,e,i,a){var r=1.70158;return i*((t=t/a-1)*t*((r+1)*t+r)+1)+e},BackEaseInOut(t,e,i,a){var r=1.70158;return(t/=a/2)<1?i/2*(t*t*((1+(r*=1.525))*t-r))+e:i/2*((t-=2)*t*((1+(r*=1.525))*t+r)+2)+e},ElasticEaseIn(t,e,i,a,r,s){var n=0;return 0===t?e:1===(t/=a)?e+i:(s||(s=.3*a),!r||r<Math.abs(i)?(r=i,n=s/4):n=s/(2*Math.PI)*Math.asin(i/r),-r*Math.pow(2,10*(t-=1))*Math.sin((t*a-n)*(2*Math.PI)/s)+e)},ElasticEaseOut(t,e,i,a,r,s){var n=0;return 0===t?e:1===(t/=a)?e+i:(s||(s=.3*a),!r||r<Math.abs(i)?(r=i,n=s/4):n=s/(2*Math.PI)*Math.asin(i/r),r*Math.pow(2,-10*t)*Math.sin((t*a-n)*(2*Math.PI)/s)+i+e)},ElasticEaseInOut(t,e,i,a,r,s){var n=0;return 0===t?e:2===(t/=a/2)?e+i:(s||(s=a*(.3*1.5)),!r||r<Math.abs(i)?(r=i,n=s/4):n=s/(2*Math.PI)*Math.asin(i/r),t<1?r*Math.pow(2,10*(t-=1))*Math.sin((t*a-n)*(2*Math.PI)/s)*-.5+e:r*Math.pow(2,-10*(t-=1))*Math.sin((t*a-n)*(2*Math.PI)/s)*.5+i+e)},BounceEaseOut(t,e,i,a){return(t/=a)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},BounceEaseIn(t,i,a,r){return a-e.Easings.BounceEaseOut(r-t,0,a,r)+i},BounceEaseInOut(t,i,a,r){return t<r/2?.5*e.Easings.BounceEaseIn(2*t,0,a,r)+i:.5*e.Easings.BounceEaseOut(2*t-r,0,a,r)+.5*a+i},EaseIn(t,e,i,a){return i*(t/=a)*t+e},EaseOut(t,e,i,a){return-i*(t/=a)*(t-2)+e},EaseInOut(t,e,i,a){return(t/=a/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},StrongEaseIn(t,e,i,a){return i*(t/=a)*t*t*t*t+e},StrongEaseOut(t,e,i,a){return i*((t=t/a-1)*t*t*t*t+1)+e},StrongEaseInOut(t,e,i,a){return(t/=a/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},Linear(t,e,i,a){return i*t/a+e}}},8007:function(t,e,i){i(560),Object.defineProperty(e,"__esModule",{value:!0}),e.Util=e.Transform=void 0;const a=i(3552);class r{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){var e=this.m;return{x:e[0]*t.x+e[2]*t.y+e[4],y:e[1]*t.x+e[3]*t.y+e[5]}}translate(t,e){return this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this}scale(t,e){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e,this}rotate(t){var e=Math.cos(t),i=Math.sin(t),a=this.m[0]*e+this.m[2]*i,r=this.m[1]*e+this.m[3]*i,s=this.m[0]*-i+this.m[2]*e,n=this.m[1]*-i+this.m[3]*e;return this.m[0]=a,this.m[1]=r,this.m[2]=s,this.m[3]=n,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,e){var i=this.m[0]+this.m[2]*e,a=this.m[1]+this.m[3]*e,r=this.m[2]+this.m[0]*t,s=this.m[3]+this.m[1]*t;return this.m[0]=i,this.m[1]=a,this.m[2]=r,this.m[3]=s,this}multiply(t){var e=this.m[0]*t.m[0]+this.m[2]*t.m[1],i=this.m[1]*t.m[0]+this.m[3]*t.m[1],a=this.m[0]*t.m[2]+this.m[2]*t.m[3],r=this.m[1]*t.m[2]+this.m[3]*t.m[3],s=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],n=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=e,this.m[1]=i,this.m[2]=a,this.m[3]=r,this.m[4]=s,this.m[5]=n,this}invert(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,i=-this.m[1]*t,a=-this.m[2]*t,r=this.m[0]*t,s=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),n=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=e,this.m[1]=i,this.m[2]=a,this.m[3]=r,this.m[4]=s,this.m[5]=n,this}getMatrix(){return this.m}decompose(){var t=this.m[0],i=this.m[1],a=this.m[2],r=this.m[3],s=this.m[4],n=this.m[5],o=t*r-i*a;let l={x:s,y:n,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!=t||0!=i){var h=Math.sqrt(t*t+i*i);l.rotation=i>0?Math.acos(t/h):-Math.acos(t/h),l.scaleX=h,l.scaleY=o/h,l.skewX=(t*a+i*r)/o,l.skewY=0}else if(0!=a||0!=r){var d=Math.sqrt(a*a+r*r);l.rotation=Math.PI/2-(r>0?Math.acos(-a/d):-Math.acos(a/d)),l.scaleX=o/d,l.scaleY=d,l.skewX=0,l.skewY=(t*a+i*r)/o}return l.rotation=e.Util._getRotation(l.rotation),l}}e.Transform=r;var s="[object Array]",n="[object Number]",o="[object String]",l="[object Boolean]",h=Math.PI/180,d=180/Math.PI,c="#",u="",p="0",g="Konva warning: ",m="Konva error: ",f="rgb(",v={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},y=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,b=[];const _="undefined"!==typeof requestAnimationFrame&&requestAnimationFrame||function(t){setTimeout(t,60)};e.Util={_isElement(t){return!(!t||1!=t.nodeType)},_isFunction(t){return!!(t&&t.constructor&&t.call&&t.apply)},_isPlainObject(t){return!!t&&t.constructor===Object},_isArray(t){return Object.prototype.toString.call(t)===s},_isNumber(t){return Object.prototype.toString.call(t)===n&&!isNaN(t)&&isFinite(t)},_isString(t){return Object.prototype.toString.call(t)===o},_isBoolean(t){return Object.prototype.toString.call(t)===l},isObject(t){return t instanceof Object},isValidSelector(t){if("string"!==typeof t)return!1;var e=t[0];return"#"===e||"."===e||e===e.toUpperCase()},_sign(t){return 0===t||t>0?1:-1},requestAnimFrame(t){b.push(t),1===b.length&&_((function(){const t=b;b=[],t.forEach((function(t){t()}))}))},createCanvasElement(){var t=document.createElement("canvas");try{t.style=t.style||{}}catch(e){}return t},createImageElement(){return document.createElement("img")},_isInDocument(t){while(t=t.parentNode)if(t==document)return!0;return!1},_urlToImage(t,i){var a=e.Util.createImageElement();a.onload=function(){i(a)},a.src=t},_rgbToHex(t,e,i){return((1<<24)+(t<<16)+(e<<8)+i).toString(16).slice(1)},_hexToRgb(t){t=t.replace(c,u);var e=parseInt(t,16);return{r:e>>16&255,g:e>>8&255,b:255&e}},getRandomColor(){var t=(16777215*Math.random()<<0).toString(16);while(t.length<6)t=p+t;return c+t},getRGB(t){var e;return t in v?(e=v[t],{r:e[0],g:e[1],b:e[2]}):t[0]===c?this._hexToRgb(t.substring(1)):t.substr(0,4)===f?(e=y.exec(t.replace(/ /g,"")),{r:parseInt(e[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}):{r:0,g:0,b:0}},colorToRGBA(t){return t=t||"black",e.Util._namedColorToRBA(t)||e.Util._hex3ColorToRGBA(t)||e.Util._hex4ColorToRGBA(t)||e.Util._hex6ColorToRGBA(t)||e.Util._hex8ColorToRGBA(t)||e.Util._rgbColorToRGBA(t)||e.Util._rgbaColorToRGBA(t)||e.Util._hslColorToRGBA(t)},_namedColorToRBA(t){var e=v[t.toLowerCase()];return e?{r:e[0],g:e[1],b:e[2],a:1}:null},_rgbColorToRGBA(t){if(0===t.indexOf("rgb(")){t=t.match(/rgb\(([^)]+)\)/)[1];var e=t.split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1}}},_rgbaColorToRGBA(t){if(0===t.indexOf("rgba(")){t=t.match(/rgba\(([^)]+)\)/)[1];var e=t.split(/ *, */).map(((t,e)=>"%"===t.slice(-1)?3===e?parseInt(t)/100:parseInt(t)/100*255:Number(t)));return{r:e[0],g:e[1],b:e[2],a:e[3]}}},_hex8ColorToRGBA(t){if("#"===t[0]&&9===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:parseInt(t.slice(7,9),16)/255}},_hex6ColorToRGBA(t){if("#"===t[0]&&7===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:1}},_hex4ColorToRGBA(t){if("#"===t[0]&&5===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:parseInt(t[4]+t[4],16)/255}},_hex3ColorToRGBA(t){if("#"===t[0]&&4===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:1}},_hslColorToRGBA(t){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(t)){const[e,...i]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t),a=Number(i[0])/360,r=Number(i[1])/100,s=Number(i[2])/100;let n,o,l;if(0===r)return l=255*s,{r:Math.round(l),g:Math.round(l),b:Math.round(l),a:1};n=s<.5?s*(1+r):s+r-s*r;const h=2*s-n,d=[0,0,0];for(let t=0;t<3;t++)o=a+1/3*-(t-1),o<0&&o++,o>1&&o--,l=6*o<1?h+6*(n-h)*o:2*o<1?n:3*o<2?h+(n-h)*(2/3-o)*6:h,d[t]=255*l;return{r:Math.round(d[0]),g:Math.round(d[1]),b:Math.round(d[2]),a:1}}},haveIntersection(t,e){return!(e.x>t.x+t.width||e.x+e.width<t.x||e.y>t.y+t.height||e.y+e.height<t.y)},cloneObject(t){var e={};for(var i in t)this._isPlainObject(t[i])?e[i]=this.cloneObject(t[i]):this._isArray(t[i])?e[i]=this.cloneArray(t[i]):e[i]=t[i];return e},cloneArray(t){return t.slice(0)},degToRad(t){return t*h},radToDeg(t){return t*d},_degToRad(t){return e.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),e.Util.degToRad(t)},_radToDeg(t){return e.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),e.Util.radToDeg(t)},_getRotation(t){return a.Konva.angleDeg?e.Util.radToDeg(t):t},_capitalize(t){return t.charAt(0).toUpperCase()+t.slice(1)},throw(t){throw new Error(m+t)},error(t){console.error(m+t)},warn(t){a.Konva.showWarnings&&console.warn(g+t)},each(t,e){for(var i in t)e(i,t[i])},_inRange(t,e,i){return e<=t&&t<i},_getProjectionToSegment(t,e,i,a,r,s){var n,o,l,h=(t-i)*(t-i)+(e-a)*(e-a);if(0==h)n=t,o=e,l=(r-i)*(r-i)+(s-a)*(s-a);else{var d=((r-t)*(i-t)+(s-e)*(a-e))/h;d<0?(n=t,o=e,l=(t-r)*(t-r)+(e-s)*(e-s)):d>1?(n=i,o=a,l=(i-r)*(i-r)+(a-s)*(a-s)):(n=t+d*(i-t),o=e+d*(a-e),l=(n-r)*(n-r)+(o-s)*(o-s))}return[n,o,l]},_getProjectionToLine(t,i,a){var r=e.Util.cloneObject(t),s=Number.MAX_VALUE;return i.forEach((function(n,o){if(a||o!==i.length-1){var l=i[(o+1)%i.length],h=e.Util._getProjectionToSegment(n.x,n.y,l.x,l.y,t.x,t.y),d=h[0],c=h[1],u=h[2];u<s&&(r.x=d,r.y=c,s=u)}})),r},_prepareArrayForTween(t,i,a){var r,s=[],n=[];if(t.length>i.length){var o=i;i=t,t=o}for(r=0;r<t.length;r+=2)s.push({x:t[r],y:t[r+1]});for(r=0;r<i.length;r+=2)n.push({x:i[r],y:i[r+1]});var l=[];return n.forEach((function(t){var i=e.Util._getProjectionToLine(t,s,a);l.push(i.x),l.push(i.y)})),l},_prepareToStringify(t){var i;for(var a in t.visitedByCircularReferenceRemoval=!0,t)if(t.hasOwnProperty(a)&&t[a]&&"object"==typeof t[a])if(i=Object.getOwnPropertyDescriptor(t,a),t[a].visitedByCircularReferenceRemoval||e.Util._isElement(t[a])){if(!i.configurable)return null;delete t[a]}else if(null===e.Util._prepareToStringify(t[a])){if(!i.configurable)return null;delete t[a]}return delete t.visitedByCircularReferenceRemoval,t},_assign(t,e){for(var i in e)t[i]=e[i];return t},_getFirstPointerId(t){return t.touches?t.changedTouches[0].identifier:t.pointerId||999},releaseCanvas(...t){a.Konva.releaseCanvasOnDestroy&&t.forEach((t=>{t.width=0,t.height=0}))},drawRoundedRectPath(t,e,i,a){let r=0,s=0,n=0,o=0;"number"===typeof a?r=s=n=o=Math.min(a,e/2,i/2):(r=Math.min(a[0]||0,e/2,i/2),s=Math.min(a[1]||0,e/2,i/2),o=Math.min(a[2]||0,e/2,i/2),n=Math.min(a[3]||0,e/2,i/2)),t.moveTo(r,0),t.lineTo(e-s,0),t.arc(e-s,s,s,3*Math.PI/2,0,!1),t.lineTo(e,i-o),t.arc(e-o,i-o,o,0,Math.PI/2,!1),t.lineTo(n,i),t.arc(n,i-n,n,Math.PI/2,Math.PI,!1),t.lineTo(0,r),t.arc(r,r,r,Math.PI,3*Math.PI/2,!1)}}},7723:function(t,e,i){i(4224),i(1121),i(7133),Object.defineProperty(e,"__esModule",{value:!0}),e.getComponentValidator=e.getBooleanValidator=e.getNumberArrayValidator=e.getFunctionValidator=e.getStringOrGradientValidator=e.getStringValidator=e.getNumberOrAutoValidator=e.getNumberOrArrayOfNumbersValidator=e.getNumberValidator=e.alphaComponent=e.RGBComponent=void 0;const a=i(3552),r=i(8007);function s(t){return r.Util._isString(t)?'"'+t+'"':"[object Number]"===Object.prototype.toString.call(t)||r.Util._isBoolean(t)?t:Object.prototype.toString.call(t)}function n(t){return t>255?255:t<0?0:Math.round(t)}function o(t){return t>1?1:t<1e-4?1e-4:t}function l(){if(a.Konva.isUnminified)return function(t,e){return r.Util._isNumber(t)||r.Util.warn(s(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}function h(t){if(a.Konva.isUnminified)return function(e,i){let a=r.Util._isNumber(e),n=r.Util._isArray(e)&&e.length==t;return a||n||r.Util.warn(s(e)+' is a not valid value for "'+i+'" attribute. The value should be a number or Array<number>('+t+")"),e}}function d(){if(a.Konva.isUnminified)return function(t,e){var i=r.Util._isNumber(t),a="auto"===t;return i||a||r.Util.warn(s(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}function c(){if(a.Konva.isUnminified)return function(t,e){return r.Util._isString(t)||r.Util.warn(s(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}function u(){if(a.Konva.isUnminified)return function(t,e){const i=r.Util._isString(t),a="[object CanvasGradient]"===Object.prototype.toString.call(t)||t&&t.addColorStop;return i||a||r.Util.warn(s(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}}function p(){if(a.Konva.isUnminified)return function(t,e){return r.Util._isFunction(t)||r.Util.warn(s(t)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),t}}function g(){if(a.Konva.isUnminified)return function(t,e){const i=Int8Array?Object.getPrototypeOf(Int8Array):null;return i&&t instanceof i||(r.Util._isArray(t)?t.forEach((function(t){r.Util._isNumber(t)||r.Util.warn('"'+e+'" attribute has non numeric element '+t+". Make sure that all elements are numbers.")})):r.Util.warn(s(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),t}}function m(){if(a.Konva.isUnminified)return function(t,e){var i=!0===t||!1===t;return i||r.Util.warn(s(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}function f(t){if(a.Konva.isUnminified)return function(e,i){return void 0===e||null===e||r.Util.isObject(e)||r.Util.warn(s(e)+' is a not valid value for "'+i+'" attribute. The value should be an object with properties '+t),e}}e.RGBComponent=n,e.alphaComponent=o,e.getNumberValidator=l,e.getNumberOrArrayOfNumbersValidator=h,e.getNumberOrAutoValidator=d,e.getStringValidator=c,e.getStringOrGradientValidator=u,e.getFunctionValidator=p,e.getNumberArrayValidator=g,e.getBooleanValidator=m,e.getComponentValidator=f},9032:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;const a=i(3552),r=i(8007),s=i(6205),n=i(7867),o=i(7195),l=i(5783),h=i(1503),d=i(1763),c=i(2448),u=i(4718),p=i(2966),g=i(4262),m=i(3902),f=i(7383);e.Konva=r.Util._assign(a.Konva,{Util:r.Util,Transform:r.Transform,Node:s.Node,Container:n.Container,Stage:o.Stage,stages:o.stages,Layer:l.Layer,FastLayer:h.FastLayer,Group:d.Group,DD:c.DD,Shape:u.Shape,shapes:u.shapes,Animation:p.Animation,Tween:g.Tween,Easings:g.Easings,Context:m.Context,Canvas:f.Canvas}),e["default"]=e.Konva},8158:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;const a=i(9032),r=i(3515),s=i(7555),n=i(3019),o=i(2378),l=i(2420),h=i(7036),d=i(6283),c=i(988),u=i(8358),p=i(7790),g=i(7716),m=i(2926),f=i(8273),v=i(5436),y=i(6337),b=i(7736),_=i(251),w=i(615),C=i(9643),A=i(9273),S=i(2528),x=i(1304),k=i(2998),L=i(1433),E=i(3607),M=i(1189),T=i(6359),F=i(9482),D=i(7019),P=i(3707),I=i(8391),N=i(211),R=i(5992),O=i(6768),B=i(9743),G=i(6090);e.Konva=a.Konva.Util._assign(a.Konva,{Arc:r.Arc,Arrow:s.Arrow,Circle:n.Circle,Ellipse:o.Ellipse,Image:l.Image,Label:h.Label,Tag:h.Tag,Line:d.Line,Path:c.Path,Rect:u.Rect,RegularPolygon:p.RegularPolygon,Ring:g.Ring,Sprite:m.Sprite,Star:f.Star,Text:v.Text,TextPath:y.TextPath,Transformer:b.Transformer,Wedge:_.Wedge,Filters:{Blur:w.Blur,Brighten:C.Brighten,Contrast:A.Contrast,Emboss:S.Emboss,Enhance:x.Enhance,Grayscale:k.Grayscale,HSL:L.HSL,HSV:E.HSV,Invert:M.Invert,Kaleidoscope:T.Kaleidoscope,Mask:F.Mask,Noise:D.Noise,Pixelate:P.Pixelate,Posterize:I.Posterize,RGB:N.RGB,RGBA:R.RGBA,Sepia:O.Sepia,Solarize:B.Solarize,Threshold:G.Threshold}})},615:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Blur=void 0;const a=i(9658),r=i(6205),s=i(7723);function n(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var o=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],l=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function h(t,e){var i,a,r,s,h,d,c,u,p,g,m,f,v,y,b,_,w,C,A,S,x,k,L,E,M=t.data,T=t.width,F=t.height,D=e+e+1,P=T-1,I=F-1,N=e+1,R=N*(N+1)/2,O=new n,B=null,G=O,U=null,z=null,W=o[e],V=l[e];for(r=1;r<D;r++)G=G.next=new n,r===N&&(B=G);for(G.next=O,c=d=0,a=0;a<F;a++){for(_=w=C=A=u=p=g=m=0,f=N*(S=M[d]),v=N*(x=M[d+1]),y=N*(k=M[d+2]),b=N*(L=M[d+3]),u+=R*S,p+=R*x,g+=R*k,m+=R*L,G=O,r=0;r<N;r++)G.r=S,G.g=x,G.b=k,G.a=L,G=G.next;for(r=1;r<N;r++)s=d+((P<r?P:r)<<2),u+=(G.r=S=M[s])*(E=N-r),p+=(G.g=x=M[s+1])*E,g+=(G.b=k=M[s+2])*E,m+=(G.a=L=M[s+3])*E,_+=S,w+=x,C+=k,A+=L,G=G.next;for(U=O,z=B,i=0;i<T;i++)M[d+3]=L=m*W>>V,0!==L?(L=255/L,M[d]=(u*W>>V)*L,M[d+1]=(p*W>>V)*L,M[d+2]=(g*W>>V)*L):M[d]=M[d+1]=M[d+2]=0,u-=f,p-=v,g-=y,m-=b,f-=U.r,v-=U.g,y-=U.b,b-=U.a,s=c+((s=i+e+1)<P?s:P)<<2,_+=U.r=M[s],w+=U.g=M[s+1],C+=U.b=M[s+2],A+=U.a=M[s+3],u+=_,p+=w,g+=C,m+=A,U=U.next,f+=S=z.r,v+=x=z.g,y+=k=z.b,b+=L=z.a,_-=S,w-=x,C-=k,A-=L,z=z.next,d+=4;c+=T}for(i=0;i<T;i++){for(w=C=A=_=p=g=m=u=0,d=i<<2,f=N*(S=M[d]),v=N*(x=M[d+1]),y=N*(k=M[d+2]),b=N*(L=M[d+3]),u+=R*S,p+=R*x,g+=R*k,m+=R*L,G=O,r=0;r<N;r++)G.r=S,G.g=x,G.b=k,G.a=L,G=G.next;for(h=T,r=1;r<=e;r++)d=h+i<<2,u+=(G.r=S=M[d])*(E=N-r),p+=(G.g=x=M[d+1])*E,g+=(G.b=k=M[d+2])*E,m+=(G.a=L=M[d+3])*E,_+=S,w+=x,C+=k,A+=L,G=G.next,r<I&&(h+=T);for(d=i,U=O,z=B,a=0;a<F;a++)s=d<<2,M[s+3]=L=m*W>>V,L>0?(L=255/L,M[s]=(u*W>>V)*L,M[s+1]=(p*W>>V)*L,M[s+2]=(g*W>>V)*L):M[s]=M[s+1]=M[s+2]=0,u-=f,p-=v,g-=y,m-=b,f-=U.r,v-=U.g,y-=U.b,b-=U.a,s=i+((s=a+N)<I?s:I)*T<<2,u+=_+=U.r=M[s],p+=w+=U.g=M[s+1],g+=C+=U.b=M[s+2],m+=A+=U.a=M[s+3],U=U.next,f+=S=z.r,v+=x=z.g,y+=k=z.b,b+=L=z.a,_-=S,w-=x,C-=k,A-=L,z=z.next,d+=T}}const d=function(t){var e=Math.round(this.blurRadius());e>0&&h(t,e)};e.Blur=d,a.Factory.addGetterSetter(r.Node,"blurRadius",0,(0,s.getNumberValidator)(),a.Factory.afterSetFilter)},9643:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Brighten=void 0;const a=i(9658),r=i(6205),s=i(7723),n=function(t){var e,i=255*this.brightness(),a=t.data,r=a.length;for(e=0;e<r;e+=4)a[e]+=i,a[e+1]+=i,a[e+2]+=i};e.Brighten=n,a.Factory.addGetterSetter(r.Node,"brightness",0,(0,s.getNumberValidator)(),a.Factory.afterSetFilter)},9273:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Contrast=void 0;const a=i(9658),r=i(6205),s=i(7723),n=function(t){var e,i=Math.pow((this.contrast()+100)/100,2),a=t.data,r=a.length,s=150,n=150,o=150;for(e=0;e<r;e+=4)s=a[e],n=a[e+1],o=a[e+2],s/=255,s-=.5,s*=i,s+=.5,s*=255,n/=255,n-=.5,n*=i,n+=.5,n*=255,o/=255,o-=.5,o*=i,o+=.5,o*=255,s=s<0?0:s>255?255:s,n=n<0?0:n>255?255:n,o=o<0?0:o>255?255:o,a[e]=s,a[e+1]=n,a[e+2]=o};e.Contrast=n,a.Factory.addGetterSetter(r.Node,"contrast",0,(0,s.getNumberValidator)(),a.Factory.afterSetFilter)},2528:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Emboss=void 0;const a=i(9658),r=i(6205),s=i(8007),n=i(7723),o=function(t){var e=10*this.embossStrength(),i=255*this.embossWhiteLevel(),a=this.embossDirection(),r=this.embossBlend(),n=0,o=0,l=t.data,h=t.width,d=t.height,c=4*h,u=d;switch(a){case"top-left":n=-1,o=-1;break;case"top":n=-1,o=0;break;case"top-right":n=-1,o=1;break;case"right":n=0,o=1;break;case"bottom-right":n=1,o=1;break;case"bottom":n=1,o=0;break;case"bottom-left":n=1,o=-1;break;case"left":n=0,o=-1;break;default:s.Util.error("Unknown emboss direction: "+a)}do{var p=(u-1)*c,g=n;u+g<1&&(g=0),u+g>d&&(g=0);var m=(u-1+g)*h*4,f=h;do{var v=p+4*(f-1),y=o;f+y<1&&(y=0),f+y>h&&(y=0);var b=m+4*(f-1+y),_=l[v]-l[b],w=l[v+1]-l[b+1],C=l[v+2]-l[b+2],A=_,S=A>0?A:-A,x=w>0?w:-w,k=C>0?C:-C;if(x>S&&(A=w),k>S&&(A=C),A*=e,r){var L=l[v]+A,E=l[v+1]+A,M=l[v+2]+A;l[v]=L>255?255:L<0?0:L,l[v+1]=E>255?255:E<0?0:E,l[v+2]=M>255?255:M<0?0:M}else{var T=i-A;T<0?T=0:T>255&&(T=255),l[v]=l[v+1]=l[v+2]=T}}while(--f)}while(--u)};e.Emboss=o,a.Factory.addGetterSetter(r.Node,"embossStrength",.5,(0,n.getNumberValidator)(),a.Factory.afterSetFilter),a.Factory.addGetterSetter(r.Node,"embossWhiteLevel",.5,(0,n.getNumberValidator)(),a.Factory.afterSetFilter),a.Factory.addGetterSetter(r.Node,"embossDirection","top-left",null,a.Factory.afterSetFilter),a.Factory.addGetterSetter(r.Node,"embossBlend",!1,null,a.Factory.afterSetFilter)},1304:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Enhance=void 0;const a=i(9658),r=i(6205),s=i(7723);function n(t,e,i,a,r){var s,n=i-e,o=r-a;return 0===n?a+o/2:0===o?a:(s=(t-e)/n,s=o*s+a,s)}const o=function(t){var e,i,a,r,s=t.data,o=s.length,l=s[0],h=l,d=s[1],c=d,u=s[2],p=u,g=this.enhance();if(0!==g){for(r=0;r<o;r+=4)e=s[r+0],e<l?l=e:e>h&&(h=e),i=s[r+1],i<d?d=i:i>c&&(c=i),a=s[r+2],a<u?u=a:a>p&&(p=a);var m,f,v,y,b,_,w,C,A;for(h===l&&(h=255,l=0),c===d&&(c=255,d=0),p===u&&(p=255,u=0),g>0?(f=h+g*(255-h),v=l-g*(l-0),b=c+g*(255-c),_=d-g*(d-0),C=p+g*(255-p),A=u-g*(u-0)):(m=.5*(h+l),f=h+g*(h-m),v=l+g*(l-m),y=.5*(c+d),b=c+g*(c-y),_=d+g*(d-y),w=.5*(p+u),C=p+g*(p-w),A=u+g*(u-w)),r=0;r<o;r+=4)s[r+0]=n(s[r+0],l,h,v,f),s[r+1]=n(s[r+1],d,c,_,b),s[r+2]=n(s[r+2],u,p,A,C)}};e.Enhance=o,a.Factory.addGetterSetter(r.Node,"enhance",0,(0,s.getNumberValidator)(),a.Factory.afterSetFilter)},2998:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Grayscale=void 0;const i=function(t){var e,i,a=t.data,r=a.length;for(e=0;e<r;e+=4)i=.34*a[e]+.5*a[e+1]+.16*a[e+2],a[e]=i,a[e+1]=i,a[e+2]=i};e.Grayscale=i},1433:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.HSL=void 0;const a=i(9658),r=i(6205),s=i(7723);a.Factory.addGetterSetter(r.Node,"hue",0,(0,s.getNumberValidator)(),a.Factory.afterSetFilter),a.Factory.addGetterSetter(r.Node,"saturation",0,(0,s.getNumberValidator)(),a.Factory.afterSetFilter),a.Factory.addGetterSetter(r.Node,"luminance",0,(0,s.getNumberValidator)(),a.Factory.afterSetFilter);const n=function(t){var e,i,a,r,s,n=t.data,o=n.length,l=1,h=Math.pow(2,this.saturation()),d=Math.abs(this.hue()+360)%360,c=127*this.luminance(),u=l*h*Math.cos(d*Math.PI/180),p=l*h*Math.sin(d*Math.PI/180),g=.299*l+.701*u+.167*p,m=.587*l-.587*u+.33*p,f=.114*l-.114*u-.497*p,v=.299*l-.299*u-.328*p,y=.587*l+.413*u+.035*p,b=.114*l-.114*u+.293*p,_=.299*l-.3*u+1.25*p,w=.587*l-.586*u-1.05*p,C=.114*l+.886*u-.2*p;for(e=0;e<o;e+=4)i=n[e+0],a=n[e+1],r=n[e+2],s=n[e+3],n[e+0]=g*i+m*a+f*r+c,n[e+1]=v*i+y*a+b*r+c,n[e+2]=_*i+w*a+C*r+c,n[e+3]=s};e.HSL=n},3607:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.HSV=void 0;const a=i(9658),r=i(6205),s=i(7723),n=function(t){var e,i,a,r,s,n=t.data,o=n.length,l=Math.pow(2,this.value()),h=Math.pow(2,this.saturation()),d=Math.abs(this.hue()+360)%360,c=l*h*Math.cos(d*Math.PI/180),u=l*h*Math.sin(d*Math.PI/180),p=.299*l+.701*c+.167*u,g=.587*l-.587*c+.33*u,m=.114*l-.114*c-.497*u,f=.299*l-.299*c-.328*u,v=.587*l+.413*c+.035*u,y=.114*l-.114*c+.293*u,b=.299*l-.3*c+1.25*u,_=.587*l-.586*c-1.05*u,w=.114*l+.886*c-.2*u;for(e=0;e<o;e+=4)i=n[e+0],a=n[e+1],r=n[e+2],s=n[e+3],n[e+0]=p*i+g*a+m*r,n[e+1]=f*i+v*a+y*r,n[e+2]=b*i+_*a+w*r,n[e+3]=s};e.HSV=n,a.Factory.addGetterSetter(r.Node,"hue",0,(0,s.getNumberValidator)(),a.Factory.afterSetFilter),a.Factory.addGetterSetter(r.Node,"saturation",0,(0,s.getNumberValidator)(),a.Factory.afterSetFilter),a.Factory.addGetterSetter(r.Node,"value",0,(0,s.getNumberValidator)(),a.Factory.afterSetFilter)},1189:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Invert=void 0;const i=function(t){var e,i=t.data,a=i.length;for(e=0;e<a;e+=4)i[e]=255-i[e],i[e+1]=255-i[e+1],i[e+2]=255-i[e+2]};e.Invert=i},6359:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Kaleidoscope=void 0;const a=i(9658),r=i(6205),s=i(8007),n=i(7723);var o=function(t,e,i){var a,r,s,n,o=t.data,l=e.data,h=t.width,d=t.height,c=i.polarCenterX||h/2,u=i.polarCenterY||d/2,p=0,g=0,m=0,f=0,v=Math.sqrt(c*c+u*u);r=h-c,s=d-u,n=Math.sqrt(r*r+s*s),v=n>v?n:v;var y,b,_,w,C=d,A=h,S=360/A*Math.PI/180;for(b=0;b<A;b+=1)for(_=Math.sin(b*S),w=Math.cos(b*S),y=0;y<C;y+=1)r=Math.floor(c+v*y/C*w),s=Math.floor(u+v*y/C*_),a=4*(s*h+r),p=o[a+0],g=o[a+1],m=o[a+2],f=o[a+3],a=4*(b+y*h),l[a+0]=p,l[a+1]=g,l[a+2]=m,l[a+3]=f},l=function(t,e,i){var a,r,s,n,o,l,h=t.data,d=e.data,c=t.width,u=t.height,p=i.polarCenterX||c/2,g=i.polarCenterY||u/2,m=0,f=0,v=0,y=0,b=Math.sqrt(p*p+g*g);r=c-p,s=u-g,l=Math.sqrt(r*r+s*s),b=l>b?l:b;var _,w,C,A,S=u,x=c,k=i.polarRotation||0;for(r=0;r<c;r+=1)for(s=0;s<u;s+=1)n=r-p,o=s-g,_=Math.sqrt(n*n+o*o)*S/b,w=(180*Math.atan2(o,n)/Math.PI+360+k)%360,w=w*x/360,C=Math.floor(w),A=Math.floor(_),a=4*(A*c+C),m=h[a+0],f=h[a+1],v=h[a+2],y=h[a+3],a=4*(s*c+r),d[a+0]=m,d[a+1]=f,d[a+2]=v,d[a+3]=y};const h=function(t){var e,i,a,r,n,h,d,c,u,p,g=t.width,m=t.height,f=Math.round(this.kaleidoscopePower()),v=Math.round(this.kaleidoscopeAngle()),y=Math.floor(g*(v%360)/360);if(!(f<1)){var b=s.Util.createCanvasElement();b.width=g,b.height=m;var _=b.getContext("2d").getImageData(0,0,g,m);s.Util.releaseCanvas(b),o(t,_,{polarCenterX:g/2,polarCenterY:m/2});var w=g/Math.pow(2,f);while(w<=8)w*=2,f-=1;w=Math.ceil(w);var C=w,A=0,S=C,x=1;for(y+w>g&&(A=C,S=0,x=-1),i=0;i<m;i+=1)for(e=A;e!==S;e+=x)a=Math.round(e+y)%g,u=4*(g*i+a),n=_.data[u+0],h=_.data[u+1],d=_.data[u+2],c=_.data[u+3],p=4*(g*i+e),_.data[p+0]=n,_.data[p+1]=h,_.data[p+2]=d,_.data[p+3]=c;for(i=0;i<m;i+=1)for(C=Math.floor(w),r=0;r<f;r+=1){for(e=0;e<C+1;e+=1)u=4*(g*i+e),n=_.data[u+0],h=_.data[u+1],d=_.data[u+2],c=_.data[u+3],p=4*(g*i+2*C-e-1),_.data[p+0]=n,_.data[p+1]=h,_.data[p+2]=d,_.data[p+3]=c;C*=2}l(_,t,{polarRotation:0})}};e.Kaleidoscope=h,a.Factory.addGetterSetter(r.Node,"kaleidoscopePower",2,(0,n.getNumberValidator)(),a.Factory.afterSetFilter),a.Factory.addGetterSetter(r.Node,"kaleidoscopeAngle",0,(0,n.getNumberValidator)(),a.Factory.afterSetFilter)},9482:function(t,e,i){i(560),Object.defineProperty(e,"__esModule",{value:!0}),e.Mask=void 0;const a=i(9658),r=i(6205),s=i(7723);function n(t,e,i){var a=4*(i*t.width+e),r=[];return r.push(t.data[a++],t.data[a++],t.data[a++],t.data[a++]),r}function o(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}function l(t){for(var e=[0,0,0],i=0;i<t.length;i++)e[0]+=t[i][0],e[1]+=t[i][1],e[2]+=t[i][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}function h(t,e){var i=n(t,0,0),a=n(t,t.width-1,0),r=n(t,0,t.height-1),s=n(t,t.width-1,t.height-1),h=e||10;if(o(i,a)<h&&o(a,s)<h&&o(s,r)<h&&o(r,i)<h){for(var d=l([a,i,s,r]),c=[],u=0;u<t.width*t.height;u++){var p=o(d,[t.data[4*u],t.data[4*u+1],t.data[4*u+2]]);c[u]=p<h?0:255}return c}}function d(t,e){for(var i=0;i<t.width*t.height;i++)t.data[4*i+3]=e[i]}function c(t,e,i){for(var a=[1,1,1,1,0,1,1,1,1],r=Math.round(Math.sqrt(a.length)),s=Math.floor(r/2),n=[],o=0;o<i;o++)for(var l=0;l<e;l++){for(var h=o*e+l,d=0,c=0;c<r;c++)for(var u=0;u<r;u++){var p=o+c-s,g=l+u-s;if(p>=0&&p<i&&g>=0&&g<e){var m=p*e+g,f=a[c*r+u];d+=t[m]*f}}n[h]=2040===d?255:0}return n}function u(t,e,i){for(var a=[1,1,1,1,1,1,1,1,1],r=Math.round(Math.sqrt(a.length)),s=Math.floor(r/2),n=[],o=0;o<i;o++)for(var l=0;l<e;l++){for(var h=o*e+l,d=0,c=0;c<r;c++)for(var u=0;u<r;u++){var p=o+c-s,g=l+u-s;if(p>=0&&p<i&&g>=0&&g<e){var m=p*e+g,f=a[c*r+u];d+=t[m]*f}}n[h]=d>=1020?255:0}return n}function p(t,e,i){for(var a=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],r=Math.round(Math.sqrt(a.length)),s=Math.floor(r/2),n=[],o=0;o<i;o++)for(var l=0;l<e;l++){for(var h=o*e+l,d=0,c=0;c<r;c++)for(var u=0;u<r;u++){var p=o+c-s,g=l+u-s;if(p>=0&&p<i&&g>=0&&g<e){var m=p*e+g,f=a[c*r+u];d+=t[m]*f}}n[h]=d}return n}const g=function(t){var e=this.threshold(),i=h(t,e);return i&&(i=c(i,t.width,t.height),i=u(i,t.width,t.height),i=p(i,t.width,t.height),d(t,i)),t};e.Mask=g,a.Factory.addGetterSetter(r.Node,"threshold",0,(0,s.getNumberValidator)(),a.Factory.afterSetFilter)},7019:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Noise=void 0;const a=i(9658),r=i(6205),s=i(7723),n=function(t){var e,i=255*this.noise(),a=t.data,r=a.length,s=i/2;for(e=0;e<r;e+=4)a[e+0]+=s-2*s*Math.random(),a[e+1]+=s-2*s*Math.random(),a[e+2]+=s-2*s*Math.random()};e.Noise=n,a.Factory.addGetterSetter(r.Node,"noise",.2,(0,s.getNumberValidator)(),a.Factory.afterSetFilter)},3707:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Pixelate=void 0;const a=i(9658),r=i(8007),s=i(6205),n=i(7723),o=function(t){var e,i,a,s,n,o,l,h,d,c,u,p,g,m,f=Math.ceil(this.pixelSize()),v=t.width,y=t.height,b=Math.ceil(v/f),_=Math.ceil(y/f),w=t.data;if(f<=0)r.Util.error("pixelSize value can not be <= 0");else for(p=0;p<b;p+=1)for(g=0;g<_;g+=1){for(s=0,n=0,o=0,l=0,h=p*f,d=h+f,c=g*f,u=c+f,m=0,e=h;e<d;e+=1)if(!(e>=v))for(i=c;i<u;i+=1)i>=y||(a=4*(v*i+e),s+=w[a+0],n+=w[a+1],o+=w[a+2],l+=w[a+3],m+=1);for(s/=m,n/=m,o/=m,l/=m,e=h;e<d;e+=1)if(!(e>=v))for(i=c;i<u;i+=1)i>=y||(a=4*(v*i+e),w[a+0]=s,w[a+1]=n,w[a+2]=o,w[a+3]=l)}};e.Pixelate=o,a.Factory.addGetterSetter(s.Node,"pixelSize",8,(0,n.getNumberValidator)(),a.Factory.afterSetFilter)},8391:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Posterize=void 0;const a=i(9658),r=i(6205),s=i(7723),n=function(t){var e,i=Math.round(254*this.levels())+1,a=t.data,r=a.length,s=255/i;for(e=0;e<r;e+=1)a[e]=Math.floor(a[e]/s)*s};e.Posterize=n,a.Factory.addGetterSetter(r.Node,"levels",.5,(0,s.getNumberValidator)(),a.Factory.afterSetFilter)},211:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.RGB=void 0;const a=i(9658),r=i(6205),s=i(7723),n=function(t){var e,i,a=t.data,r=a.length,s=this.red(),n=this.green(),o=this.blue();for(e=0;e<r;e+=4)i=(.34*a[e]+.5*a[e+1]+.16*a[e+2])/255,a[e]=i*s,a[e+1]=i*n,a[e+2]=i*o,a[e+3]=a[e+3]};e.RGB=n,a.Factory.addGetterSetter(r.Node,"red",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),a.Factory.addGetterSetter(r.Node,"green",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),a.Factory.addGetterSetter(r.Node,"blue",0,s.RGBComponent,a.Factory.afterSetFilter)},5992:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.RGBA=void 0;const a=i(9658),r=i(6205),s=i(7723),n=function(t){var e,i,a=t.data,r=a.length,s=this.red(),n=this.green(),o=this.blue(),l=this.alpha();for(e=0;e<r;e+=4)i=1-l,a[e]=s*l+a[e]*i,a[e+1]=n*l+a[e+1]*i,a[e+2]=o*l+a[e+2]*i};e.RGBA=n,a.Factory.addGetterSetter(r.Node,"red",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),a.Factory.addGetterSetter(r.Node,"green",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),a.Factory.addGetterSetter(r.Node,"blue",0,s.RGBComponent,a.Factory.afterSetFilter),a.Factory.addGetterSetter(r.Node,"alpha",1,(function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t}))},6768:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Sepia=void 0;const i=function(t){var e,i,a,r,s=t.data,n=s.length;for(e=0;e<n;e+=4)i=s[e+0],a=s[e+1],r=s[e+2],s[e+0]=Math.min(255,.393*i+.769*a+.189*r),s[e+1]=Math.min(255,.349*i+.686*a+.168*r),s[e+2]=Math.min(255,.272*i+.534*a+.131*r)};e.Sepia=i},9743:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Solarize=void 0;const i=function(t){var e=t.data,i=t.width,a=t.height,r=4*i,s=a;do{var n=(s-1)*r,o=i;do{var l=n+4*(o-1),h=e[l],d=e[l+1],c=e[l+2];h>127&&(h=255-h),d>127&&(d=255-d),c>127&&(c=255-c),e[l]=h,e[l+1]=d,e[l+2]=c}while(--o)}while(--s)};e.Solarize=i},6090:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Threshold=void 0;const a=i(9658),r=i(6205),s=i(7723),n=function(t){var e,i=255*this.threshold(),a=t.data,r=a.length;for(e=0;e<r;e+=1)a[e]=a[e]<i?0:255};e.Threshold=n,a.Factory.addGetterSetter(r.Node,"threshold",.5,(0,s.getNumberValidator)(),a.Factory.afterSetFilter)},7975:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});const a=i(8158);t.exports=a.Konva},3515:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Arc=void 0;const a=i(9658),r=i(4718),s=i(3552),n=i(7723),o=i(3552);class l extends r.Shape{_sceneFunc(t){var e=s.Konva.getAngle(this.angle()),i=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,e,i),t.arc(0,0,this.innerRadius(),e,0,!i),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),e=this.outerRadius(),i=this.clockwise(),a=s.Konva.getAngle(i?360-this.angle():this.angle()),r=Math.cos(Math.min(a,Math.PI)),n=1,o=Math.sin(Math.min(Math.max(Math.PI,a),3*Math.PI/2)),l=Math.sin(Math.min(a,Math.PI/2)),h=r*(r>0?t:e),d=n*(n>0?e:t),c=o*(o>0?t:e),u=l*(l>0?e:t);return{x:h,y:i?-1*u:c,width:d-h,height:u-c}}}e.Arc=l,l.prototype._centroid=!0,l.prototype.className="Arc",l.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,o._registerNode)(l),a.Factory.addGetterSetter(l,"innerRadius",0,(0,n.getNumberValidator)()),a.Factory.addGetterSetter(l,"outerRadius",0,(0,n.getNumberValidator)()),a.Factory.addGetterSetter(l,"angle",0,(0,n.getNumberValidator)()),a.Factory.addGetterSetter(l,"clockwise",!1,(0,n.getBooleanValidator)())},7555:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Arrow=void 0;const a=i(9658),r=i(6283),s=i(7723),n=i(3552),o=i(988);class l extends r.Line{_sceneFunc(t){super._sceneFunc(t);var e=2*Math.PI,i=this.points(),a=i,r=0!==this.tension()&&i.length>4;r&&(a=this.getTensionPoints());var s,n,l=this.pointerLength(),h=i.length;if(r){const t=[a[a.length-4],a[a.length-3],a[a.length-2],a[a.length-1],i[h-2],i[h-1]],e=o.Path.calcLength(a[a.length-4],a[a.length-3],"C",t),r=o.Path.getPointOnQuadraticBezier(Math.min(1,1-l/e),t[0],t[1],t[2],t[3],t[4],t[5]);s=i[h-2]-r.x,n=i[h-1]-r.y}else s=i[h-2]-i[h-4],n=i[h-1]-i[h-3];var d=(Math.atan2(n,s)+e)%e,c=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(i[h-2],i[h-1]),t.rotate(d),t.moveTo(0,0),t.lineTo(-l,c/2),t.lineTo(-l,-c/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(i[0],i[1]),r?(s=(a[0]+a[2])/2-i[0],n=(a[1]+a[3])/2-i[1]):(s=i[2]-i[0],n=i[3]-i[1]),t.rotate((Math.atan2(-n,-s)+e)%e),t.moveTo(0,0),t.lineTo(-l,c/2),t.lineTo(-l,-c/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){var e=this.dashEnabled();e&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),e&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),e=this.pointerWidth()/2;return{x:t.x-e,y:t.y-e,width:t.width+2*e,height:t.height+2*e}}}e.Arrow=l,l.prototype.className="Arrow",(0,n._registerNode)(l),a.Factory.addGetterSetter(l,"pointerLength",10,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(l,"pointerWidth",10,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(l,"pointerAtBeginning",!1),a.Factory.addGetterSetter(l,"pointerAtEnding",!0)},3019:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Circle=void 0;const a=i(9658),r=i(4718),s=i(7723),n=i(3552);class o extends r.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,2*Math.PI,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}}e.Circle=o,o.prototype._centroid=!0,o.prototype.className="Circle",o.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(o),a.Factory.addGetterSetter(o,"radius",0,(0,s.getNumberValidator)())},2378:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Ellipse=void 0;const a=i(9658),r=i(4718),s=i(7723),n=i(3552);class o extends r.Shape{_sceneFunc(t){var e=this.radiusX(),i=this.radiusY();t.beginPath(),t.save(),e!==i&&t.scale(1,i/e),t.arc(0,0,e,0,2*Math.PI,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radiusX()}getHeight(){return 2*this.radiusY()}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}e.Ellipse=o,o.prototype.className="Ellipse",o.prototype._centroid=!0,o.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,n._registerNode)(o),a.Factory.addComponentsGetterSetter(o,"radius",["x","y"]),a.Factory.addGetterSetter(o,"radiusX",0,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(o,"radiusY",0,(0,s.getNumberValidator)())},2420:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Image=void 0;const a=i(8007),r=i(9658),s=i(4718),n=i(3552),o=i(7723);class l extends s.Shape{constructor(t){super(t),this.on("imageChange.konva",(()=>{this._setImageLoad()})),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&4===t.readyState||t&&t["addEventListener"]&&t["addEventListener"]("load",(()=>{this._requestDraw()}))}_useBufferCanvas(){const t=!!this.cornerRadius(),e=this.hasShadow();return!(!t||!e)||super._useBufferCanvas(!0)}_sceneFunc(t){const e=this.getWidth(),i=this.getHeight(),r=this.cornerRadius(),s=this.attrs.image;let n;if(s){const t=this.attrs.cropWidth,a=this.attrs.cropHeight;n=t&&a?[s,this.cropX(),this.cropY(),t,a,0,0,e,i]:[s,0,0,e,i]}(this.hasFill()||this.hasStroke()||r)&&(t.beginPath(),r?a.Util.drawRoundedRectPath(t,e,i,r):t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)),s&&(r&&t.clip(),t.drawImage.apply(t,n))}_hitFunc(t){var e=this.width(),i=this.height(),r=this.cornerRadius();t.beginPath(),r?a.Util.drawRoundedRectPath(t,e,i,r):t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,e;return null!==(t=this.attrs.width)&&void 0!==t?t:null===(e=this.image())||void 0===e?void 0:e.width}getHeight(){var t,e;return null!==(t=this.attrs.height)&&void 0!==t?t:null===(e=this.image())||void 0===e?void 0:e.height}static fromURL(t,e,i=null){var r=a.Util.createImageElement();r.onload=function(){var t=new l({image:r});e(t)},r.onerror=i,r.crossOrigin="Anonymous",r.src=t}}e.Image=l,l.prototype.className="Image",(0,n._registerNode)(l),r.Factory.addGetterSetter(l,"cornerRadius",0,(0,o.getNumberOrArrayOfNumbersValidator)(4)),r.Factory.addGetterSetter(l,"image"),r.Factory.addComponentsGetterSetter(l,"crop",["x","y","width","height"]),r.Factory.addGetterSetter(l,"cropX",0,(0,o.getNumberValidator)()),r.Factory.addGetterSetter(l,"cropY",0,(0,o.getNumberValidator)()),r.Factory.addGetterSetter(l,"cropWidth",0,(0,o.getNumberValidator)()),r.Factory.addGetterSetter(l,"cropHeight",0,(0,o.getNumberValidator)())},7036:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Tag=e.Label=void 0;const a=i(9658),r=i(4718),s=i(1763),n=i(7723),o=i(3552);var l=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],h="Change.konva",d="none",c="up",u="right",p="down",g="left",m=l.length;class f extends s.Group{constructor(t){super(t),this.on("add.konva",(function(t){this._addListeners(t.child),this._sync()}))}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){var e,i=this,a=function(){i._sync()};for(e=0;e<m;e++)t.on(l[e]+h,a)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){var t,e,i,a,r,s,n,o=this.getText(),l=this.getTag();if(o&&l){switch(t=o.width(),e=o.height(),i=l.pointerDirection(),a=l.pointerWidth(),n=l.pointerHeight(),r=0,s=0,i){case c:r=t/2,s=-1*n;break;case u:r=t+a,s=e/2;break;case p:r=t/2,s=e+n;break;case g:r=-1*a,s=e/2;break}l.setAttrs({x:-1*r,y:-1*s,width:t,height:e}),o.setAttrs({x:-1*r,y:-1*s})}}}e.Label=f,f.prototype.className="Label",(0,o._registerNode)(f);class v extends r.Shape{_sceneFunc(t){var e=this.width(),i=this.height(),a=this.pointerDirection(),r=this.pointerWidth(),s=this.pointerHeight(),n=this.cornerRadius();let o=0,l=0,h=0,d=0;"number"===typeof n?o=l=h=d=Math.min(n,e/2,i/2):(o=Math.min(n[0]||0,e/2,i/2),l=Math.min(n[1]||0,e/2,i/2),d=Math.min(n[2]||0,e/2,i/2),h=Math.min(n[3]||0,e/2,i/2)),t.beginPath(),t.moveTo(o,0),a===c&&(t.lineTo((e-r)/2,0),t.lineTo(e/2,-1*s),t.lineTo((e+r)/2,0)),t.lineTo(e-l,0),t.arc(e-l,l,l,3*Math.PI/2,0,!1),a===u&&(t.lineTo(e,(i-s)/2),t.lineTo(e+r,i/2),t.lineTo(e,(i+s)/2)),t.lineTo(e,i-d),t.arc(e-d,i-d,d,0,Math.PI/2,!1),a===p&&(t.lineTo((e+r)/2,i),t.lineTo(e/2,i+s),t.lineTo((e-r)/2,i)),t.lineTo(h,i),t.arc(h,i-h,h,Math.PI/2,Math.PI,!1),a===g&&(t.lineTo(0,(i+s)/2),t.lineTo(-1*r,i/2),t.lineTo(0,(i-s)/2)),t.lineTo(0,o),t.arc(o,o,o,Math.PI,3*Math.PI/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){var t=0,e=0,i=this.pointerWidth(),a=this.pointerHeight(),r=this.pointerDirection(),s=this.width(),n=this.height();return r===c?(e-=a,n+=a):r===p?n+=a:r===g?(t-=1.5*i,s+=i):r===u&&(s+=1.5*i),{x:t,y:e,width:s,height:n}}}e.Tag=v,v.prototype.className="Tag",(0,o._registerNode)(v),a.Factory.addGetterSetter(v,"pointerDirection",d),a.Factory.addGetterSetter(v,"pointerWidth",0,(0,n.getNumberValidator)()),a.Factory.addGetterSetter(v,"pointerHeight",0,(0,n.getNumberValidator)()),a.Factory.addGetterSetter(v,"cornerRadius",0,(0,n.getNumberOrArrayOfNumbersValidator)(4))},6283:function(t,e,i){i(560),Object.defineProperty(e,"__esModule",{value:!0}),e.Line=void 0;const a=i(9658),r=i(4718),s=i(7723),n=i(3552);function o(t,e,i,a,r,s,n){var o=Math.sqrt(Math.pow(i-t,2)+Math.pow(a-e,2)),l=Math.sqrt(Math.pow(r-i,2)+Math.pow(s-a,2)),h=n*o/(o+l),d=n*l/(o+l),c=i-h*(r-t),u=a-h*(s-e),p=i+d*(r-t),g=a+d*(s-e);return[c,u,p,g]}function l(t,e){var i,a,r=t.length,s=[];for(i=2;i<r-2;i+=2)a=o(t[i-2],t[i-1],t[i],t[i+1],t[i+2],t[i+3],e),isNaN(a[0])||(s.push(a[0]),s.push(a[1]),s.push(t[i]),s.push(t[i+1]),s.push(a[2]),s.push(a[3]));return s}class h extends r.Shape{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",(function(){this._clearCache("tensionPoints")}))}_sceneFunc(t){var e,i,a,r=this.points(),s=r.length,n=this.tension(),o=this.closed(),l=this.bezier();if(s){if(t.beginPath(),t.moveTo(r[0],r[1]),0!==n&&s>4){e=this.getTensionPoints(),i=e.length,a=o?0:4,o||t.quadraticCurveTo(e[0],e[1],e[2],e[3]);while(a<i-2)t.bezierCurveTo(e[a++],e[a++],e[a++],e[a++],e[a++],e[a++]);o||t.quadraticCurveTo(e[i-2],e[i-1],r[s-2],r[s-1])}else if(l){a=2;while(a<s)t.bezierCurveTo(r[a++],r[a++],r[a++],r[a++],r[a++],r[a++])}else for(a=2;a<s;a+=2)t.lineTo(r[a],r[a+1]);o?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():l(this.points(),this.tension())}_getTensionPointsClosed(){var t=this.points(),e=t.length,i=this.tension(),a=o(t[e-2],t[e-1],t[0],t[1],t[2],t[3],i),r=o(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],i),s=l(t,i),n=[a[2],a[3]].concat(s).concat([r[0],r[1],t[e-2],t[e-1],r[2],r[3],a[0],a[1],t[0],t[1]]);return n}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){var t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};t=0!==this.tension()?[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:this.points();for(var e,i,a=t[0],r=t[0],s=t[1],n=t[1],o=0;o<t.length/2;o++)e=t[2*o],i=t[2*o+1],a=Math.min(a,e),r=Math.max(r,e),s=Math.min(s,i),n=Math.max(n,i);return{x:a,y:s,width:r-a,height:n-s}}}e.Line=h,h.prototype.className="Line",h.prototype._attrsAffectingSize=["points","bezier","tension"],(0,n._registerNode)(h),a.Factory.addGetterSetter(h,"closed",!1),a.Factory.addGetterSetter(h,"bezier",!1),a.Factory.addGetterSetter(h,"tension",0,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(h,"points",[],(0,s.getNumberArrayValidator)())},988:function(t,e,i){i(560),Object.defineProperty(e,"__esModule",{value:!0}),e.Path=void 0;const a=i(9658),r=i(4718),s=i(3552),n=i(125);class o extends r.Shape{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",(function(){this._readDataAttribute()}))}_readDataAttribute(){this.dataArray=o.parsePathData(this.data()),this.pathLength=o.getPathLength(this.dataArray)}_sceneFunc(t){var e=this.dataArray;t.beginPath();for(var i=!1,a=0;a<e.length;a++){var r=e[a].command,s=e[a].points;switch(r){case"L":t.lineTo(s[0],s[1]);break;case"M":t.moveTo(s[0],s[1]);break;case"C":t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"Q":t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case"A":var n=s[0],o=s[1],l=s[2],h=s[3],d=s[4],c=s[5],u=s[6],p=s[7],g=l>h?l:h,m=l>h?1:l/h,f=l>h?h/l:1;t.translate(n,o),t.rotate(u),t.scale(m,f),t.arc(0,0,g,d,d+c,1-p),t.scale(1/m,1/f),t.rotate(-u),t.translate(-n,-o);break;case"z":i=!0,t.closePath();break}}i||this.hasFill()?t.fillStrokeShape(this):t.strokeShape(this)}getSelfRect(){var t=[];this.dataArray.forEach((function(e){if("A"===e.command){var i=e.points[4],a=e.points[5],r=e.points[4]+a,s=Math.PI/180;if(Math.abs(i-r)<s&&(s=Math.abs(i-r)),a<0)for(let a=i-s;a>r;a-=s){const i=o.getPointOnEllipticalArc(e.points[0],e.points[1],e.points[2],e.points[3],a,0);t.push(i.x,i.y)}else for(let a=i+s;a<r;a+=s){const i=o.getPointOnEllipticalArc(e.points[0],e.points[1],e.points[2],e.points[3],a,0);t.push(i.x,i.y)}}else if("C"===e.command)for(let n=0;n<=1;n+=.01){const i=o.getPointOnCubicBezier(n,e.start.x,e.start.y,e.points[0],e.points[1],e.points[2],e.points[3],e.points[4],e.points[5]);t.push(i.x,i.y)}else t=t.concat(e.points)}));for(var e,i,a=t[0],r=t[0],s=t[1],n=t[1],l=0;l<t.length/2;l++)e=t[2*l],i=t[2*l+1],isNaN(e)||(a=Math.min(a,e),r=Math.max(r,e)),isNaN(i)||(s=Math.min(s,i),n=Math.max(n,i));return{x:a,y:s,width:r-a,height:n-s}}getLength(){return this.pathLength}getPointAtLength(t){return o.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,e,i,a){return Math.sqrt((i-t)*(i-t)+(a-e)*(a-e))}static getPathLength(t){let e=0;for(var i=0;i<t.length;++i)e+=t[i].pathLength;return e}static getPointAtLengthOfDataArray(t,e){var i,a=0,r=e.length;if(!r)return null;while(a<r&&t>e[a].pathLength)t-=e[a].pathLength,++a;if(a===r)return i=e[a-1].points.slice(-2),{x:i[0],y:i[1]};if(t<.01)return i=e[a].points.slice(0,2),{x:i[0],y:i[1]};var s=e[a],l=s.points;switch(s.command){case"L":return o.getPointOnLine(t,s.start.x,s.start.y,l[0],l[1]);case"C":return o.getPointOnCubicBezier((0,n.t2length)(t,o.getPathLength(e),(t=>(0,n.getCubicArcLength)([s.start.x,l[0],l[2],l[4]],[s.start.y,l[1],l[3],l[5]],t))),s.start.x,s.start.y,l[0],l[1],l[2],l[3],l[4],l[5]);case"Q":return o.getPointOnQuadraticBezier((0,n.t2length)(t,o.getPathLength(e),(t=>(0,n.getQuadraticArcLength)([s.start.x,l[0],l[2]],[s.start.y,l[1],l[3]],t))),s.start.x,s.start.y,l[0],l[1],l[2],l[3]);case"A":var h=l[0],d=l[1],c=l[2],u=l[3],p=l[4],g=l[5],m=l[6];return p+=g*t/s.pathLength,o.getPointOnEllipticalArc(h,d,c,u,p,m)}return null}static getPointOnLine(t,e,i,a,r,s,n){s=null!==s&&void 0!==s?s:e,n=null!==n&&void 0!==n?n:i;const o=this.getLineLength(e,i,a,r);if(o<1e-10)return{x:e,y:i};if(a===e)return{x:s,y:n+(r>i?t:-t)};const l=(r-i)/(a-e),h=Math.sqrt(t*t/(1+l*l))*(a<e?-1:1),d=l*h;if(Math.abs(n-i-l*(s-e))<1e-10)return{x:s+h,y:n+d};const c=((s-e)*(a-e)+(n-i)*(r-i))/(o*o),u=e+c*(a-e),p=i+c*(r-i),g=this.getLineLength(s,n,u,p),m=Math.sqrt(t*t-g*g),f=Math.sqrt(m*m/(1+l*l))*(a<e?-1:1),v=l*f;return{x:u+f,y:p+v}}static getPointOnCubicBezier(t,e,i,a,r,s,n,o,l){function h(t){return t*t*t}function d(t){return 3*t*t*(1-t)}function c(t){return 3*t*(1-t)*(1-t)}function u(t){return(1-t)*(1-t)*(1-t)}var p=o*h(t)+s*d(t)+a*c(t)+e*u(t),g=l*h(t)+n*d(t)+r*c(t)+i*u(t);return{x:p,y:g}}static getPointOnQuadraticBezier(t,e,i,a,r,s,n){function o(t){return t*t}function l(t){return 2*t*(1-t)}function h(t){return(1-t)*(1-t)}var d=s*o(t)+a*l(t)+e*h(t),c=n*o(t)+r*l(t)+i*h(t);return{x:d,y:c}}static getPointOnEllipticalArc(t,e,i,a,r,s){var n=Math.cos(s),o=Math.sin(s),l={x:i*Math.cos(r),y:a*Math.sin(r)};return{x:t+(l.x*n-l.y*o),y:e+(l.x*o+l.y*n)}}static parsePathData(t){if(!t)return[];var e=t,i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];e=e.replace(new RegExp(" ","g"),",");for(var a=0;a<i.length;a++)e=e.replace(new RegExp(i[a],"g"),"|"+i[a]);var r,s=e.split("|"),n=[],o=[],l=0,h=0,d=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;for(a=1;a<s.length;a++){var c=s[a],u=c.charAt(0);c=c.slice(1),o.length=0;while(r=d.exec(c))o.push(r[0]);for(var p=[],g=0,m=o.length;g<m;g++)if("00"!==o[g]){var f=parseFloat(o[g]);isNaN(f)?p.push(0):p.push(f)}else p.push(0,0);while(p.length>0){if(isNaN(p[0]))break;var v,y,b,_,w,C,A,S,x,k,L="",E=[],M=l,T=h;switch(u){case"l":l+=p.shift(),h+=p.shift(),L="L",E.push(l,h);break;case"L":l=p.shift(),h=p.shift(),E.push(l,h);break;case"m":var F=p.shift(),D=p.shift();if(l+=F,h+=D,L="M",n.length>2&&"z"===n[n.length-1].command)for(var P=n.length-2;P>=0;P--)if("M"===n[P].command){l=n[P].points[0]+F,h=n[P].points[1]+D;break}E.push(l,h),u="l";break;case"M":l=p.shift(),h=p.shift(),L="M",E.push(l,h),u="L";break;case"h":l+=p.shift(),L="L",E.push(l,h);break;case"H":l=p.shift(),L="L",E.push(l,h);break;case"v":h+=p.shift(),L="L",E.push(l,h);break;case"V":h=p.shift(),L="L",E.push(l,h);break;case"C":E.push(p.shift(),p.shift(),p.shift(),p.shift()),l=p.shift(),h=p.shift(),E.push(l,h);break;case"c":E.push(l+p.shift(),h+p.shift(),l+p.shift(),h+p.shift()),l+=p.shift(),h+=p.shift(),L="C",E.push(l,h);break;case"S":y=l,b=h,v=n[n.length-1],"C"===v.command&&(y=l+(l-v.points[2]),b=h+(h-v.points[3])),E.push(y,b,p.shift(),p.shift()),l=p.shift(),h=p.shift(),L="C",E.push(l,h);break;case"s":y=l,b=h,v=n[n.length-1],"C"===v.command&&(y=l+(l-v.points[2]),b=h+(h-v.points[3])),E.push(y,b,l+p.shift(),h+p.shift()),l+=p.shift(),h+=p.shift(),L="C",E.push(l,h);break;case"Q":E.push(p.shift(),p.shift()),l=p.shift(),h=p.shift(),E.push(l,h);break;case"q":E.push(l+p.shift(),h+p.shift()),l+=p.shift(),h+=p.shift(),L="Q",E.push(l,h);break;case"T":y=l,b=h,v=n[n.length-1],"Q"===v.command&&(y=l+(l-v.points[0]),b=h+(h-v.points[1])),l=p.shift(),h=p.shift(),L="Q",E.push(y,b,l,h);break;case"t":y=l,b=h,v=n[n.length-1],"Q"===v.command&&(y=l+(l-v.points[0]),b=h+(h-v.points[1])),l+=p.shift(),h+=p.shift(),L="Q",E.push(y,b,l,h);break;case"A":_=p.shift(),w=p.shift(),C=p.shift(),A=p.shift(),S=p.shift(),x=l,k=h,l=p.shift(),h=p.shift(),L="A",E=this.convertEndpointToCenterParameterization(x,k,l,h,A,S,_,w,C);break;case"a":_=p.shift(),w=p.shift(),C=p.shift(),A=p.shift(),S=p.shift(),x=l,k=h,l+=p.shift(),h+=p.shift(),L="A",E=this.convertEndpointToCenterParameterization(x,k,l,h,A,S,_,w,C);break}n.push({command:L||u,points:E,start:{x:M,y:T},pathLength:this.calcLength(M,T,L||u,E)})}"z"!==u&&"Z"!==u||n.push({command:"z",points:[],start:void 0,pathLength:0})}return n}static calcLength(t,e,i,a){var r,s,l,h,d=o;switch(i){case"L":return d.getLineLength(t,e,a[0],a[1]);case"C":return(0,n.getCubicArcLength)([t,a[0],a[2],a[4]],[e,a[1],a[3],a[5]],1);case"Q":return(0,n.getQuadraticArcLength)([t,a[0],a[2]],[e,a[1],a[3]],1);case"A":r=0;var c=a[4],u=a[5],p=a[4]+u,g=Math.PI/180;if(Math.abs(c-p)<g&&(g=Math.abs(c-p)),s=d.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],c,0),u<0)for(h=c-g;h>p;h-=g)l=d.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],h,0),r+=d.getLineLength(s.x,s.y,l.x,l.y),s=l;else for(h=c+g;h<p;h+=g)l=d.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],h,0),r+=d.getLineLength(s.x,s.y,l.x,l.y),s=l;return l=d.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],p,0),r+=d.getLineLength(s.x,s.y,l.x,l.y),r}return 0}static convertEndpointToCenterParameterization(t,e,i,a,r,s,n,o,l){var h=l*(Math.PI/180),d=Math.cos(h)*(t-i)/2+Math.sin(h)*(e-a)/2,c=-1*Math.sin(h)*(t-i)/2+Math.cos(h)*(e-a)/2,u=d*d/(n*n)+c*c/(o*o);u>1&&(n*=Math.sqrt(u),o*=Math.sqrt(u));var p=Math.sqrt((n*n*(o*o)-n*n*(c*c)-o*o*(d*d))/(n*n*(c*c)+o*o*(d*d)));r===s&&(p*=-1),isNaN(p)&&(p=0);var g=p*n*c/o,m=p*-o*d/n,f=(t+i)/2+Math.cos(h)*g-Math.sin(h)*m,v=(e+a)/2+Math.sin(h)*g+Math.cos(h)*m,y=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},b=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(y(t)*y(e))},_=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(b(t,e))},w=_([1,0],[(d-g)/n,(c-m)/o]),C=[(d-g)/n,(c-m)/o],A=[(-1*d-g)/n,(-1*c-m)/o],S=_(C,A);return b(C,A)<=-1&&(S=Math.PI),b(C,A)>=1&&(S=0),0===s&&S>0&&(S-=2*Math.PI),1===s&&S<0&&(S+=2*Math.PI),[f,v,n,o,w,S,h,s]}}e.Path=o,o.prototype.className="Path",o.prototype._attrsAffectingSize=["data"],(0,s._registerNode)(o),a.Factory.addGetterSetter(o,"data")},8358:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Rect=void 0;const a=i(9658),r=i(4718),s=i(3552),n=i(8007),o=i(7723);class l extends r.Shape{_sceneFunc(t){var e=this.cornerRadius(),i=this.width(),a=this.height();t.beginPath(),e?n.Util.drawRoundedRectPath(t,i,a,e):t.rect(0,0,i,a),t.closePath(),t.fillStrokeShape(this)}}e.Rect=l,l.prototype.className="Rect",(0,s._registerNode)(l),a.Factory.addGetterSetter(l,"cornerRadius",0,(0,o.getNumberOrArrayOfNumbersValidator)(4))},7790:function(t,e,i){i(560),Object.defineProperty(e,"__esModule",{value:!0}),e.RegularPolygon=void 0;const a=i(9658),r=i(4718),s=i(7723),n=i(3552);class o extends r.Shape{_sceneFunc(t){const e=this._getPoints();t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var i=1;i<e.length;i++)t.lineTo(e[i].x,e[i].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,e=this.attrs.radius||0,i=[];for(var a=0;a<t;a++)i.push({x:e*Math.sin(2*a*Math.PI/t),y:-1*e*Math.cos(2*a*Math.PI/t)});return i}getSelfRect(){const t=this._getPoints();var e=t[0].x,i=t[0].y,a=t[0].x,r=t[0].y;return t.forEach((t=>{e=Math.min(e,t.x),i=Math.max(i,t.x),a=Math.min(a,t.y),r=Math.max(r,t.y)})),{x:e,y:a,width:i-e,height:r-a}}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}e.RegularPolygon=o,o.prototype.className="RegularPolygon",o.prototype._centroid=!0,o.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(o),a.Factory.addGetterSetter(o,"radius",0,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(o,"sides",0,(0,s.getNumberValidator)())},7716:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Ring=void 0;const a=i(9658),r=i(4718),s=i(7723),n=i(3552);var o=2*Math.PI;class l extends r.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,o,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),o,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}e.Ring=l,l.prototype.className="Ring",l.prototype._centroid=!0,l.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(l),a.Factory.addGetterSetter(l,"innerRadius",0,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(l,"outerRadius",0,(0,s.getNumberValidator)())},2926:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Sprite=void 0;const a=i(9658),r=i(4718),s=i(2966),n=i(7723),o=i(3552);class l extends r.Shape{constructor(t){super(t),this._updated=!0,this.anim=new s.Animation((()=>{var t=this._updated;return this._updated=!1,t})),this.on("animationChange.konva",(function(){this.frameIndex(0)})),this.on("frameIndexChange.konva",(function(){this._updated=!0})),this.on("frameRateChange.konva",(function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())}))}_sceneFunc(t){var e=this.animation(),i=this.frameIndex(),a=4*i,r=this.animations()[e],s=this.frameOffsets(),n=r[a+0],o=r[a+1],l=r[a+2],h=r[a+3],d=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,l,h),t.closePath(),t.fillStrokeShape(this)),d)if(s){var c=s[e],u=2*i;t.drawImage(d,n,o,l,h,c[u+0],c[u+1],l,h)}else t.drawImage(d,n,o,l,h,0,0,l,h)}_hitFunc(t){var e=this.animation(),i=this.frameIndex(),a=4*i,r=this.animations()[e],s=this.frameOffsets(),n=r[a+2],o=r[a+3];if(t.beginPath(),s){var l=s[e],h=2*i;t.rect(l[h+0],l[h+1],n,o)}else t.rect(0,0,n,o);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){var t=this;this.interval=setInterval((function(){t._updateIndex()}),1e3/this.frameRate())}start(){if(!this.isRunning()){var t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){var t=this.frameIndex(),e=this.animation(),i=this.animations(),a=i[e],r=a.length/4;t<r-1?this.frameIndex(t+1):this.frameIndex(0)}}e.Sprite=l,l.prototype.className="Sprite",(0,o._registerNode)(l),a.Factory.addGetterSetter(l,"animation"),a.Factory.addGetterSetter(l,"animations"),a.Factory.addGetterSetter(l,"frameOffsets"),a.Factory.addGetterSetter(l,"image"),a.Factory.addGetterSetter(l,"frameIndex",0,(0,n.getNumberValidator)()),a.Factory.addGetterSetter(l,"frameRate",17,(0,n.getNumberValidator)()),a.Factory.backCompat(l,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"})},8273:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Star=void 0;const a=i(9658),r=i(4718),s=i(7723),n=i(3552);class o extends r.Shape{_sceneFunc(t){var e=this.innerRadius(),i=this.outerRadius(),a=this.numPoints();t.beginPath(),t.moveTo(0,0-i);for(var r=1;r<2*a;r++){var s=r%2===0?i:e,n=s*Math.sin(r*Math.PI/a),o=-1*s*Math.cos(r*Math.PI/a);t.lineTo(n,o)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}e.Star=o,o.prototype.className="Star",o.prototype._centroid=!0,o.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(o),a.Factory.addGetterSetter(o,"numPoints",5,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(o,"innerRadius",0,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(o,"outerRadius",0,(0,s.getNumberValidator)())},5436:function(t,e,i){i(560),Object.defineProperty(e,"__esModule",{value:!0}),e.Text=e.stringToArray=void 0;const a=i(8007),r=i(9658),s=i(4718),n=i(3552),o=i(7723),l=i(3552);function h(t){return Array.from(t)}e.stringToArray=h;var d,c="auto",u="center",p="inherit",g="justify",m="Change.konva",f="2d",v="-",y="left",b="text",_="Text",w="top",C="bottom",A="middle",S="normal",x="px ",k=" ",L="right",E="rtl",M="word",T="char",F="none",D="…",P=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],I=P.length;function N(t){return t.split(",").map((t=>{t=t.trim();const e=t.indexOf(" ")>=0,i=t.indexOf('"')>=0||t.indexOf("'")>=0;return e&&!i&&(t=`"${t}"`),t})).join(", ")}function R(){return d||(d=a.Util.createCanvasElement().getContext(f),d)}function O(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)}function B(t){t.setAttr("miterLimit",2),t.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function G(t){return t=t||{},t.fillLinearGradientColorStops||t.fillRadialGradientColorStops||t.fillPatternImage||(t.fill=t.fill||"black"),t}class U extends s.Shape{constructor(t){super(G(t)),this._partialTextX=0,this._partialTextY=0;for(var e=0;e<I;e++)this.on(P[e]+m,this._setTextData);this._setTextData()}_sceneFunc(t){var e=this.textArr,i=e.length;if(this.text()){var a,r=this.padding(),s=this.fontSize(),o=this.lineHeight()*s,l=this.verticalAlign(),d=this.direction(),c=0,m=this.align(),f=this.getWidth(),v=this.letterSpacing(),b=this.fill(),_=this.textDecoration(),w=-1!==_.indexOf("underline"),S=-1!==_.indexOf("line-through");d=d===p?t.direction:d;var x=o/2,k=A;if(n.Konva._fixTextRendering){var M=this.measureSize("M");k="alphabetic",x=(M.fontBoundingBoxAscent-M.fontBoundingBoxDescent)/2+o/2}var T=0,F=0;for(d===E&&t.setAttr("direction",d),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",k),t.setAttr("textAlign",y),l===A?c=(this.getHeight()-i*o-2*r)/2:l===C&&(c=this.getHeight()-i*o-2*r),t.translate(r,c+r),a=0;a<i;a++){T=0,F=0;var D,P,I,N=e[a],R=N.text,O=N.width,B=N.lastInParagraph;if(t.save(),m===L?T+=f-O-2*r:m===u&&(T+=(f-O-2*r)/2),w){t.save(),t.beginPath();let e=n.Konva._fixTextRendering?Math.round(s/4):Math.round(s/2);const i=T,a=x+F+e;t.moveTo(i,a),D=R.split(" ").length-1,P=0===D,I=m!==g||B?O:f-2*r,t.lineTo(i+Math.round(I),a),t.lineWidth=s/15;const o=this._getLinearGradient();t.strokeStyle=o||b,t.stroke(),t.restore()}if(S){t.save(),t.beginPath();let e=n.Konva._fixTextRendering?-Math.round(s/4):0;t.moveTo(T,x+F+e),D=R.split(" ").length-1,P=0===D,I=m===g&&B&&!P?f-2*r:O,t.lineTo(T+Math.round(I),x+F+e),t.lineWidth=s/15;const i=this._getLinearGradient();t.strokeStyle=i||b,t.stroke(),t.restore()}if(d===E||0===v&&m!==g)0!==v&&t.setAttr("letterSpacing",`${v}px`),this._partialTextX=T,this._partialTextY=x+F,this._partialText=R,t.fillStrokeShape(this);else{D=R.split(" ").length-1;for(var G=h(R),U=0;U<G.length;U++){var z=G[U];" "!==z||B||m!==g||(T+=(f-2*r-O)/D),this._partialTextX=T,this._partialTextY=x+F,this._partialText=z,t.fillStrokeShape(this),T+=this.measureSize(z).width+v}}t.restore(),i>1&&(x+=o)}}}_hitFunc(t){var e=this.getWidth(),i=this.getHeight();t.beginPath(),t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)}setText(t){var e=a.Util._isString(t)?t:null===t||void 0===t?"":t+"";return this._setAttr(b,e),this}getWidth(){var t=this.attrs.width===c||void 0===this.attrs.width;return t?this.getTextWidth()+2*this.padding():this.attrs.width}getHeight(){var t=this.attrs.height===c||void 0===this.attrs.height;return t?this.fontSize()*this.textArr.length*this.lineHeight()+2*this.padding():this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return a.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var e,i,a,r,s,n,o,l,h,d,c,u,p=R(),g=this.fontSize();p.save(),p.font=this._getContextFont(),u=p.measureText(t),p.restore();const m=g/100;return{actualBoundingBoxAscent:null!==(e=u.actualBoundingBoxAscent)&&void 0!==e?e:71.58203125*m,actualBoundingBoxDescent:null!==(i=u.actualBoundingBoxDescent)&&void 0!==i?i:0,actualBoundingBoxLeft:null!==(a=u.actualBoundingBoxLeft)&&void 0!==a?a:-7.421875*m,actualBoundingBoxRight:null!==(r=u.actualBoundingBoxRight)&&void 0!==r?r:75.732421875*m,alphabeticBaseline:null!==(s=u.alphabeticBaseline)&&void 0!==s?s:0,emHeightAscent:null!==(n=u.emHeightAscent)&&void 0!==n?n:100*m,emHeightDescent:null!==(o=u.emHeightDescent)&&void 0!==o?o:-20*m,fontBoundingBoxAscent:null!==(l=u.fontBoundingBoxAscent)&&void 0!==l?l:91*m,fontBoundingBoxDescent:null!==(h=u.fontBoundingBoxDescent)&&void 0!==h?h:21*m,hangingBaseline:null!==(d=u.hangingBaseline)&&void 0!==d?d:72.80000305175781*m,ideographicBaseline:null!==(c=u.ideographicBaseline)&&void 0!==c?c:-21*m,width:u.width,height:g}}_getContextFont(){return this.fontStyle()+k+this.fontVariant()+k+(this.fontSize()+x)+N(this.fontFamily())}_addTextLine(t){const e=this.align();e===g&&(t=t.trim());var i=this._getTextWidth(t);return this.textArr.push({text:t,width:i,lastInParagraph:!1})}_getTextWidth(t){var e=this.letterSpacing(),i=t.length;return R().measureText(t).width+(i?e*(i-1):0)}_setTextData(){var t=this.text().split("\n"),e=+this.fontSize(),i=0,a=this.lineHeight()*e,r=this.attrs.width,s=this.attrs.height,n=r!==c&&void 0!==r,o=s!==c&&void 0!==s,l=this.padding(),h=r-2*l,d=s-2*l,u=0,p=this.wrap(),g=p!==F,m=p!==T&&g,f=this.ellipsis();this.textArr=[],R().font=this._getContextFont();for(var y=f?this._getTextWidth(D):0,b=0,_=t.length;b<_;++b){var w=t[b],C=this._getTextWidth(w);if(n&&C>h)while(w.length>0){var A=0,S=w.length,x="",L=0;while(A<S){var E=A+S>>>1,M=w.slice(0,E+1),P=this._getTextWidth(M)+y;P<=h?(A=E+1,x=M,L=P):S=E}if(!x)break;if(m){var I,N=w[x.length],O=N===k||N===v;I=O&&L<=h?x.length:Math.max(x.lastIndexOf(k),x.lastIndexOf(v))+1,I>0&&(A=I,x=x.slice(0,A),L=this._getTextWidth(x))}x=x.trimRight(),this._addTextLine(x),i=Math.max(i,L),u+=a;var B=this._shouldHandleEllipsis(u);if(B){this._tryToAddEllipsisToLastLine();break}if(w=w.slice(A),w=w.trimLeft(),w.length>0&&(C=this._getTextWidth(w),C<=h)){this._addTextLine(w),u+=a,i=Math.max(i,C);break}}else this._addTextLine(w),u+=a,i=Math.max(i,C),this._shouldHandleEllipsis(u)&&b<_-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),o&&u+a>d)break}this.textHeight=e,this.textWidth=i}_shouldHandleEllipsis(t){var e=+this.fontSize(),i=this.lineHeight()*e,a=this.attrs.height,r=a!==c&&void 0!==a,s=this.padding(),n=a-2*s,o=this.wrap(),l=o!==F;return!l||r&&t+i>n}_tryToAddEllipsisToLastLine(){var t=this.attrs.width,e=t!==c&&void 0!==t,i=this.padding(),a=t-2*i,r=this.ellipsis(),s=this.textArr[this.textArr.length-1];if(s&&r){if(e){var n=this._getTextWidth(s.text+D)<a;n||(s.text=s.text.slice(0,s.text.length-3))}this.textArr.splice(this.textArr.length-1,1),this._addTextLine(s.text+D)}}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=-1!==this.textDecoration().indexOf("underline")||-1!==this.textDecoration().indexOf("line-through"),e=this.hasShadow();return!(!t||!e)||super._useBufferCanvas()}}e.Text=U,U.prototype._fillFunc=O,U.prototype._strokeFunc=B,U.prototype.className=_,U.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,l._registerNode)(U),r.Factory.overWriteSetter(U,"width",(0,o.getNumberOrAutoValidator)()),r.Factory.overWriteSetter(U,"height",(0,o.getNumberOrAutoValidator)()),r.Factory.addGetterSetter(U,"direction",p),r.Factory.addGetterSetter(U,"fontFamily","Arial"),r.Factory.addGetterSetter(U,"fontSize",12,(0,o.getNumberValidator)()),r.Factory.addGetterSetter(U,"fontStyle",S),r.Factory.addGetterSetter(U,"fontVariant",S),r.Factory.addGetterSetter(U,"padding",0,(0,o.getNumberValidator)()),r.Factory.addGetterSetter(U,"align",y),r.Factory.addGetterSetter(U,"verticalAlign",w),r.Factory.addGetterSetter(U,"lineHeight",1,(0,o.getNumberValidator)()),r.Factory.addGetterSetter(U,"wrap",M),r.Factory.addGetterSetter(U,"ellipsis",!1,(0,o.getBooleanValidator)()),r.Factory.addGetterSetter(U,"letterSpacing",0,(0,o.getNumberValidator)()),r.Factory.addGetterSetter(U,"text","",(0,o.getStringValidator)()),r.Factory.addGetterSetter(U,"textDecoration","")},6337:function(t,e,i){i(560),Object.defineProperty(e,"__esModule",{value:!0}),e.TextPath=void 0;const a=i(8007),r=i(9658),s=i(4718),n=i(988),o=i(5436),l=i(7723),h=i(3552);var d="",c="normal";function u(t){t.fillText(this.partialText,0,0)}function p(t){t.strokeText(this.partialText,0,0)}class g extends s.Shape{constructor(t){super(t),this.dummyCanvas=a.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",(function(){this._readDataAttribute(),this._setTextData()})),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return n.Path.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const e=this.pathLength;return t-1>e?null:n.Path.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=n.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();var e=this.textDecoration(),i=this.fill(),a=this.fontSize(),r=this.glyphInfo;"underline"===e&&t.beginPath();for(var s=0;s<r.length;s++){t.save();var n=r[s].p0;t.translate(n.x,n.y),t.rotate(r[s].rotation),this.partialText=r[s].text,t.fillStrokeShape(this),"underline"===e&&(0===s&&t.moveTo(0,a/2+1),t.lineTo(a,a/2+1)),t.restore()}"underline"===e&&(t.strokeStyle=i,t.lineWidth=a/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();var e=this.glyphInfo;if(e.length>=1){var i=e[0].p0;t.moveTo(i.x,i.y)}for(var a=0;a<e.length;a++){var r=e[a].p1;t.lineTo(r.x,r.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return a.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return o.Text.prototype.setText.call(this,t)}_getContextFont(){return o.Text.prototype._getContextFont.call(this)}_getTextSize(t){var e=this.dummyCanvas,i=e.getContext("2d");i.save(),i.font=this._getContextFont();var a=i.measureText(t);return i.restore(),{width:a.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:t,height:e}=this._getTextSize(this.attrs.text);if(this.textWidth=t,this.textHeight=e,this.glyphInfo=[],!this.attrs.data)return null;const i=this.letterSpacing(),a=this.align(),r=this.kerningFunc(),s=Math.max(this.textWidth+((this.attrs.text||"").length-1)*i,0);let l=0;"center"===a&&(l=Math.max(0,this.pathLength/2-s/2)),"right"===a&&(l=Math.max(0,this.pathLength-s));const h=(0,o.stringToArray)(this.text());let d=l;for(var c=0;c<h.length;c++){const t=this._getPointAtLength(d);if(!t)return;let e=this._getTextSize(h[c]).width+i;if(" "===h[c]&&"justify"===a){const t=this.text().split(" ").length-1;e+=(this.pathLength-s)/t}const o=this._getPointAtLength(d+e);if(!o)return;const l=n.Path.getLineLength(t.x,t.y,o.x,o.y);let p=0;if(r)try{p=r(h[c-1],h[c])*this.fontSize()}catch(u){p=0}t.x+=p,o.x+=p,this.textWidth+=p;const g=n.Path.getPointOnLine(p+l/2,t.x,t.y,o.x,o.y),m=Math.atan2(o.y-t.y,o.x-t.x);this.glyphInfo.push({transposeX:g.x,transposeY:g.y,text:h[c],rotation:m,p0:t,p1:o}),d+=e}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var t=[];this.glyphInfo.forEach((function(e){t.push(e.p0.x),t.push(e.p0.y),t.push(e.p1.x),t.push(e.p1.y)}));for(var e,i,a=t[0]||0,r=t[0]||0,s=t[1]||0,n=t[1]||0,o=0;o<t.length/2;o++)e=t[2*o],i=t[2*o+1],a=Math.min(a,e),r=Math.max(r,e),s=Math.min(s,i),n=Math.max(n,i);var l=this.fontSize();return{x:a-l/2,y:s-l/2,width:r-a+l,height:n-s+l}}destroy(){return a.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}e.TextPath=g,g.prototype._fillFunc=u,g.prototype._strokeFunc=p,g.prototype._fillFuncHit=u,g.prototype._strokeFuncHit=p,g.prototype.className="TextPath",g.prototype._attrsAffectingSize=["text","fontSize","data"],(0,h._registerNode)(g),r.Factory.addGetterSetter(g,"data"),r.Factory.addGetterSetter(g,"fontFamily","Arial"),r.Factory.addGetterSetter(g,"fontSize",12,(0,l.getNumberValidator)()),r.Factory.addGetterSetter(g,"fontStyle",c),r.Factory.addGetterSetter(g,"align","left"),r.Factory.addGetterSetter(g,"letterSpacing",0,(0,l.getNumberValidator)()),r.Factory.addGetterSetter(g,"textBaseline","middle"),r.Factory.addGetterSetter(g,"fontVariant",c),r.Factory.addGetterSetter(g,"text",d),r.Factory.addGetterSetter(g,"textDecoration",null),r.Factory.addGetterSetter(g,"kerningFunc",null)},7736:function(t,e,i){i(560),Object.defineProperty(e,"__esModule",{value:!0}),e.Transformer=void 0;const a=i(8007),r=i(9658),s=i(6205),n=i(4718),o=i(8358),l=i(1763),h=i(3552),d=i(7723),c=i(3552);var u="tr-konva",p=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map((t=>t+`.${u}`)).join(" "),g="nodesRect",m=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],f={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135};const v="ontouchstart"in h.Konva._global;function y(t,e,i){if("rotater"===t)return i;e+=a.Util.degToRad(f[t]||0);var r=(a.Util.radToDeg(e)%360+360)%360;return a.Util._inRange(r,337.5,360)||a.Util._inRange(r,0,22.5)?"ns-resize":a.Util._inRange(r,22.5,67.5)?"nesw-resize":a.Util._inRange(r,67.5,112.5)?"ew-resize":a.Util._inRange(r,112.5,157.5)?"nwse-resize":a.Util._inRange(r,157.5,202.5)?"ns-resize":a.Util._inRange(r,202.5,247.5)?"nesw-resize":a.Util._inRange(r,247.5,292.5)?"ew-resize":a.Util._inRange(r,292.5,337.5)?"nwse-resize":(a.Util.error("Transformer has unknown angle for cursor detection: "+r),"pointer")}var b=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],_=1e8;function w(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}function C(t,e,i){const a=i.x+(t.x-i.x)*Math.cos(e)-(t.y-i.y)*Math.sin(e),r=i.y+(t.x-i.x)*Math.sin(e)+(t.y-i.y)*Math.cos(e);return{...t,rotation:t.rotation+e,x:a,y:r}}function A(t,e){const i=w(t);return C(t,e,i)}function S(t,e,i){let a=e;for(let r=0;r<t.length;r++){const s=h.Konva.getAngle(t[r]),n=Math.abs(s-e)%(2*Math.PI),o=Math.min(n,2*Math.PI-n);o<i&&(a=s)}return a}let x=0;class k extends l.Group{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(p,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return a.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return u+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const e=t.filter((t=>!t.isAncestorOf(this)||(a.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1)));this._nodes=t=e,1===t.length&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach((t=>{const e=()=>{1===this.nodes().length&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),this._transforming||this.isDragging()||this.update()},i=t._attrsAffectingSize.map((t=>t+"Change."+this._getEventNamespace())).join(" ");t.on(i,e),t.on(m.map((t=>t+`.${this._getEventNamespace()}`)).join(" "),e),t.on(`absoluteTransformChange.${this._getEventNamespace()}`,e),this._proxyDrag(t)})),this._resetTransformCache();var i=!!this.findOne(".top-left");return i&&this.update(),this}_proxyDrag(t){let e;t.on(`dragstart.${this._getEventNamespace()}`,(i=>{e=t.getAbsolutePosition(),this.isDragging()||t===this.findOne(".back")||this.startDrag(i,!1)})),t.on(`dragmove.${this._getEventNamespace()}`,(i=>{if(!e)return;const a=t.getAbsolutePosition(),r=a.x-e.x,s=a.y-e.y;this.nodes().forEach((e=>{if(e===t)return;if(e.isDragging())return;const a=e.getAbsolutePosition();e.setAbsolutePosition({x:a.x+r,y:a.y+s}),e.startDrag(i)})),e=null}))}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach((t=>{t.off("."+this._getEventNamespace())})),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(g),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(g,this.__getNodeRect)}__getNodeShape(t,e=this.rotation(),i){var a=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),r=t.getAbsoluteScale(i),s=t.getAbsolutePosition(i),n=a.x*r.x-t.offsetX()*r.x,o=a.y*r.y-t.offsetY()*r.y;const l=(h.Konva.getAngle(t.getAbsoluteRotation())+2*Math.PI)%(2*Math.PI),d={x:s.x+n*Math.cos(l)+o*Math.sin(-l),y:s.y+o*Math.cos(l)+n*Math.sin(l),width:a.width*r.x,height:a.height*r.y,rotation:l};return C(d,-h.Konva.getAngle(e),{x:0,y:0})}__getNodeRect(){var t=this.getNode();if(!t)return{x:-_,y:-_,width:0,height:0,rotation:0};const e=[];this.nodes().map((t=>{const i=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()});var a=[{x:i.x,y:i.y},{x:i.x+i.width,y:i.y},{x:i.x+i.width,y:i.y+i.height},{x:i.x,y:i.y+i.height}],r=t.getAbsoluteTransform();a.forEach((function(t){var i=r.point(t);e.push(i)}))}));const i=new a.Transform;i.rotate(-h.Konva.getAngle(this.rotation()));var r=1/0,s=1/0,n=-1/0,o=-1/0;e.forEach((function(t){var e=i.point(t);void 0===r&&(r=n=e.x,s=o=e.y),r=Math.min(r,e.x),s=Math.min(s,e.y),n=Math.max(n,e.x),o=Math.max(o,e.y)})),i.invert();const l=i.point({x:r,y:s});return{x:l.x,y:l.y,width:n-r,height:o-s,rotation:h.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),b.forEach((t=>{this._createAnchor(t)})),this._createAnchor("rotater")}_createAnchor(t){var e=new o.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:v?10:"auto"}),i=this;e.on("mousedown touchstart",(function(t){i._handleMouseDown(t)})),e.on("dragstart",(t=>{e.stopDrag(),t.cancelBubble=!0})),e.on("dragend",(t=>{t.cancelBubble=!0})),e.on("mouseenter",(()=>{var i=h.Konva.getAngle(this.rotation()),a=this.rotateAnchorCursor(),r=y(t,i,a);e.getStage().content&&(e.getStage().content.style.cursor=r),this._cursorChange=!0})),e.on("mouseout",(()=>{e.getStage().content&&(e.getStage().content.style.cursor=""),this._cursorChange=!1})),this.add(e)}_createBack(){var t=new n.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(t,e){var i=e.getParent(),r=i.padding();t.beginPath(),t.rect(-r,-r,e.width()+2*r,e.height()+2*r),t.moveTo(e.width()/2,-r),i.rotateEnabled()&&i.rotateLineVisible()&&t.lineTo(e.width()/2,-i.rotateAnchorOffset()*a.Util._sign(e.height())-r),t.fillStrokeShape(e)},hitFunc:(t,e)=>{if(this.shouldOverdrawWholeArea()){var i=this.padding();t.beginPath(),t.rect(-i,-i,e.width()+2*i,e.height()+2*i),t.fillStrokeShape(e)}}});this.add(t),this._proxyDrag(t),t.on("dragstart",(t=>{t.cancelBubble=!0})),t.on("dragmove",(t=>{t.cancelBubble=!0})),t.on("dragend",(t=>{t.cancelBubble=!0})),this.on("dragmove",(t=>{this.update()}))}_handleMouseDown(t){if(!this._transforming){this._movingAnchorName=t.target.name().split(" ")[0];var e=this._getNodeRect(),i=e.width,a=e.height,r=Math.sqrt(Math.pow(i,2)+Math.pow(a,2));this.sin=Math.abs(a/r),this.cos=Math.abs(i/r),"undefined"!==typeof window&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;var s=t.target.getAbsolutePosition(),n=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:n.x-s.x,y:n.y-s.y},x++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach((e=>{e._fire("transformstart",{evt:t.evt,target:e})}))}}_handleMouseMove(t){var e,i,a,r=this.findOne("."+this._movingAnchorName),s=r.getStage();s.setPointersPositions(t);const n=s.getPointerPosition();let o={x:n.x-this._anchorDragOffset.x,y:n.y-this._anchorDragOffset.y};const l=r.getAbsolutePosition();this.anchorDragBoundFunc()&&(o=this.anchorDragBoundFunc()(l,o,t)),r.setAbsolutePosition(o);const d=r.getAbsolutePosition();if(l.x!==d.x||l.y!==d.y)if("rotater"!==this._movingAnchorName){var c,u=this.shiftBehavior();c="inverted"===u?this.keepRatio()&&!t.shiftKey:"none"===u?this.keepRatio():this.keepRatio()||t.shiftKey;var p=this.centeredScaling()||t.altKey;if("top-left"===this._movingAnchorName){if(c){var g=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};a=Math.sqrt(Math.pow(g.x-r.x(),2)+Math.pow(g.y-r.y(),2));var m=this.findOne(".top-left").x()>g.x?-1:1,f=this.findOne(".top-left").y()>g.y?-1:1;e=a*this.cos*m,i=a*this.sin*f,this.findOne(".top-left").x(g.x-e),this.findOne(".top-left").y(g.y-i)}}else if("top-center"===this._movingAnchorName)this.findOne(".top-left").y(r.y());else if("top-right"===this._movingAnchorName){if(c){g=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};a=Math.sqrt(Math.pow(r.x()-g.x,2)+Math.pow(g.y-r.y(),2));m=this.findOne(".top-right").x()<g.x?-1:1,f=this.findOne(".top-right").y()>g.y?-1:1;e=a*this.cos*m,i=a*this.sin*f,this.findOne(".top-right").x(g.x+e),this.findOne(".top-right").y(g.y-i)}var v=r.position();this.findOne(".top-left").y(v.y),this.findOne(".bottom-right").x(v.x)}else if("middle-left"===this._movingAnchorName)this.findOne(".top-left").x(r.x());else if("middle-right"===this._movingAnchorName)this.findOne(".bottom-right").x(r.x());else if("bottom-left"===this._movingAnchorName){if(c){g=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};a=Math.sqrt(Math.pow(g.x-r.x(),2)+Math.pow(r.y()-g.y,2));m=g.x<r.x()?-1:1,f=r.y()<g.y?-1:1;e=a*this.cos*m,i=a*this.sin*f,r.x(g.x-e),r.y(g.y+i)}v=r.position(),this.findOne(".top-left").x(v.x),this.findOne(".bottom-right").y(v.y)}else if("bottom-center"===this._movingAnchorName)this.findOne(".bottom-right").y(r.y());else if("bottom-right"===this._movingAnchorName){if(c){g=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};a=Math.sqrt(Math.pow(r.x()-g.x,2)+Math.pow(r.y()-g.y,2));m=this.findOne(".bottom-right").x()<g.x?-1:1,f=this.findOne(".bottom-right").y()<g.y?-1:1;e=a*this.cos*m,i=a*this.sin*f,this.findOne(".bottom-right").x(g.x+e),this.findOne(".bottom-right").y(g.y+i)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));p=this.centeredScaling()||t.altKey;if(p){var y=this.findOne(".top-left"),b=this.findOne(".bottom-right"),_=y.x(),w=y.y(),C=this.getWidth()-b.x(),x=this.getHeight()-b.y();b.move({x:-_,y:-w}),y.move({x:C,y:x})}var k=this.findOne(".top-left").getAbsolutePosition();e=k.x,i=k.y;var L=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),E=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:e,y:i,width:L,height:E,rotation:h.Konva.getAngle(this.rotation())},t)}else{var M=this._getNodeRect();e=r.x()-M.width/2,i=-r.y()+M.height/2;let a=Math.atan2(-i,e)+Math.PI/2;M.height<0&&(a-=Math.PI);var T=h.Konva.getAngle(this.rotation());const s=T+a,n=h.Konva.getAngle(this.rotationSnapTolerance()),o=S(this.rotationSnaps(),s,n),l=o-M.rotation,d=A(M,l);this._fitNodesInto(d,t)}}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var e;if(this._transforming){this._transforming=!1,"undefined"!==typeof window&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));var i=this.getNode();x--,this._fire("transformend",{evt:t,target:i}),null===(e=this.getLayer())||void 0===e||e.batchDraw(),i&&this._nodes.forEach((e=>{var i;e._fire("transformend",{evt:t,target:e}),null===(i=e.getLayer())||void 0===i||i.batchDraw()})),this._movingAnchorName=null}}_fitNodesInto(t,e){var i=this._getNodeRect();const r=1;if(a.Util._inRange(t.width,2*-this.padding()-r,r))return void this.update();if(a.Util._inRange(t.height,2*-this.padding()-r,r))return void this.update();var s=new a.Transform;if(s.rotate(h.Konva.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const e=s.point({x:2*-this.padding(),y:0});t.x+=e.x,t.y+=e.y,t.width+=2*this.padding(),this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const e=s.point({x:2*this.padding(),y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.width+=2*this.padding()}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const e=s.point({x:0,y:2*-this.padding()});t.x+=e.x,t.y+=e.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.height+=2*this.padding()}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const e=s.point({x:0,y:2*this.padding()});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.height+=2*this.padding()}if(this.boundBoxFunc()){const e=this.boundBoxFunc()(i,t);e?t=e:a.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const n=1e7,o=new a.Transform;o.translate(i.x,i.y),o.rotate(i.rotation),o.scale(i.width/n,i.height/n);const l=new a.Transform,d=t.width/n,c=t.height/n;!1===this.flipEnabled()?(l.translate(t.x,t.y),l.rotate(t.rotation),l.translate(t.width<0?t.width:0,t.height<0?t.height:0),l.scale(Math.abs(d),Math.abs(c))):(l.translate(t.x,t.y),l.rotate(t.rotation),l.scale(d,c));const u=l.multiply(o.invert());this._nodes.forEach((t=>{var e;const i=t.getParent().getAbsoluteTransform(),r=t.getTransform().copy();r.translate(t.offsetX(),t.offsetY());const s=new a.Transform;s.multiply(i.copy().invert()).multiply(u).multiply(i).multiply(r);const n=s.decompose();t.setAttrs(n),null===(e=t.getLayer())||void 0===e||e.batchDraw()})),this.rotation(a.Util._getRotation(t.rotation)),this._nodes.forEach((t=>{this._fire("transform",{evt:e,target:t}),t._fire("transform",{evt:e,target:t})})),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,e){const i=this.findOne(t);i.setAttrs(e)}update(){var t,e=this._getNodeRect();this.rotation(a.Util._getRotation(e.rotation));var i=e.width,r=e.height,s=this.enabledAnchors(),n=this.resizeEnabled(),o=this.padding(),l=this.anchorSize();const h=this.find("._anchor");h.forEach((t=>{t.setAttrs({width:l,height:l,offsetX:l/2,offsetY:l/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})})),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:l/2+o,offsetY:l/2+o,visible:n&&s.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:i/2,y:0,offsetY:l/2+o,visible:n&&s.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:i,y:0,offsetX:l/2-o,offsetY:l/2+o,visible:n&&s.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:r/2,offsetX:l/2+o,visible:n&&s.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:i,y:r/2,offsetX:l/2-o,visible:n&&s.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:r,offsetX:l/2+o,offsetY:l/2-o,visible:n&&s.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:i/2,y:r,offsetY:l/2-o,visible:n&&s.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:i,y:r,offsetX:l/2-o,offsetY:l/2-o,visible:n&&s.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:i/2,y:-this.rotateAnchorOffset()*a.Util._sign(r)-o,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:i,height:r,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const d=this.anchorStyleFunc();d&&h.forEach((t=>{d(t)})),null===(t=this.getLayer())||void 0===t||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();var t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),l.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return s.Node.prototype.toObject.call(this)}clone(t){var e=s.Node.prototype.clone.call(this,t);return e}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}function L(t){return t instanceof Array||a.Util.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach((function(t){-1===b.indexOf(t)&&a.Util.warn("Unknown anchor name: "+t+". Available names are: "+b.join(", "))})),t||[]}e.Transformer=k,k.isTransforming=()=>x>0,k.prototype.className="Transformer",(0,c._registerNode)(k),r.Factory.addGetterSetter(k,"enabledAnchors",b,L),r.Factory.addGetterSetter(k,"flipEnabled",!0,(0,d.getBooleanValidator)()),r.Factory.addGetterSetter(k,"resizeEnabled",!0),r.Factory.addGetterSetter(k,"anchorSize",10,(0,d.getNumberValidator)()),r.Factory.addGetterSetter(k,"rotateEnabled",!0),r.Factory.addGetterSetter(k,"rotateLineVisible",!0),r.Factory.addGetterSetter(k,"rotationSnaps",[]),r.Factory.addGetterSetter(k,"rotateAnchorOffset",50,(0,d.getNumberValidator)()),r.Factory.addGetterSetter(k,"rotateAnchorCursor","crosshair"),r.Factory.addGetterSetter(k,"rotationSnapTolerance",5,(0,d.getNumberValidator)()),r.Factory.addGetterSetter(k,"borderEnabled",!0),r.Factory.addGetterSetter(k,"anchorStroke","rgb(0, 161, 255)"),r.Factory.addGetterSetter(k,"anchorStrokeWidth",1,(0,d.getNumberValidator)()),r.Factory.addGetterSetter(k,"anchorFill","white"),r.Factory.addGetterSetter(k,"anchorCornerRadius",0,(0,d.getNumberValidator)()),r.Factory.addGetterSetter(k,"borderStroke","rgb(0, 161, 255)"),r.Factory.addGetterSetter(k,"borderStrokeWidth",1,(0,d.getNumberValidator)()),r.Factory.addGetterSetter(k,"borderDash"),r.Factory.addGetterSetter(k,"keepRatio",!0),r.Factory.addGetterSetter(k,"shiftBehavior","default"),r.Factory.addGetterSetter(k,"centeredScaling",!1),r.Factory.addGetterSetter(k,"ignoreStroke",!1),r.Factory.addGetterSetter(k,"padding",0,(0,d.getNumberValidator)()),r.Factory.addGetterSetter(k,"node"),r.Factory.addGetterSetter(k,"nodes"),r.Factory.addGetterSetter(k,"boundBoxFunc"),r.Factory.addGetterSetter(k,"anchorDragBoundFunc"),r.Factory.addGetterSetter(k,"anchorStyleFunc"),r.Factory.addGetterSetter(k,"shouldOverdrawWholeArea",!1),r.Factory.addGetterSetter(k,"useSingleNodeRotation",!0),r.Factory.backCompat(k,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"})},251:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.Wedge=void 0;const a=i(9658),r=i(4718),s=i(3552),n=i(7723),o=i(3552);class l extends r.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,s.Konva.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}e.Wedge=l,l.prototype.className="Wedge",l.prototype._centroid=!0,l.prototype._attrsAffectingSize=["radius"],(0,o._registerNode)(l),a.Factory.addGetterSetter(l,"radius",0,(0,n.getNumberValidator)()),a.Factory.addGetterSetter(l,"angle",0,(0,n.getNumberValidator)()),a.Factory.addGetterSetter(l,"clockwise",!1),a.Factory.backCompat(l,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"})},5564:function(t,e,i){t.exports=i.p+"static/img/image.5a09585b.svg"},2219:function(t,e,i){t.exports=i.p+"static/img/intersection.2af671f8.svg"},3509:function(t){t.exports="data:image/png;base64,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"},7674:function(t){t.exports="data:image/png;base64,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"},5061:function(t){t.exports="data:image/png;base64,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"},9595:function(t){t.exports="data:image/png;base64,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"},1534:function(t){t.exports="data:image/png;base64,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"},2630:function(t,e,i){t.exports=i.p+"static/img/video1.e775dc84.gif"},5311:function(t,e,i){t.exports=i.p+"static/img/video2.987233e8.gif"},3140:function(t,e,i){t.exports=i.p+"static/img/video3.93ef4c28.gif"},2165:function(t,e,i){t.exports=i.p+"static/img/video4.16a80fb2.gif"},7274:function(t,e,i){t.exports=i.p+"static/img/video5.63d51539.gif"}}]);